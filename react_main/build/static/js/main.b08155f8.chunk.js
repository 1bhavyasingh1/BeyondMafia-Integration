/*! For license information please see main.b08155f8.chunk.js.LICENSE.txt */
(this.webpackJsonpreact_main=this.webpackJsonpreact_main||[]).push([[0],{153:function(e,t,a){},154:function(e,t,a){},165:function(e,t,a){e.exports=a(449)},186:function(e,t,a){},187:function(e,t,a){},188:function(e,t,a){},218:function(e,t,a){},430:function(e,t,a){},431:function(e,t,a){},432:function(e,t,a){},433:function(e,t,a){},434:function(e,t,a){},435:function(e,t,a){},436:function(e,t,a){},437:function(e,t,a){},438:function(e,t,a){},439:function(e,t,a){},440:function(e,t,a){},441:function(e,t,a){},442:function(e,t,a){},443:function(e,t,a){},444:function(e,t,a){},445:function(e,t,a){},446:function(e,t,a){},447:function(e,t,a){},448:function(e,t,a){},449:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(155),c=a.n(o),s=a(12),i=a(2),l=a(3),u=a(35),m=a(4),d=a.n(m),f=a(10),p=a.n(f),h=a(13),v=a(1),g=["Mafia","Split Decision","Resistance","One Night"],b=["Main","Sandbox","Competitive","Games"],y={Mafia:["Village","Mafia","Monsters","Independent"],"Split Decision":["Blue","Red","Independent"],Resistance:["Resistance","Spies"],"One Night":["Village","Werewolves","Independent"]},E={Mafia:["Day","Night"],"Split Decision":["Initial Round","Hostage Swap"],Resistance:["Team Selection","Team Approval","Mission"],"One Night":["Day","Night"]},w={reads:{S:.95,A:.9,B:.8,C:.7,D:.6,E:.5},survival:{S:.95,A:.9,B:.8,C:.7,D:.6,E:.5},participation:{S:.95,A:.9,B:.8,C:.7,D:.6,E:.5}},O=r.a.createContext(),N=r.a.createContext(),j=r.a.createContext(),k=r.a.createContext();function S(e){var t=Object(n.useReducer)((function(e,t){var a;switch(t.type){case"setProp":e[t.prop]!=t.value&&(a=p()(e,Object(v.a)({},t.prop,{$set:t.value})));break;case"showAlert":"function"==typeof t.text&&(t.text=t.text(e.alerts.length)),a=p()(e,{alerts:{$push:[{text:t.text,type:t.alertType||"",id:t.id}]}});break;case"hideAlert":a=p()(e,{alerts:{$splice:[[t.index,1]]}});break;case"hideAlertById":for(var n=0;n<e.alerts.length;n++)if(e.alerts[n].id==t.id){a=p()(e,{alerts:{$splice:[[n,1]]}});break}break;case"hideAllAlerts":a=p()(e,{alerts:{$set:[]}})}return a||e}),e),a=Object(i.a)(t,2),r=a[0],o=a[1];function c(e,t){o({type:"setProp",prop:e,value:t})}return Object(h.a)(Object(h.a)({},r),{},{update:c,showAlert:function(e,t,a){var n=Math.random();o({type:"showAlert",text:e,alertType:t,id:n}),a||setTimeout((function(){return function(e){var t=document.getElementById("alert-id-".concat(e));if(!t)return;t.style.opacity=0,setTimeout((function(){o({type:"hideAlertById",id:e})}),500)}(n)}),3e3)},hideAlert:function(e){o({type:"hideAlert",index:e})},hideAllAlerts:function(){o({type:"hideAllAlerts"})},clearCache:function(){var e=Date.now();c("cacheVal",e),window.localStorage.setItem("cacheVal",e)}})}a(186);function x(e){var t=Object(n.useContext)(N),a=t.alerts.map((function(e,a){return r.a.createElement(C,{id:e.id,index:a,text:e.text,type:e.type,onHide:t.hideAlert,key:e.id})}));return r.a.createElement("div",{className:"alert-list"},a)}function C(e){return r.a.createElement("div",{id:"alert-id-".concat(e.id),className:"alert alert-".concat(e.type)},r.a.createElement("i",{className:"hide-alert fa-times-circle fas",onClick:function(){return e.onHide(e.index)}}),e.text)}function I(e){var t=Object(n.useContext)(N);return e=e||t,function(t){var a;(a=t&&t.response?t.response.data:t&&t.message?t.message:"string"==typeof t?t:"Error loading data").length>200&&(a="Connection error"),e.showAlert(a,"error")}}var T=a(11);a(187);function L(e){var t=e.emote.toLowerCase(),a=A[t];return r.a.createElement("div",{className:"emote",title:a.name,style:{backgroundImage:"url('/images/emotes/".concat(t,".").concat(a.type,"')")}})}var A={ez:{name:"EZ",type:"png"},feelsdankman:{name:"FeelsDankMan",type:"png"},feelsokayman:{name:"FeelsOkayMan",type:"png"},kapp:{name:"Kapp",type:"png"},monkagun:{name:"MonkaGun",type:"png"},monkahmm:{name:"MonkaHmm",type:"png"},monkas:{name:"MonkaS",type:"png"},nodders:{name:"Nodders",type:"gif"},nopers:{name:"Nopers",type:"gif"},omegalul:{name:"Omegalul",type:"png"},peepohappy:{name:"PeepoHappy",type:"png"},peeposad:{name:"PeepoSad",type:"png"},peepowtf:{name:"PeepoWtf",type:"png"},pepega:{name:"Pepega",type:"png"},pepegaaim:{name:"PepegaAim",type:"gif"},pepehands:{name:"PepeHands",type:"png"},pepelaugh:{name:"PepeLaugh",type:"png"},pepemeltdown:{name:"PepeMeltdown",type:"gif"},pepepains:{name:"PepePains",type:"png"},pepog:{name:"PepoG",type:"png"},sadge:{name:"Sadge",type:"png"},pepepls:{name:"PepePls",type:"gif"}},M=Object.keys(A),P=["chink","faggot","fag","nazi","nigga","nigger","retard","wetback"];function R(e){var t=e.items.map(e.map);return r.a.createElement("div",{className:"item-list ".concat(e.className||"")},t)}function F(e){var t=e.panels.map((function(e,t){return r.a.createElement("div",{className:"box-panel",key:t},r.a.createElement("div",{className:"heading"},e.icon,r.a.createElement("div",{className:"heading-text"},e.name)),r.a.createElement("div",{className:"content"},e.text))}));return r.a.createElement("div",{className:"panel-grid"},t)}function D(e){for(var t="millisecond",a=e.millisec,n=e.suffix||"",r=e.minSec,o=[{name:"second",scale:1e3},{name:"minute",scale:60},{name:"hour",scale:60},{name:"day",scale:24},{name:"week",scale:7},{name:"year",scale:52}],c=0;c<o.length-1&&a>=o[c].scale;)a/=o[c].scale,t=o[c].name,c++;return r&&"millisecond"==t?"Less than a second".concat(n):((a=Math.floor(a))>1&&(t+="s"),"".concat(a," ").concat(t).concat(n))}function B(e){var t=e.notifCount,a=e.onClick,n=e.lOffset;return r.a.createElement("div",{className:"notif-bound ".concat(e.className||""),onClick:a,ref:e.fwdRef},t>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fas fa-circle notif-icon ".concat(n?"l-offset":"")},r.a.createElement("div",{className:"notif-count"},t))),e.children)}function V(e){var t=Object(n.useState)(e.text),a=Object(i.a)(t,2),o=a[0],c=a[1];return Object(n.useEffect)((function(){if(null!=e.text){var t=e.text;e.filterProfanity&&(t=U(t,e.profChar)),e.linkify&&(t=function(e){if(null==e)return;Array.isArray(e)||(e=[e]);var t=/http(s{0,1}):\/\/([\w.]+)\.(\w+)([^\s]*)/g;for(var a in e){for(var n=e[a],o=[],c=0,s=t.exec(n);s;)o.push(n.slice(c,s.index)),o.push(r.a.createElement("a",{href:s[0],target:"blank",key:c},s[0])),c=t.lastIndex,s=t.exec(n);o.push(n.slice(c,n.length)),e[a]=o}return 1==(e=e.flat()).length?e[0]:e}(t)),e.emotify&&(t=function(e){if(null!=e){for(var t in Array.isArray(e)||(e=[e]),e){var a=e[t];if("string"==typeof a){var n=a.split(" ");for(var o in n){var c=n[o];for(var s in M){var i=M[s],l=new RegExp("^".concat(i,"$"),"i");if(c.match(l)){n[o]=r.a.createElement(L,{emote:i});break}s==M.length-1&&(n[o]=n[o]+" ")}}e[t]=n}}return 1==(e=e.flat()).length?e[0]:e}}(t)),c(t)}}),[e.content]),o}function U(e,t){if(null!=e){for(var a in Array.isArray(e)||(e=[e]),e){var n=e[a];if("string"==typeof n){t=t||"*";var r,o=Object(T.a)(P);try{for(o.s();!(r=o.n()).done;)for(var c=r.value,s=new RegExp(c,"i"),i=s.exec(n);i;){var l=i.index,u=i[0].length,m=t.repeat(u);(n=n.split("")).splice(l,u,m),n=n.join(""),i=s.exec(n)}}catch(d){o.e(d)}finally{o.f()}e[a]=n}}return 1==(e=e.flat()).length?e[0]:e}}function G(e,t){function a(a){var n,r=Object(T.a)(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(!o||!o.current||o.current.contains(a.target))return}}catch(c){r.e(c)}finally{r.f()}t()}Array.isArray(e)||(e=[e]),Object(n.useEffect)((function(){return document.addEventListener("click",a),document.addEventListener("contextmenu",a),function(){document.removeEventListener("click",a)}}),e)}function W(e){var t=_(),a=Object(i.a)(t,4),n=a[0],o=a[1],c=a[2],s=a[3],l=e.options.filter((function(t){return t==e.value||t.id==e.value}))[0],u=l?l.label||l:"",m=e.options.map((function(t){return"divider"==t?r.a.createElement("div",{className:"dropdown-divider"}):("string"==typeof t&&(t={id:t,label:t}),r.a.createElement("div",{className:"dropdown-menu-option",key:t.id,onClick:function(){return a=t.id,o(!1),void e.onChange(a);var a}},t.label," ",t.placeholder))}));return r.a.createElement("div",{className:"dropdown ".concat(e.className||""),ref:c},r.a.createElement("div",{className:"dropdown-control",onClick:function(){o(!n)}},e.icon,u,e.caret&&r.a.createElement("i",{className:"fas fa-caret-down"})),n&&r.a.createElement("div",{className:"dropdown-menu",ref:s},m))}function _(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],r=t[1],o=Object(n.useRef)(),c=Object(n.useRef)();return G([c,o],(function(){return r(!1)})),Object(n.useLayoutEffect)((function(){if(a){var e=o.current.getBoundingClientRect(),t=c.current.getBoundingClientRect(),n=e.left,r=e.top+e.height+1+window.scrollY,s=window.innerWidith-(n+t.width);r+t.height-window.scrollY>window.innerHeight&&(r=e.top-t.height-2),s<0?n+s<0&&(s-=n+s):s=0,c.current.style.left=n+"px",c.current.style.top=r+"px",c.current.style.visibility="visible"}})),[a,r,o,c]}function $(e){e=e.slice();for(var t=0;t<e.length;t++)" "==e[t]&&(e=e.replace(" ","-"));return e}function H(e){for(var t=e.toLowerCase().split(" "),a="",n=0;n<t.length;n++)a+=0==n?t[n]:t[n].charAt(0).toUpperCase()+t[n].substring(1);return a}function q(e,t,a){for(;e.length<t;)e=a+e;return e}function Y(e){if(!e)return"";if("string"==typeof e)return e;var t=(e=new Date(e)).toLocaleDateString(),a=e.toTimeString();return e=(t=q((t=t.split("/"))[2],2,"0")+"-"+q(t[0],2,"0")+"-"+q(t[1],2,"0"))+"T"+(a=(a=a.split(":"))[0]+":"+a[1])}a(188);function z(e){return r.a.createElement("div",{className:"nav"},e.children)}function Q(e){var t=e.links.map((function(e,t){return!e.hide&&r.a.createElement(s.c,{exact:e.exact,to:e.path,key:e.path},e.text)}));return r.a.createElement("div",{className:"sub-nav"},t,e.showFilter&&r.a.createElement("div",{className:"filter"},r.a.createElement(W,{value:e.filterSel,options:e.filterOptions,onChange:e.onFilter,icon:e.filterIcon,caret:!0})))}function J(e){var t=e.page,a=e.maxPage,o=e.range||5,c=e.onNav,s=null==a,l=Object(n.useReducer)((function(){if(s)return[t];for(var e=t<=a?t:1,n=e,r=e+1,c=[],i=!0;i;)i=!1,c.length<o&&n>=1&&(c.unshift(n--),i=!0),c.length<o&&r<=a&&(c.push(r++),i=!0);return c}),a,(function(e){if(s)return[1];for(var t=[],a=0;a<e;a++)t.push(a+1);return t})),u=Object(i.a)(l,2),m=u[0],d=u[1];function f(e){e>=1&&(s||e<=a)&&c(e)}Object(n.useEffect)((function(){d()}),[t,o,a]);var p=m.map((function(t){var a="page-num";return e.page==t&&(a+=" page-sel"),r.a.createElement("div",{className:a,onClick:function(){return f(t)},key:t},t)}));return r.a.createElement("div",{className:"page-nav"},r.a.createElement("div",{className:"page-nav-left max",onClick:function(){return f(1)}},"\xab"),r.a.createElement("div",{className:"page-nav-left",onClick:function(){return f(t-1)}},"\u2039"),p,r.a.createElement("div",{className:"page-nav-right ".concat(s?"max":""),onClick:function(){return f(t+1)}},"\u203a"),!s&&r.a.createElement("div",{className:"page-nav-right max",onClick:function(){return f(a)}},"\xbb"))}function K(e){return r.a.createElement("div",{className:"search-bar"},r.a.createElement("input",{type:"text",value:e.value,placeholder:e.placeholder,onChange:function(t){e.onInput(t.target.value)}}),r.a.createElement("div",{className:"search-icon"},r.a.createElement("i",{className:"fas fa-search"})))}var X=a(16),Z=a(99),ee=a.n(Z),te=a(53),ae=a.n(te);function ne(e){return r.a.createElement("div",{className:"loading-page ".concat(e.className||"")},r.a.createElement(ae.a,{type:"bars",color:"#62a0db"}))}function re(){var e=Object(n.useContext)(k),t=e.history,a=e.updateHistory,o=(e.updatePlayers,e.stateViewing),c=e.updateStateViewing,s=e.self,i=e.players,l=e.isSpectator,u=Object(n.useRef)(!1),m=t.states[o]?t.states[o].meetings:{},d=(t.states[o]&&t.states[o].stateEvents,["gunshot"]),f=[!1],p=[!1],h=[1];return Object(n.useEffect)((function(){c({type:"current"})}),[t.currentState]),Object(n.useEffect)((function(){e.loadAudioFiles(d,f,p,h),e.review&&c({type:"first"})}),[]),jt((function(t){t.on("state",(function(t){u.current&&e.playAudio("bell"),u.current=!0})),t.on("winners",(function(e){})),t.on("gunshot",(function(){e.playAudio("gunshot")}))}),e.socket),r.a.createElement(r.a.Fragment,null,r.a.createElement(kt,{gameType:"Mafia",setup:e.setup,history:t,stateViewing:o,updateStateViewing:c,players:i,socket:e.socket,options:e.options,spectatorCount:e.spectatorCount,setLeave:e.setLeave,finished:e.finished,review:e.review,setShowSettingsModal:e.setShowSettingsModal,setRehostId:e.setRehostId,dev:e.dev,gameName:r.a.createElement("div",{className:"game-name"},r.a.createElement("span",null,"M"),"afia"),timer:r.a.createElement(Gt,{timers:e.timers,history:t})}),r.a.createElement(St,{leftPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(Pt,{players:i,history:t,gameType:"Mafia",stateViewing:o,activity:e.activity}),r.a.createElement(Ht,{filters:e.speechFilters,setFilters:e.setSpeechFilters,stateViewing:o})),centerPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(xt,{socket:e.socket,history:t,updateHistory:a,players:i,stateViewing:o,settings:e.settings,filters:e.speechFilters,review:e.review,options:e.options,setTyping:e.setTyping,agoraClient:e.agoraClient,localAudioTrack:e.localAudioTrack,setActiveVoiceChannel:e.setActiveVoiceChannel,muted:e.muted,setMuted:e.setMuted,deafened:e.deafened,setDeafened:e.setDeafened})),rightPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(Rt,{socket:e.socket,meetings:m,players:i,self:s,history:t,stateViewing:o}),!e.review&&!l&&t.currentState>=0&&e.setup.lastWill&&r.a.createElement(Wt,{lastWill:e.lastWill,socket:e.socket}),!e.review&&!l&&r.a.createElement(qt,{stateViewing:o}))}))}function oe(e){var t=Object(n.useContext)(k),a=t.history,o=t.updateHistory,c=(t.updatePlayers,t.stateViewing),s=t.updateStateViewing,i=t.self,l=t.players,u=t.isSpectator,m=Object(n.useRef)(!1),d=a.states[c]?a.states[c].meetings:{},f=(a.states[c]&&a.states[c].stateEvents,[]),p=[],h=[],v=[];return Object(n.useEffect)((function(){s({type:"current"})}),[a.currentState]),Object(n.useEffect)((function(){t.loadAudioFiles(f,p,h,v),t.review&&s({type:"first"})}),[]),jt((function(e){e.on("state",(function(e){m.current&&t.playAudio("bell"),m.current=!0})),e.on("winners",(function(e){}))}),t.socket),r.a.createElement(r.a.Fragment,null,r.a.createElement(kt,{gameType:"Split Decision",setup:t.setup,history:a,stateViewing:c,updateStateViewing:s,players:l,socket:t.socket,options:t.options,spectatorCount:t.spectatorCount,setLeave:t.setLeave,finished:t.finished,review:t.review,setShowSettingsModal:t.setShowSettingsModal,setRehostId:t.setRehostId,dev:t.dev,gameName:r.a.createElement("div",{className:"game-name"},r.a.createElement("span",null,"Split")," Decision"),timer:r.a.createElement(Gt,{timers:t.timers,history:a})}),r.a.createElement(St,{leftPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(Pt,{players:l,history:a,gameType:"Split Decision",stateViewing:c,activity:t.activity}),r.a.createElement(Ht,{filters:t.speechFilters,setFilters:t.setSpeechFilters,stateViewing:c})),centerPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(xt,{socket:t.socket,history:a,updateHistory:o,players:l,stateViewing:c,settings:t.settings,filters:t.speechFilters,options:t.options,agoraClient:t.agoraClient,localAudioTrack:t.localAudioTrack,setActiveVoiceChannel:t.setActiveVoiceChannel,muted:t.muted,setMuted:t.setMuted,deafened:t.deafened,setDeafened:t.setDeafened})),rightPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(Rt,{socket:t.socket,meetings:d,players:l,self:i,history:a,stateViewing:c}),!u&&r.a.createElement(qt,{stateViewing:c}))}))}function ce(e){var t=Object(n.useContext)(k),a=t.history,o=t.updateHistory,c=(t.updatePlayers,t.stateViewing),s=t.updateStateViewing,i=t.self,l=t.players,u=t.isSpectator,m=Object(n.useRef)(!1),d=a.states[c]?a.states[c].meetings:{},f=(a.states[c]&&a.states[c].stateEvents,[]),p=[],h=[],v=[];return Object(n.useEffect)((function(){s({type:"current"})}),[a.currentState]),Object(n.useEffect)((function(){t.loadAudioFiles(f,p,h,v),t.review&&s({type:"first"})}),[]),jt((function(e){e.on("state",(function(e){m.current&&t.playAudio("bell"),m.current=!0})),e.on("winners",(function(e){}))}),t.socket),r.a.createElement(r.a.Fragment,null,r.a.createElement(kt,{gameType:"Resistance",setup:t.setup,history:a,stateViewing:c,updateStateViewing:s,players:l,socket:t.socket,options:t.options,spectatorCount:t.spectatorCount,setLeave:t.setLeave,finished:t.finished,review:t.review,setShowSettingsModal:t.setShowSettingsModal,setRehostId:t.setRehostId,dev:t.dev,gameName:r.a.createElement("div",{className:"game-name"},r.a.createElement("span",null,"R"),"esistance"),timer:r.a.createElement(Gt,{timers:t.timers,history:a})}),r.a.createElement(St,{leftPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(Pt,{players:l,history:a,gameType:"Resistance",stateViewing:c,activity:t.activity}),r.a.createElement(Ht,{filters:t.speechFilters,setFilters:t.setSpeechFilters,stateViewing:c})),centerPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(xt,{socket:t.socket,history:a,updateHistory:o,players:l,stateViewing:c,settings:t.settings,filters:t.speechFilters,options:t.options,agoraClient:t.agoraClient,localAudioTrack:t.localAudioTrack,setActiveVoiceChannel:t.setActiveVoiceChannel,muted:t.muted,setMuted:t.setMuted,deafened:t.deafened,setDeafened:t.setDeafened})),rightPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(Rt,{socket:t.socket,meetings:d,players:l,self:i,history:a,stateViewing:c}),!u&&r.a.createElement(qt,{stateViewing:c}))}))}function se(e){var t=Object(n.useContext)(k),a=t.history,o=t.updateHistory,c=(t.updatePlayers,t.stateViewing),s=t.updateStateViewing,i=t.self,l=t.players,u=t.isSpectator,m=Object(n.useRef)(!1),d=a.states[c]?a.states[c].meetings:{},f=(a.states[c]&&a.states[c].stateEvents,["gunshot"]),p=[!1],h=[!1],v=[1];return Object(n.useEffect)((function(){s({type:"current"})}),[a.currentState]),Object(n.useEffect)((function(){t.loadAudioFiles(f,p,h,v),t.review&&s({type:"first"})}),[]),jt((function(e){e.on("state",(function(e){m.current&&t.playAudio("bell"),m.current=!0})),e.on("winners",(function(e){})),e.on("gunshot",(function(){t.playAudio("gunshot")}))}),t.socket),r.a.createElement(r.a.Fragment,null,r.a.createElement(kt,{gameType:"One Night",setup:t.setup,history:a,stateViewing:c,updateStateViewing:s,players:l,socket:t.socket,options:t.options,spectatorCount:t.spectatorCount,setLeave:t.setLeave,finished:t.finished,review:t.review,setShowSettingsModal:t.setShowSettingsModal,setRehostId:t.setRehostId,dev:t.dev,gameName:r.a.createElement("div",{className:"game-name"},r.a.createElement("span",null,"One")," Night"),timer:r.a.createElement(Gt,{timers:t.timers,history:a})}),r.a.createElement(St,{leftPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(Pt,{players:l,history:a,gameType:"One Night",stateViewing:c,activity:t.activity}),r.a.createElement(Ht,{filters:t.speechFilters,setFilters:t.setSpeechFilters,stateViewing:c})),centerPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(xt,{socket:t.socket,history:a,updateHistory:o,players:l,stateViewing:c,settings:t.settings,filters:t.speechFilters,options:t.options,agoraClient:t.agoraClient,localAudioTrack:t.localAudioTrack,setActiveVoiceChannel:t.setActiveVoiceChannel,muted:t.muted,setMuted:t.setMuted,deafened:t.deafened,setDeafened:t.setDeafened})),rightPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(Rt,{socket:t.socket,meetings:d,players:l,self:i,history:a,stateViewing:c}),!u&&r.a.createElement(qt,{stateViewing:c}))}))}a(218);function ie(e){return r.a.createElement("div",{className:"span-panel main landing-page"},r.a.createElement("div",{className:"banner"},r.a.createElement("div",{className:"logo"}),r.a.createElement("div",{className:"characters-circle"})),r.a.createElement("div",{className:"play-break"},r.a.createElement("div",{class:"play-btn-wrapper"},r.a.createElement(s.b,{to:"/auth/signup"},"Play Mafia"))),r.a.createElement("div",{className:"intro"},"BeyondMafia is the mafia site that is revolutionary in design, safety, and has a thriving community of users from all walks of life. With competitive and casual live mafia, and other gamemodes like Resistance, you're sure to find something that suits how YOU want to play."),r.a.createElement("div",{class:"mafia-features"},r.a.createElement("div",{class:"chat-mafia"},r.a.createElement("div",{class:"village-character"}),r.a.createElement("div",{class:"feature-title"},"Chat Mafia"),r.a.createElement("div",{class:"feature-desc"},"10-20 minute games with a variety of roles! Play wiht classic roles, or try out something different in the Sandbox lobby. You can create your own custom roles, too, using modifiers or by contributing to the open source codebase!")),r.a.createElement("div",{class:"forum-mafia"},r.a.createElement("div",{class:"cop-character"}),r.a.createElement("div",{class:"feature-title"},"Forum Mafia"),r.a.createElement("div",{class:"feature-desc"},"Play Mafia in the forums. More features are coming soon with the planned forum game engine!"))),r.a.createElement("div",{class:"other-games"},r.a.createElement("div",{class:"other-games-img"}),r.a.createElement("div",{class:"feature-title"},"Other Games"),r.a.createElement("div",{class:"feature-desc"},"Explore other Mafia-esque games like Resistance, One Night Ultimate Werewolf, and 2 Rooms and a Boom.")),r.a.createElement("div",{className:"play-break"},r.a.createElement("div",{class:"play-btn-wrapper"},r.a.createElement(s.b,{to:"/auth/signup"},"Play Mafia"))))}var le=a(34),ue=a.n(le),me=a(163),de=a(97),fe=a.n(de);a(426),a(427),a(428),a(429),a(430),a(431);function pe(e){function t(t,a,n){var r=t.target.value;null!=a.min&&Number(r)<a.min?r=a.min:null!=a.max&&Number(r)>a.max&&(r=a.max),e.onChange({ref:a.ref,prop:"value",value:r,localOnly:n})}var a=e.fields.map((function(a,n){var o,c="function"==typeof a.disabled?a.disabled(e.deps):a.disabled,s="field-wrapper ".concat(c?"disabled":"");if(o="string"==typeof a.showIf?[a.showIf]:a.showIf,Array.isArray(o)){var i,l=Object(T.a)(o);try{for(l.s();!(i=l.n()).done;){var u=i.value,m="!"==u[0];m&&(u=u.slice(1));var d,f=Object(T.a)(e.fields);try{for(f.s();!(d=f.n()).done;){var p=d.value;if(p.ref==u&&"boolean"==p.type){if(0==(1==p.value^m))return;break}}}catch(v){f.e(v)}finally{f.f()}}}catch(v){l.e(v)}finally{l.f()}}else if("function"==typeof o&&!o(e.deps))return;var h="function"==typeof a.value?a.value(e.deps):a.value;switch(a.type){case"text":return r.a.createElement("div",{className:s,key:a.ref},r.a.createElement("div",{className:"label"},a.label),r.a.createElement("input",{type:a.type,value:h||"",placeholder:a.placeholder,disabled:c,onChange:function(e){return!a.fixed&&t(e,a,a.saveBtn)},onClick:function(e){return a.highlight&&e.target.select()}}),a.saveBtn&&e.deps[a.saveBtnDiffer]!=a.value&&r.a.createElement("div",{className:"btn btn-theme extra",onClick:function(n){(!a.confirm||window.confirm(a.confirm))&&(a.saveBtnOnClick?a.saveBtnOnClick(a.value,e.deps):t(n,a))}},a.saveBtn));case"number":return r.a.createElement("div",{className:s,key:a.ref},r.a.createElement("div",{className:"label"},a.label),r.a.createElement("input",{type:"number",value:a.value||"0",min:a.min,max:a.max,step:a.step,disabled:c,onChange:function(e){return t(e,a)}}));case"boolean":return r.a.createElement("div",{className:s,key:a.ref},r.a.createElement("div",{className:"label"},a.label),r.a.createElement("div",{className:"switch-wrapper"},r.a.createElement(he,{value:a.value||!1,disabled:c,onChange:function(e){return t(e,a)}})));case"select":return r.a.createElement("div",{className:s,key:a.ref},r.a.createElement("div",{className:"label"},a.label),r.a.createElement("select",{value:a.value||a.options[0].ref,disabled:c,onChange:function(e){return t(e,a)}},a.options.map((function(e){return r.a.createElement("option",{value:e.value,key:e.value},e.label)}))));case"range":return r.a.createElement("div",{className:s,key:a.ref},r.a.createElement("div",{className:"label"},a.label),r.a.createElement("div",{className:"range-wrapper"},r.a.createElement("input",{type:"range",min:a.min,max:a.max,step:a.step,value:a.value,disabled:c,onChange:function(e){return t(e,a)}})));case"color":return r.a.createElement("div",{className:s,key:a.ref},r.a.createElement("div",{className:"label"},a.label),r.a.createElement(ve,{value:a.value,default:a.default,alpha:a.alpha,disabled:c,onChange:function(e){return t(e,a)}}),!a.noReset&&a.value!=a.default&&a.value&&r.a.createElement("div",{className:"btn btn-theme extra",onClick:function(){return t({target:{value:a.default}},a)}},"Reset"));case"datetime-local":return r.a.createElement("div",{className:s,key:a.ref},r.a.createElement("div",{className:"label"},a.label),r.a.createElement("div",{className:"datetime-wrapper"},r.a.createElement("input",{type:"datetime-local",min:Y(a.min),max:Y(a.max),value:Y(a.value),disabled:c,onChange:function(e){return t(e,a)}})))}}));return r.a.createElement("div",{className:"form"},a,e.submitText&&r.a.createElement("div",{className:"btn btn-theme-sec",onClick:e.onSubmit},e.submitText))}function he(e){return r.a.createElement("div",{className:"switch ".concat(e.value?"on":""),onClick:function(){return!e.disabled&&e.onChange({target:{value:!e.value}})}},r.a.createElement("div",{className:"track"}),r.a.createElement("div",{className:"thumb"}),r.a.createElement("input",{type:"hidden",value:e.value}))}function ve(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),o=a[0],c=a[1],s=Object(n.useRef)(),l=e.value||e.default,u=e.disabled;return G(s,(function(){return c(!1)})),r.a.createElement("div",{className:"color-picker ".concat(u?"disabled":""),style:{backgroundColor:l},onClick:function(e){u||e.target!=s.current||c(!o)},ref:s},o&&r.a.createElement(me.a,{color:l,disableAlpha:!e.alpha,onChangeComplete:function(t,a){e.onChange({target:{value:t.hex}})}}))}function ge(e){var t=Object(n.useRef)();return r.a.createElement("div",{className:e.className,onClick:function(){var a=!0;e.onClick&&(a=e.onClick()),a&&t.current.click()}},e.children,r.a.createElement("input",{className:"hidden-upload",ref:t,type:"file",onChange:function(t){return e.onFileUpload(t.target.files,e.name)}}))}function be(e){var t=Object(n.useState)(e),a=Object(i.a)(t,1)[0],r=Object(n.useReducer)((function(e,t){var a=Object(X.a)(e);for(var n in Array.isArray(t)||(t=[t]),a){var r,o=a[n],c=Object(h.a)({},o),s=Object(T.a)(t);try{for(s.s();!(r=s.n()).done;){var i=r.value;if(o.ref&&o.ref==i.ref){"string"==typeof i.value&&"boolean"==o.type&&(i.value="true"==i.value),c[i.prop]=i.value;break}}}catch(l){s.e(l)}finally{s.f()}a[n]=c}return a}),e),o=Object(i.a)(r,2),c=o[0],s=o[1];return[c,s,function(){var e,t=[],n=Object(T.a)(a);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push({ref:r.ref,prop:"value",value:r.value})}}catch(o){n.e(o)}finally{n.f()}s(t)}]}function ye(e){var t=e.value,a=e.setValue,o=Object(n.useState)(""),c=Object(i.a)(o,2),s=c[0],l=c[1],u=Object(n.useState)(!1),m=Object(i.a)(u,2),d=m[0],f=m[1],p=Object(n.useState)(!1),h=Object(i.a)(p,2),v=h[0],g=h[1],b=Object(n.useState)(e.options),y=Object(i.a)(b,2),E=y[0],w=y[1],O=Object(n.useRef)(),N=Object(n.useRef)();Object(n.useEffect)((function(){if(d){var e=O.current.getBoundingClientRect(),t=N.current.getBoundingClientRect(),a=e.top+e.height+1;a+t.height>window.innerHeight&&(a=e.top-t.height-2),N.current.style.top=a+"px",N.current.style.visibility="visible"}}));var j=E.map((function(t){return r.a.createElement("div",{className:"option-row",onClick:function(){return function(t){a(t),l(""),f(!1),g(!1),e.onChange&&e.onChange(t)}(t)},key:t},t)}));return r.a.createElement("div",{className:"search-select",tabIndex:"0",onFocus:function(){f(!0)},onBlur:function(){v||(f(!1),l(""),w(e.options))},ref:O},r.a.createElement("input",{value:s,placeholder:t,onChange:function(t){if(l(t.target.value),""==t.target.value)w(e.options);else{var a=e.options.filter((function(e){return e.toLowerCase().includes(t.target.value.toLowerCase())}));w(a)}},onKeyDown:function(t){"Enter"==t.key?(a(E[0]),l(""),f(!1),g(!1),e.onChange&&e.onChange(E[0])):d||f(!0)}}),r.a.createElement("div",{className:"icon-wrapper"},r.a.createElement("i",{className:"fas fa-chevron-down"})),d&&r.a.createElement("div",{className:"option-list",onMouseEnter:function(){g(!0)},onMouseLeave:function(){g(!1)},ref:N},j.length>0&&j,!j.length&&r.a.createElement("div",{className:"no-options"},"No Options")))}function Ee(e){var t=Object(n.useState)("write"),a=Object(i.a)(t,2),o=a[0],c=a[1];return r.a.createElement(fe.a,{value:e.value,onChange:e.onChange,selectedTab:o,onTabChange:c,classes:{preview:"md-content"},generateMarkdownPreview:function(e){return Promise.resolve(r.a.createElement(ue.a,{source:e}))}})}a(153);function we(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(),s=Object(i.a)(c,2),l=s[0],m=s[1],f=Object(n.useState)(),p=Object(i.a)(f,2),h=p[0],v=p[1],g=Object(n.useState)(),b=Object(i.a)(g,2),y=b[0],E=b[1],j=Object(n.useState)(""),k=Object(i.a)(j,2),S=k[0],x=k[1],C=Object(n.useState)(),L=Object(i.a)(C,2),A=L[0],M=L[1],P=Object(n.useState)(!1),R=Object(i.a)(P,2),F=R[0],B=R[1],V=Object(n.useState)(!1),G=Object(i.a)(V,2),W=G[0],_=G[1],$=Object(n.useState)({}),H=Object(i.a)($,2),q=H[0],Y=H[1],z=Object(n.useState)({}),Q=Object(i.a)(z,2),K=Q[0],X=Q[1],Z=Object(n.useState)([]),ee=Object(i.a)(Z,2),te=ee[0],ae=ee[1],re=Object(n.useState)([]),oe=Object(i.a)(re,2),ce=oe[0],se=oe[1],ie=Object(n.useState)(!1),le=Object(i.a)(ie,2),me=le[0],de=le[1],fe=Object(n.useState)(1),pe=Object(i.a)(fe,2),he=pe[0],ve=pe[1],be=Object(n.useState)(1),ye=Object(i.a)(be,2),we=ye[0],Oe=ye[1],Ne=Object(n.useState)([]),je=Object(i.a)(Ne,2),ke=je[0],Ce=je[1],Ie=Object(n.useState)([]),Te=Object(i.a)(Ie,2),Le=Te[0],Ae=Te[1],Me=Object(n.useState)({Mafia:{}}),Pe=Object(i.a)(Me,2),Re=Pe[0],Fe=Pe[1],De=Object(n.useContext)(O),Be=Object(n.useContext)(N),Ue=Object(u.g)(),Ge=I(),_e=Object(u.i)().userId,$e=_e==De.id,He=!$e&&-1!=De.blockedUsers.indexOf(_e);function qe(e,t){if(e.length){var a=new FormData;a.append("image",e[0]);var n,r=Object(T.a)(document.getElementsByClassName("hidden-upload"));try{for(r.s();!(n=r.n()).done;){n.value.value=""}}catch(o){r.e(o)}finally{r.f()}d.a.post("/user/".concat(t),a).then((function(e){switch(t){case"avatar":v(!0),Be.clearCache();break;case"banner":E(!0),Be.clearCache()}})).catch(Ge)}}function Ye(e){var t;if(1==e?t="last=Infinity":e==we&&(t="first=-1"),e<he)t="first=".concat(ke[0].lastActive);else{if(!(e>he))return;t="last=".concat(ke[ke.length-1].lastActive)}d.a.get("/user/".concat(_e,"/friends?").concat(t)).then((function(t){Ce(t.data),ve(e)})).catch(Ge)}Object(n.useEffect)((function(){me&&de(!1)}),[me]),Object(n.useEffect)((function(){_e&&(o(!1),d.a.get("/user/".concat(_e,"/profile")).then((function(e){o(!0),m(e.data.name),v(e.data.avatar),E(e.data.banner),x(U(e.data.bio,"\\*")||""),_(e.data.isFriend),Y(e.data.settings),X(e.data.accounts||{}),ae(e.data.games),se(e.data.setups),Oe(e.data.maxFriendsPage),Ae(e.data.friendRequests),Fe(e.data.stats),document.title="".concat(e.data.name,"'s Profile | BeyondMafia")})).catch((function(e){Ge(e),Ue.push("/play")})),d.a.get("/user/".concat(_e,"/friends")).then((function(e){Ce(e.data)})).catch(Ge))}),[_e]);var ze,Qe={},Je={};q.backgroundColor&&(Qe.backgroundColor=q.backgroundColor),y&&(Je.backgroundImage="url(/uploads/".concat(_e,"_banner.jpg?t=").concat(Be.cacheVal,")")),"stretch"==q.bannerFormat&&(Je.backgroundSize="100% 100%"),ze=Object.keys(Re.Mafia).map((function(e){var t,a=Re.Mafia[e];if(a.total<1)a="-";else if("wins"==e)a="".concat(Math.round(a.count/a.total*100),"%");else{var n="F",o=Object.keys(w[e]).reverse(),c=0;for(a=a.count/a.total;a>=w[e][o[c]]&&c<o.length;)n=o[c++];a=n}return r.a.createElement("div",{className:"rating",key:e},r.a.createElement("div",{className:"name"},(t=e).charAt(0).toUpperCase()+t.substring(1)),r.a.createElement("div",{className:"score"},a))}));var Ke=te.map((function(e){return r.a.createElement(We,{game:e,type:e.status||"Finished",key:e.id,smallSetup:!0})})),Xe=ce.map((function(e){return r.a.createElement(ut,{setup:e,key:e.id})})),Ze=Le.map((function(e){return r.a.createElement("div",{className:"friend-request",key:e.id},r.a.createElement(xe,{id:e.id,name:e.name,avatar:e.avatar}),r.a.createElement("div",{className:"btns"},r.a.createElement("i",{className:"fas fa-check",onClick:function(){return t=e.id,void d.a.post("/user/friend",{user:t}).then((function(e){var a=Le.slice().filter((function(e){return e.id!=t}));Ae(a),Be.showAlert(e.data,"success")})).catch(Ge);var t}}),r.a.createElement("i",{className:"fas fa-times",onClick:function(){return t=e.id,void d.a.post("/user/friend/reject",{user:t}).then((function(e){var a=Le.slice().filter((function(e){return e.id!=t}));Ae(a),Be.showAlert(e.data,"success")})).catch(Ge);var t}})))})),et=ke.map((function(e){return r.a.createElement("div",{className:"friend",key:e.id},r.a.createElement(xe,{id:e.id,name:e.name,avatar:e.avatar}),r.a.createElement("div",{className:"last-active"},r.a.createElement(D,{minSec:!0,millisec:Date.now()-e.lastActive,suffix:" ago"})))}));return!De.loaded||De.loggedIn||_e?De.loaded&&De.loggedIn&&!_e?r.a.createElement(u.a,{to:"/user/".concat(De.id)}):a&&De.loaded?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"profile"},r.a.createElement("div",{className:"main-panel",style:Qe},r.a.createElement("div",{className:"banner",style:Je},$e&&r.a.createElement(ge,{className:"edit",name:"banner",onClick:function(e,t){return!!De.itemsOwned.customProfile||(Ge("You must purchase profile customization with coins from the Shop."),!1)},onFileUpload:qe},r.a.createElement("i",{className:"far fa-file-image"}))),r.a.createElement("div",{className:"user-info"},r.a.createElement("div",{className:"avi-name-row"},r.a.createElement("div",{className:"avi-name"},!me&&r.a.createElement(Se,{large:!0,id:_e,hasImage:h,bustCache:me,name:l,edit:$e,onUpload:qe}),r.a.createElement("div",{className:"name"},l))),!$e&&De.loggedIn&&r.a.createElement("div",{className:"options"},r.a.createElement("i",{className:"fas fa-user-plus ".concat(W?"sel":""),onClick:function(){if(W&&!window.confirm("Are you sure you wish to unfriend or cancel your friend request?"))return;d.a.post("/user/friend",{user:_e}).then((function(e){_(!W),Be.showAlert(e.data,"success")})).catch(Ge)}}),r.a.createElement("i",{className:"fas fa-ban ".concat(He?"sel":""),onClick:function(){if(!He&&!window.confirm("Are you sure you wish to block this user?"))return;d.a.post("/user/block",{user:_e}).then((function(){De.blockUserToggle(_e),He?Be.showAlert("User unblocked.","success"):Be.showAlert("User blocked.","success")})).catch(Ge)},title:"Block user"})),r.a.createElement("div",{className:"accounts"},K.discord&&q.showDiscord&&r.a.createElement("div",{className:"account-badge"},r.a.createElement("div",{className:"icon discord-icon"}),r.a.createElement("div",{className:"username-wrapper"},r.a.createElement("div",{className:"username"},K.discord))),K.twitch&&q.showTwitch&&r.a.createElement("div",{className:"account-badge"},r.a.createElement("div",{className:"icon twitch-icon"}),r.a.createElement("div",{className:"username-wrapper"},r.a.createElement("div",{className:"username"},K.twitch))),K.steam&&q.showSteam&&r.a.createElement("div",{className:"account-badge"},r.a.createElement("div",{className:"icon steam-icon"}),r.a.createElement("div",{className:"username-wrapper"},r.a.createElement("div",{className:"username"},K.steam)))),r.a.createElement("div",{className:"bio ".concat($e&&!F?"edit":""),onClick:function(){B($e),M(S)}},!F&&r.a.createElement("div",{className:"md-content"},r.a.createElement(ue.a,{source:S})),F&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Ee,{value:S,onChange:x}),r.a.createElement("div",{className:"buttons"},r.a.createElement("div",{className:"btn btn-theme",onClick:function(e){d.a.post("/user/bio",{bio:S}).then((function(){B(!1),x(U(S,"\\*"))})).catch(Ge)}},"Submit"),r.a.createElement("div",{className:"btn btn-theme-sec",onClick:function(e){e.stopPropagation(),B(!1),x(A)}},"Cancel")))))),r.a.createElement("div",{className:"side column"},ze.length>0&&r.a.createElement("div",{className:"box-panel ratings"},r.a.createElement("div",{className:"heading"},"Mafia Ratings"),r.a.createElement("div",{className:"content"},ze)),r.a.createElement("div",{className:"box-panel recent-games"},r.a.createElement("div",{className:"heading"},"Recent Games"),r.a.createElement("div",{className:"content"},Ke,0==te.length&&"No games")),Le.length>0&&r.a.createElement("div",{className:"box-panel friend-requests"},r.a.createElement("div",{className:"heading"},"Friend Requests"),r.a.createElement("div",{className:"content"},Ze)),r.a.createElement("div",{className:"box-panel friends"},r.a.createElement("div",{className:"heading"},"Friends"),r.a.createElement("div",{className:"content"},r.a.createElement(J,{page:he,maxPage:we,onNav:Ye}),et,0==ke.length&&"No friends yet",r.a.createElement(J,{page:he,maxPage:we,onNav:Ye}))),r.a.createElement("div",{className:"box-panel created-setups"},r.a.createElement("div",{className:"heading"},"Setups Created"),r.a.createElement("div",{className:"content"},Xe,0==ce.length&&"No setups")))),r.a.createElement(Ve,{location:_e})):r.a.createElement(ne,null):r.a.createElement(u.a,{to:"/play"})}a(432);function Oe(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),o=a[0],c=a[1],s=Object(n.useState)(!1),l=Object(i.a)(s,2),m=l[0],f=l[1],h=Object(n.useState)({}),v=Object(i.a)(h,2),g=v[0],b=v[1],y=Object(u.g)(),E=Object(n.useContext)(O),w=Object(n.useContext)(N),j=I(),k=be([{label:"Referral URL",ref:"referralURL",type:"text",value:function(e){return"".concat("http://localhost:3000","/auth/login?ref=").concat(e.user.id)},fixed:!0,highlight:!0},{label:"DMs from Friends Only",ref:"onlyFriendDMs",type:"boolean"},{label:"Hide Deleted Posts",ref:"hideDeleted",type:"boolean",showIf:function(e){return e.user.perms.viewDeleted}}]),S=Object(i.a)(k,2),x=S[0],C=S[1],T=be([{label:"Name",ref:"username",type:"text",saveBtn:"Change",saveBtnDiffer:"name",saveBtnOnClick:function(e,t){var a="";-1!=Ne.indexOf(e.toLowerCase())&&(a=window.prompt("This name is reserved, please enter your reservation code."));d.a.post("/user/name",{name:e,code:a}).then((function(a){t.siteInfo.showAlert("Username changed","success"),t.user.set(p()(t.user,{name:{$set:e},itemsOwned:{nameChange:{$set:t.user.itemsOwned.nameChange-1}}}))})).catch(t.errorAlert)},confirm:"Are you sure you wish to change your username?"},{label:"Show Discord",ref:"showDiscord",type:"boolean",showIf:function(e){return e.accounts.discord&&e.accounts.discord.id}},{label:"Show Twitch",ref:"showTwitch",type:"boolean",showIf:function(e){return e.accounts.twitch&&e.accounts.twitch.id}},{label:"Show Steam",ref:"showSteam",type:"boolean",showIf:function(e){return e.accounts.steam&&e.accounts.steam.id}},{label:"Background Color",ref:"backgroundColor",type:"color",default:"#262626",disabled:function(e){return!e.user.itemsOwned.customProfile}},{label:"Banner Format",ref:"bannerFormat",type:"select",options:[{label:"Tile",value:"tile"},{label:"Stretch",value:"stretch"}],disabled:function(e){return!e.user.itemsOwned.customProfile}}]),L=Object(i.a)(T,2),A=L[0],M=L[1],P=be([{label:"Name Color",ref:"nameColor",type:"color",default:"#fff",disabled:function(e){return!e.user.itemsOwned.textColors}},{label:"Text Color",ref:"textColor",type:"color",default:"#fff",disabled:function(e){return!e.user.itemsOwned.textColors}}]),R=Object(i.a)(P,2),F=R[0],D=R[1];function B(e,t){"value"!=e.prop||e.localOnly||d.a.post("/user/settings/update",{prop:e.ref,value:e.value}).catch(j),t(e)}return Object(n.useEffect)((function(){document.title="Settings | BeyondMafia"}),[]),Object(n.useEffect)((function(){E.loaded&&E.loggedIn&&(o||d.a.get("/user/settings/data").then((function(e){var t=[],a=[],n=[];for(var r in e.data)e.data[r]&&(t.push({ref:r,prop:"value",value:e.data[r]}),a.push({ref:r,prop:"value",value:e.data[r]}),n.push({ref:r,prop:"value",value:e.data[r]}));C(t),M(a),D(n),c(!0)})).catch(j),m||d.a.get("/user/accounts").then((function(e){b(e.data),f(!0)})).catch(j))}),[E]),E.loaded&&!E.loggedIn?r.a.createElement(u.a,{to:"/play"}):o&&m&&E.loaded?r.a.createElement("div",{className:"span-panel main settings"},r.a.createElement("div",{className:"heading"},"Site"),r.a.createElement(pe,{fields:x,deps:{user:E},onChange:function(e){return B(e,C)}}),r.a.createElement("div",{className:"heading"},"Profile"),r.a.createElement(pe,{fields:A,deps:{name:E.name,user:E,accounts:g,siteInfo:w,errorAlert:j},onChange:function(e){return B(e,M)}}),r.a.createElement("div",{className:"heading"},"Game"),r.a.createElement(pe,{fields:F,deps:{user:E},onChange:function(e){return B(e,D)}}),r.a.createElement("div",{className:"heading"},"Accounts"),r.a.createElement("div",{className:"accounts-row"},r.a.createElement("div",{className:"accounts-column"},r.a.createElement("div",{className:"btn btn-theme-sec logout",onClick:function(){d.a.post("/user/logout").then((function(e){E.clear(),y.push("/")})).catch(j)}},"Sign Out"),r.a.createElement("div",{className:"btn delete-account",onClick:function(){window.confirm("Are you sure you wish to delete your account? This is irreversible.")&&d.a.post("/user/delete").then((function(e){E.clear(),y.push("/")})).catch(j)}},"Delete Account")))):r.a.createElement(ne,null)}var Ne=["admin","administrator","mod","moderator","dev","developer","giga","rend","arcbell"];a(433);function je(e){var t=Object(n.useState)({shopItems:[],balance:0}),a=Object(i.a)(t,2),o=a[0],c=a[1],s=Object(n.useState)(!1),l=Object(i.a)(s,2),m=l[0],f=l[1],h=Object(n.useContext)(O),g=Object(n.useContext)(N),b=I();Object(n.useEffect)((function(){document.title="Shop | BeyondMafia"}),[]),Object(n.useEffect)((function(){h.loaded&&h.loggedIn&&d.a.get("/shop/info").then((function(e){c(e.data),f(!0)})).catch(b)}),[h.loaded]);var y=o.shopItems.map((function(e,t){return r.a.createElement("div",{className:"shop-item",key:t},r.a.createElement("div",{className:"name"},e.name),r.a.createElement("div",{className:"desc"},e.desc),r.a.createElement("div",{className:"bottom"},r.a.createElement("div",{className:"price"},r.a.createElement("i",{className:"fas fa-coins"}),e.price," coins"),r.a.createElement("div",{className:"owned"},"Owned:",r.a.createElement("div",{className:"amt"},h.itemsOwned[e.key],null!=e.limit&&" / ".concat(e.limit))),r.a.createElement("div",{className:"buy btn btn-theme",disabled:null!=e.limit&&h.itemsOwned[e.key]>=e.limit,onClick:function(){return function(e){var t=o.shopItems[e];window.confirm("Are you sure you wish to buy ".concat(t.name," for ").concat(t.price," coins?"))&&d.a.post("/shop/spendCoins",{item:e}).then((function(){g.showAlert("Item purchased.","success"),c(p()(o,{balance:{$set:o.balance-t.price}})),h.set(p()(h.state,{itemsOwned:Object(v.a)({},t.key,{$set:h.itemsOwned[t.key]+1})}))})).catch(b)}(t)}},"Buy")))}));return h.loaded&&!h.loggedIn?r.a.createElement(u.a,{to:"/play"}):m?r.a.createElement("div",{className:"span-panel main shop"},r.a.createElement("div",{className:"top-bar"},r.a.createElement("div",{className:"balance"},r.a.createElement("i",{className:"fas fa-coins"}),o.balance)),r.a.createElement("div",{className:"shop-items"},y)):r.a.createElement(ne,null)}function ke(e){var t=Object(n.useContext)(O),a=[{text:"Profile",path:t.id?"/user/".concat(t.id):"/user",exact:!0,hide:!t.loggedIn},{text:"Settings",path:"/user/settings",hide:!t.loggedIn},{text:"Shop",path:"/user/shop",hide:!t.loggedIn}];return r.a.createElement(r.a.Fragment,null,r.a.createElement(Q,{links:a}),r.a.createElement("div",{className:"inner-content"},r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/user",render:function(){return r.a.createElement(we,null)}}),r.a.createElement(u.b,{exact:!0,path:"/user/settings",render:function(){return r.a.createElement(Oe,null)}}),r.a.createElement(u.b,{exact:!0,path:"/user/shop",render:function(){return r.a.createElement(je,null)}}),r.a.createElement(u.b,{exact:!0,path:"/user/:userId",render:function(){return r.a.createElement(we,null)}}),r.a.createElement(u.b,{render:function(){return r.a.createElement(u.a,{to:"/user"})}}))))}function Se(e){var t,a=e.small,o=e.large,c=e.id,s=e.name,i=e.hasImage,l=e.imageUrl,u=e.edit,m=e.onUpload,d=e.active,f=Object(n.useContext)(N),p={},h=["#fff59d","#ef9a9a","#9fa8da","#ce93d8","#a5d6a7","#f48fb1","#ffcc80","#90deea","#80cbc4"];if(t=a?"small":o?"large":"",i&&!l&&c)p.backgroundImage="url(/uploads/".concat(c,"_avatar.jpg?t=").concat(f.cacheVal,")");else if(i&&l)p.backgroundImage="url(".concat(l,")");else if(s){for(var v=0,g=0;g<s.length;g++)v^=s.charCodeAt(g);v^=s.charCodeAt(1),v^=v<<13,v^=v>>7,v^=v<<17,v=Math.abs(v)/Math.pow(2,31),p.backgroundColor=h[Math.floor(v*h.length)]}return r.a.createElement("div",{className:"avatar ".concat(t," ").concat(d?"active":""),style:p},u&&r.a.createElement(ge,{className:"edit",name:"avatar",onFileUpload:m},r.a.createElement("i",{className:"far fa-file-image"})))}function xe(e){var t=e.id,a=e.name||"[deleted]",o=e.avatar,c=!e.name||e.noLink,i=e.color,l=e.newTab,u=e.small,m=e.active,d=Object(n.useContext)(j);return r.a.createElement(s.b,{className:"name-with-avatar ".concat(c?"no-link":""),to:"/user/".concat(t),target:l?"_blank":"",onClick:function(e){d.setVisible(!1),c&&e.preventDefault()}},r.a.createElement(Se,{hasImage:o,id:t,name:a,small:u,active:m}),r.a.createElement("div",{className:"user-name",style:i?{color:i}:{}},a))}function Ce(e){return r.a.createElement("div",{className:"status-icon ".concat(e.status)})}function Ie(e){var t=Object(n.useState)([]),a=Object(i.a)(t,2),o=a[0],c=a[1],l=Object(n.useState)(!1),u=Object(i.a)(l,2),m=u[0],f=u[1],p=I();function h(e,t){return e.position-t.position}Object(n.useEffect)((function(){document.title="Categories | BeyondMafia",e.updateForumNavInfo({action:"home"}),d.a.get("/forums/categories").then((function(t){var a,n=t.data.sort(h),r=Object(T.a)(n);try{for(r.s();!(a=r.n()).done;){var o=a.value;o.boards=o.boards.sort(h)}}catch(s){r.e(s)}finally{r.f()}c(n),f(!0),e.updateForumNavInfo({type:"home"})})).catch(p)}),[]);var v=o.map((function(e){var t=e.boards.map((function(e){var t=e.newestThreads.map((function(e){return r.a.createElement("div",{className:"column-item",key:e.id},r.a.createElement("div",{className:"thread-link-wrapper"},r.a.createElement(s.b,{to:"/community/forums/thread/".concat(e.id)},e.title)),r.a.createElement(xe,{small:!0,id:e.author.id,name:e.author.name,avatar:e.author.avatar}),r.a.createElement("div",{className:"thread-counts"},r.a.createElement(Be,{viewCount:e.viewCount||0,replyCount:e.replyCount||0})))})),a=e.recentReplies.map((function(e){return r.a.createElement("div",{className:"column-item",key:e.id},r.a.createElement("div",{className:"thread-link-wrapper"},r.a.createElement(s.b,{to:"/community/forums/thread/".concat(e.thread.id,"?reply=").concat(e.id)},e.thread.title)),r.a.createElement(xe,{small:!0,id:e.author.id,name:e.author.name,avatar:e.author.avatar}),r.a.createElement("div",{className:"reply-age"},r.a.createElement(D,{millisec:Date.now()-e.postDate})," ago"))}));return r.a.createElement("div",{className:"board",key:e.id},r.a.createElement("i",{className:"fas fa-".concat(e.icon||"comments"," board-icon")}),r.a.createElement(s.b,{className:"board-info",to:"/community/forums/board/".concat(e.id)},r.a.createElement("div",{className:"board-name"},e.name),r.a.createElement("div",{className:"board-desc"},e.description)),r.a.createElement("div",{className:"forum-column tall"},r.a.createElement("div",{className:"column-title"},"Newest Thread"),r.a.createElement("div",{className:"column-content ".concat(0==t.length?"center-content":"")},0==t.length&&r.a.createElement("div",{className:"column-item center-item"},"No threads yet"),t)),r.a.createElement("div",{className:"forum-column tall three"},r.a.createElement("div",{className:"column-title"},"Recent Replies"),r.a.createElement("div",{className:"column-content ".concat(0==a.length?"center-content":"")},0==a.length&&r.a.createElement("div",{className:"column-item center-item"},"No replies yet"),a)))}));return r.a.createElement("div",{className:"span-panel forum-category",key:e.id},r.a.createElement("div",{className:"title"},e.name),r.a.createElement("div",{className:"boards"},t))}));return m?v:r.a.createElement(ne,null)}a(434);function Te(e){return r.a.createElement(r.a.Fragment,null,e.show&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"modal-bg",onClick:e.onBgClick}),r.a.createElement("div",{className:"modal ".concat(e.className?e.className:"")},r.a.createElement("div",{className:"modal-header"},e.header),r.a.createElement("div",{className:"modal-content"},e.content),r.a.createElement("div",{className:"modal-footer"},e.footer))))}function Le(e){var t=Object(n.useState)({}),a=Object(i.a)(t,2),o=a[0],c=a[1],l=Object(n.useState)(!1),m=Object(i.a)(l,2),f=m[0],p=m[1],h=Object(n.useState)(""),v=Object(i.a)(h,2),g=v[0],b=v[1],y=Object(n.useState)(""),E=Object(i.a)(y,2),w=E[0],N=E[1],j=Object(n.useState)(1),k=Object(i.a)(j,2),S=k[0],x=k[1],C=Object(n.useState)("bumpDate"),T=Object(i.a)(C,2),L=T[0],A=(T[1],Object(n.useState)(!1)),M=Object(i.a)(A,2),P=M[0],R=M[1],F=Object(n.useState)(),B=Object(i.a)(F,2),V=B[0],U=B[1],G=Object(u.i)().boardId,W=Object(n.useContext)(O),_=I();function $(e){var t;if(1==e)t="last=Infinity";else if(e<S&&o.threads.length)t="first=".concat(o.threads[0][L]);else{if(!(e>S&&o.threads.length))return;t="last=".concat(o.threads[o.threads.length-1][L])}console.log(e),d.a.get("/forums/board/".concat(G,"?sortType=").concat(L,"&").concat(t)).then((function(t){t.data.threads.length>0&&(c(t.data),x(e))})).catch(_)}function H(e){var t=e.recentReplies.map((function(t){return r.a.createElement("div",{className:"column-item",key:t.id},r.a.createElement(xe,{small:!0,id:t.author.id,name:t.author.name,avatar:t.author.avatar}),r.a.createElement(s.b,{className:"reply-age",to:"/community/forums/thread/".concat(e.id,"?reply=").concat(t.id)},r.a.createElement(D,{millisec:Date.now()-t.postDate})," ago"))}));return r.a.createElement("div",{className:"thread ".concat(e.deleted?"deleted":""),key:e.id},r.a.createElement(De,{item:e,itemType:"thread",itemHolder:o,setItemHolder:c,itemKey:"threads"}),r.a.createElement("div",{className:"thread-info"},r.a.createElement(s.b,{className:"thread-title",to:"/community/forums/thread/".concat(e.id)},e.locked&&r.a.createElement("i",{className:"fas fa-lock"}),e.pinned&&r.a.createElement("i",{className:"fas fa-thumbtack"}),e.title),r.a.createElement(xe,{small:!0,id:e.author.id,avatar:e.author.avatar,name:e.author.name}),r.a.createElement("div",{className:"counts"},r.a.createElement(Be,{viewCount:e.viewCount||0,replyCount:e.replyCount||0}))),r.a.createElement("div",{className:"forum-column"},r.a.createElement("div",{className:"column-title"},"Post Date"),r.a.createElement("div",{className:"column-content"},r.a.createElement("div",{className:"column-item center-item"},r.a.createElement(D,{millisec:Date.now()-e.postDate})," ago"))),r.a.createElement("div",{className:"forum-column three"},r.a.createElement("div",{className:"column-title"},"Recent Replies"),r.a.createElement("div",{className:"column-content ".concat(0==t.length?"center-content":"")},0==t.length&&r.a.createElement("div",{className:"column-item center-item"},"No replies yet"),t)))}if(Object(n.useEffect)((function(){document.title="Create Mafia Setup | BeyondMafia"}),[]),Object(n.useEffect)((function(){d.a.get("/forums/board/".concat(G)).then((function(t){c(t.data),R(!0),document.title="".concat(t.data.name," | BeyondMafia"),e.updateForumNavInfo({type:"board",id:G,name:t.data.name})})).catch((function(e){_(e),U("/community/forums")}))}),[G]),Object(n.useEffect)((function(){P&&e.updateForumNavInfo({action:"board",id:o.id,name:o.name})}),[P,o]),V)return r.a.createElement(u.a,{to:V});if(!P)return r.a.createElement(ne,null);var q=o.threads.map(H),Y=o.pinnedThreads.map(H);return r.a.createElement("div",{className:"board-wrapper"},r.a.createElement(Ae,{boardId:G,show:f,setShow:p,threadTitle:g,setThreadTitle:b,threadContent:w,setThreadContent:N,setRedirect:U}),r.a.createElement("div",{className:"board-info"},r.a.createElement("div",{className:"board-title-wrapper"},r.a.createElement("i",{className:"fas fa-".concat(o.icon||"comments"," board-icon")}),r.a.createElement("div",{className:"board-title"},o.name)),r.a.createElement("div",{className:"create-thread btn btn-theme",onClick:function(){p(!0)},disabled:!W.perms.createThread},r.a.createElement("i",{className:"fas fa-plus"}),"Create Thread")),Y.length>0&&r.a.createElement("div",{className:"threads pinned-threads span-panel"},Y),r.a.createElement(J,{page:S,onNav:$}),r.a.createElement("div",{className:"threads span-panel"},q.length>0&&q,0==q.length&&"No threads yet"),r.a.createElement(J,{page:S,onNav:$}))}function Ae(e){var t=I(),a=r.a.createElement("div",{className:"form"},r.a.createElement("div",{className:"field-wrapper thread-title"},r.a.createElement("div",{className:"label"},"Title"),r.a.createElement("input",{type:"text",value:e.threadTitle,onChange:function(t){e.setThreadTitle(t.target.value)}})),r.a.createElement(Ee,{value:e.threadContent,onChange:e.setThreadContent})),n=r.a.createElement("div",{className:"control"},r.a.createElement("div",{className:"post btn btn-theme",onClick:function(){d.a.post("/forums/thread",{board:e.boardId,title:e.threadTitle,content:e.threadContent}).then((function(t){e.setShow(!1),e.setRedirect("/community/forums/thread/".concat(t.data))})).catch(t)}},"Post"),r.a.createElement("div",{className:"cancel btn btn-theme-third",onClick:o},"Cancel"));function o(){e.setShow(!1)}return r.a.createElement(Te,{className:"create-thread",show:e.show,onBgClick:o,header:"Create Thread",content:a,footer:n})}function Me(e){var t=Object(n.useState)({}),a=Object(i.a)(t,2),o=a[0],c=a[1],s=Object(n.useState)(!1),l=Object(i.a)(s,2),m=l[0],f=l[1],h=Object(n.useState)(),v=Object(i.a)(h,2),g=v[0],b=v[1],y=Object(n.useState)(!1),E=Object(i.a)(y,2),w=E[0],N=E[1],j=Object(n.useState)(""),k=Object(i.a)(j,2),S=k[0],x=k[1],C=Object(n.useState)(1),L=Object(i.a)(C,2),A=L[0],M=L[1],P=Object(n.useState)(!1),R=Object(i.a)(P,2),F=R[0],D=R[1],B=Object(n.useRef)(),V=Object(u.i)().threadId,G=Object(u.h)(),W=Object(n.useContext)(O),_=I(),$=new URLSearchParams(G.search);function H(e){if(!o.locked||W.perms.postInLocked){if(N(!0),e){for(var t="".concat(S,"\n\n> ##### @").concat(e.author.name,":\n"),a=e.content.split("\n"),n=0;n<a.length;n++)a[n]="> ".concat(a[n]);t="".concat(t).concat(a.join("\n"),"\n\n"),x(t)}w&&B.current.scrollIntoView()}}function q(e){d.a.get("/forums/thread/".concat(V,"?page=").concat(e)).then((function(t){t.data.content=U(t.data.content,"\\*");var a,n=Object(T.a)(t.data.replies);try{for(n.s();!(a=n.n()).done;){var r=a.value;r.content=U(r.content,"\\*")}}catch(o){n.e(o)}finally{n.f()}M(e),c(t.data)})).catch(_)}if(Object(n.useEffect)((function(){document.title="Forums | BeyondMafia"}),[]),Object(n.useEffect)((function(){d.a.get("/forums/thread/".concat(V,"?reply=").concat($.get("reply")||"")).then((function(t){t.data.content=U(t.data.content,"\\*");var a,n=Object(T.a)(t.data.replies);try{for(n.s();!(a=n.n()).done;){var r=a.value;r.content=U(r.content,"\\*")}}catch(o){n.e(o)}finally{n.f()}c(t.data),M(t.data.page),f(!0),e.updateForumNavInfo({type:"thread",boardId:t.data.board.id,boardName:t.data.board.name,threadId:t.data.id,threadTitle:t.data.title})})).catch((function(e){_(e),b("/community/forums")}))}),[V]),Object(n.useEffect)((function(){if(m){if(e.updateForumNavInfo({action:"boardAndThread",boardId:o.board.id,boardName:o.board.name,threadId:o.id,threadTitle:o.title}),F||!$.get("reply"))return;var t=document.getElementById("reply-".concat($.get("reply")));D(!0),t&&t.scrollIntoView()}}),[m,o]),Object(n.useEffect)((function(){w&&B.current.scrollIntoView()}),[w]),g)return r.a.createElement(u.a,{to:g});if(!m)return r.a.createElement(ne,null);var Y=o.replies.map((function(e){return r.a.createElement(Pe,{className:"reply ".concat(e.id==$.get("reply")?"sel":""),id:"reply-".concat(e.id),key:e.id,postInfo:e,itemType:"reply",voteItem:e,voteItemHolder:o,setVoteItemHolder:c,itemKey:"replies",locked:o.locked,permaLink:"/community/forums/thread/".concat(V,"?reply=").concat(e.id),onReplyClick:function(){return H(e)},onDelete:function(){return q(A)},onRestore:function(){return q(A)},onEdit:function(){return q(A)}})}));return r.a.createElement("div",{className:"thread-wrapper"},r.a.createElement(Pe,{postInfo:o,itemType:"thread",voteItem:o,setVoteItemHolder:c,locked:o.locked,onReplyClick:function(){return H()},onDelete:function(){b("/community/forums/board/".concat(o.board.id))},onRestore:function(){return q(A)},onEdit:function(){return q(A)},onNotifyToggled:function(){c(p()(o,{replyNotify:{$set:!o.replyNotify}}))},onPinToggled:function(){c(p()(o,{pinned:{$set:!o.pinned}}))},onLockToggled:function(){c(p()(o,{locked:{$set:!o.locked}}))},hasTitle:!0}),r.a.createElement("div",{className:"reply-form-wrapper",ref:B},w&&r.a.createElement("div",{className:"reply-form span-panel"},r.a.createElement(Ee,{value:S,onChange:x}),r.a.createElement("div",{className:"post-btn-wrapper"},r.a.createElement("div",{className:"post-reply btn btn-theme",onClick:function(){d.a.post("/forums/reply",{thread:o.id,content:S}).then((function(e){q(Number(e.data)),x(""),N(!1),document.body.scrollTop=document.body.scrollHeight})).catch(_)}},"Post"),r.a.createElement("div",{className:"btn btn-theme-sec",onClick:function(){N(!1),x("")}},"Cancel")))),r.a.createElement("div",{className:"replies-wrapper"},r.a.createElement(J,{page:A,maxPage:o.pageCount,onNav:q}),r.a.createElement("div",{className:"replies"},0==Y.length&&"No replies yet",Y),r.a.createElement(J,{page:A,maxPage:o.pageCount,onNav:q})))}function Pe(e){var t=e.id,a=e.postInfo,o=e.itemType,c=e.voteItem,l=e.voteItemHolder,u=e.setVoteItemHolder,m=e.itemKey,f=e.hasTitle,p=e.permaLink,h=e.locked,g=e.onReplyClick,b=e.onDelete,y=e.onRestore,E=e.onEdit,w=e.onNotifyToggled,N=e.onPinToggled,j=e.onLockToggled,k=Object(n.useState)(!1),S=Object(i.a)(k,2),x=S[0],C=S[1],T=Object(n.useState)(a.content),L=Object(i.a)(T,2),A=L[0],M=L[1],P=Object(n.useContext)(O),R=I();var F=a.content;return a.deleted&&P.settings.hideDeleted&&(F="*deleted*"),r.a.createElement("div",{className:"post span-panel ".concat(a.deleted?"deleted":""," ").concat(e.className),id:t},r.a.createElement("div",{className:"vote-wrapper"},r.a.createElement(De,{item:c,itemType:o,itemHolder:l,setItemHolder:u,itemKey:m})),r.a.createElement("div",{className:"main-wrapper"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"heading-left"},f&&r.a.createElement("div",{className:"title"},h&&r.a.createElement("i",{className:"fas fa-lock"}),a.pinned&&r.a.createElement("i",{className:"fas fa-thumbtack"}),a.title),r.a.createElement("div",{className:"post-info"},r.a.createElement(xe,{id:a.author.id,name:a.author.name,avatar:a.author.avatar}),r.a.createElement("div",{className:"post-date"},r.a.createElement(D,{minSec:!0,millisec:Date.now()-a.postDate})," ago"))),r.a.createElement("div",{className:"btns-wrapper"},!a.deleted&&r.a.createElement(r.a.Fragment,null,"thread"==o&&P.perms.pinThreads&&r.a.createElement("i",{className:"fas fa-thumbtack ".concat(a.pinned?"fa-rotate-180":""),onClick:function(){d.a.post("/forums/thread/togglePinned",{thread:a.id}).then(N).catch(R)}}),"thread"==o&&P.perms.lockThreads&&r.a.createElement("i",{className:"fas fa-lock".concat(a.locked?"-open":""),onClick:function(){d.a.post("/forums/thread/toggleLocked",{thread:a.id}).then(j).catch(R)}}),(P.perms.deleteAnyPost||P.perms.deleteOwnPost&&a.author.id==P.id)&&r.a.createElement("i",{className:"fas fa-trash",onClick:function(){window.confirm("Are you sure you wish to delete this?")&&d.a.post("/forums/".concat(o,"/delete"),Object(v.a)({},o,a.id)).then(b).catch(R)}}),P.perms.editPost&&a.author.id==P.id&&(!h||P.perms.postInLocked)&&r.a.createElement("i",{className:"fas fa-pencil-alt",onClick:function(){C(!0)}}),"thread"==o&&a.author.id==P.id&&r.a.createElement("i",{className:"fa".concat(a.replyNotify?"s":"r"," fa-bell"),onClick:function(){d.a.post("/forums/thread/notify",{thread:a.id}).then(w).catch((function(){}))}}),p&&r.a.createElement(s.b,{to:p,onClick:function(){navigator.clipboard.writeText(window.location.origin+p)}},r.a.createElement("i",{className:"fas fa-link"})),P.perms.postReply&&(!h||P.perms.postInLocked)&&r.a.createElement("i",{className:"reply-btn fas fa-reply",onClick:g})),a.deleted&&P.perms.restoreDeleted&&r.a.createElement("i",{className:"fas fa-trash-restore",onClick:function(){d.a.post("/forums/".concat(o,"/restore"),Object(v.a)({},o,a.id)).then(y).catch(R)}}))),!x&&r.a.createElement("div",{className:"md-content"},r.a.createElement(ue.a,{source:F})),x&&r.a.createElement("div",{className:"edit-wrapper"},r.a.createElement(Ee,{value:A,onChange:M}),r.a.createElement("div",{className:"post-btn-wrapper"},r.a.createElement("div",{className:"post-reply btn btn-theme-third",onClick:function(){var e;d.a.post("/forums/".concat(o,"/edit"),(e={},Object(v.a)(e,o,a.id),Object(v.a)(e,"content",A),e)).then((function(){C(!1),E()})).catch(R)}},"Save"),r.a.createElement("div",{className:"btn btn-theme-sec",onClick:function(){C(!1)}},"Cancel")))))}a(154);function Re(){var e=Object(n.useReducer)((function(e,t){var a;switch(t.type){case"board":a={board:{id:t.id,name:t.name}};break;case"thread":a={board:{id:t.boardId,name:t.boardName},thread:{id:t.threadId,title:t.threadTitle}};break;case"home":a={}}return a||e}),{}),t=Object(i.a)(e,2),a=t[0],o=t[1];return r.a.createElement("div",{class:"forums"},r.a.createElement(Fe,{forumNavInfo:a}),r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/community/forums",render:function(){return r.a.createElement(Ie,{updateForumNavInfo:o})}}),r.a.createElement(u.b,{exact:!0,path:"/community/forums/board/:boardId",render:function(){return r.a.createElement(Le,{updateForumNavInfo:o})}}),r.a.createElement(u.b,{exact:!0,path:"/community/forums/thread/:threadId",render:function(){return r.a.createElement(Me,{updateForumNavInfo:o})}}),r.a.createElement(u.b,{render:function(){return r.a.createElement(u.a,{to:"/community/forums"})}})))}function Fe(e){var t=e.forumNavInfo;return r.a.createElement("div",{className:"span-panel"},r.a.createElement("div",{className:"forum-nav"},r.a.createElement("div",{className:"path"},r.a.createElement(s.c,{to:"/community/forums"},r.a.createElement("i",{className:"fas fa-home home"}),"Forums"),t.board&&r.a.createElement(s.c,{to:"/community/forums/board/".concat(t.board.id)},r.a.createElement("i",{className:"fas fa-chevron-right separator"}),t.board.name),t.thread&&r.a.createElement(s.c,{to:"/community/forums/thread/".concat(t.thread.id)},r.a.createElement("i",{className:"fas fa-chevron-right separator"}),t.thread.title))))}function De(e){var t=e.item,a=e.itemType,o=e.itemHolder,c=e.setItemHolder,s=e.itemKey,i=Object(n.useContext)(O),l=I();function u(e,n){i.perms.vote&&d.a.post("/forums/vote",{item:e,itemType:a,direction:n}).then((function(a){var r,i=Number(a.data),l=function(e,a){var n=t.voteCount;return 0==t.vote?n+=e:t.vote==e?n+=-1*e:n+=2*e,p()(t,{vote:{$set:a},voteCount:{$set:n}})}(n,i);if(null!=o){for(var u in r=s?o[s]:o)if(r[u].id==e){var m=r.slice();m[u]=l,c(s?p()(o,Object(v.a)({},s,{$set:m})):m);break}}else c(l)})).catch(l)}return r.a.createElement("div",{className:"vote-widget"},r.a.createElement("i",{className:"fas fa-arrow-up ".concat(1==t.vote&&"sel"),onClick:function(){return u(t.id,1)}}),t.voteCount||0,r.a.createElement("i",{className:"fas fa-arrow-down ".concat(-1==t.vote&&"sel"),onClick:function(){return u(t.id,-1)}}))}function Be(e){var t=e.viewCount,a=e.replyCount,n=1!=t,r=1!=a;return"".concat(t," view").concat(n?"s":"",", ").concat(a," repl").concat(r?"ies":"y")}a(435);function Ve(e){var t=e.location,a=Object(n.useState)(1),o=Object(i.a)(a,2),c=o[0],s=o[1],l=Object(n.useState)([]),u=Object(i.a)(l,2),m=u[0],f=u[1],p=Object(n.useState)(!1),h=Object(i.a)(p,2),v=h[0],g=h[1],b=Object(n.useState)(""),y=Object(i.a)(b,2),E=y[0],w=y[1],N=Object(n.useState)(!1),j=Object(i.a)(N,2),k=j[0],S=j[1],x=Object(n.useContext)(O),C=I();function T(e){var a;if(1==e)a="last=Infinity";else if(e<c&&m.length)a="first=".concat(m[0].date);else{if(!(e>c&&m.length))return;a="last=".concat(m[m.length-1].date)}d.a.get("/comment?location=".concat(t,"&").concat(a)).then((function(t){S(!0),t.data.length>0&&(f(t.data),s(e))})).catch(C)}Object(n.useEffect)((function(){f([]),T(1)}),[t]);var L=m.map((function(e){return r.a.createElement(Ue,{comment:e,comments:m,setComments:f,onDelete:function(){return T(c)},onRestore:function(){return T(c)},key:e.id})}));return k?r.a.createElement("div",{className:"comments-wrapper thread-wrapper"},r.a.createElement("div",{className:"comments-input-wrapper"},!v&&x.loggedIn&&x.perms.postReply&&r.a.createElement("div",{className:"btn btn-theme",onClick:function(){return g(!0)}},"Post Comment"),v&&r.a.createElement("div",{className:"reply-form span-panel"},r.a.createElement(Ee,{value:E,onChange:w}),r.a.createElement("div",{className:"post-btn-wrapper"},r.a.createElement("div",{className:"post-reply btn btn-theme",onClick:function(){d.a.post("/comment",{content:E,location:t}).then((function(){T(1),w(""),g(!1)})).catch(C)}},"Post"),r.a.createElement("div",{className:"btn btn-theme-sec",onClick:function(){g(!1)}},"Cancel")))),r.a.createElement("div",{className:"comments-page"},r.a.createElement(J,{page:c,onNav:T}),0==m.length&&"No comments yet",L,r.a.createElement(J,{page:c,onNav:T}))):r.a.createElement(ne,{className:"under"})}function Ue(e){var t=e.comment,a=e.comments,o=e.setComments,c=e.onDelete,s=e.onRestore,i=Object(n.useContext)(O),l=I();var u=t.content;return t.deleted&&i.settings.hideDeleted&&(u="*deleted*"),r.a.createElement("div",{className:"post ".concat(t.deleted?"deleted":""," ").concat(e.className||"")},r.a.createElement("div",{className:"vote-wrapper"},r.a.createElement(De,{item:t,itemHolder:a,setItemHolder:o,itemType:"comment"})),r.a.createElement("div",{className:"main-wrapper"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"heading-left"},r.a.createElement("div",{className:"post-info"},r.a.createElement(xe,{id:t.author.id,name:t.author.name,avatar:t.author.avatar}),r.a.createElement("div",{className:"post-date"},r.a.createElement(D,{minSec:!0,millisec:Date.now()-t.date})," ago"))),r.a.createElement("div",{className:"btns-wrapper"},!t.deleted&&(i.perms.deleteAnyPost||i.perms.deleteOwnPost&&t.author.id==i.id)&&r.a.createElement("i",{className:"fas fa-trash",onClick:function(){window.confirm("Are you sure you wish to delete this?")&&d.a.post("/comment/delete",{comment:t.id}).then(c).catch(l)}}),t.deleted&&i.perms.restoreDeleted&&r.a.createElement("i",{className:"fas fa-trash-restore",onClick:function(){d.a.post("/comment/restore",{comment:t.id}).then(s).catch(l)}}))),r.a.createElement("div",{className:"md-content"},r.a.createElement(ue.a,{source:u}))))}a(436);function Ge(e){var t=Object(n.useState)("All"),a=Object(i.a)(t,2),o=a[0],c=a[1],s=Object(n.useState)(1),l=Object(i.a)(s,2),m=l[0],f=l[1],p=Object(n.useState)(1),h=Object(i.a)(p,2),v=h[0],g=h[1],y=Object(n.useState)([]),E=Object(i.a)(y,2),w=E[0],N=E[1],j=Object(u.h)(),k=Object(u.g)(),S=Object(n.useContext)(O),x=I(),C=new URLSearchParams(j.search),T=Object(n.useState)(C.get("lobby")||localStorage.getItem("lobby")||"Main"),L=Object(i.a)(T,2),A=L[0],M=L[1];function P(e,t){d.a.get("/game/list?list=".concat(H(e),"&page=").concat(t,"&lobby=").concat(A)).then((function(a){c(e),f(t),N(a.data.games),g(a.data.pages)})).catch(x)}return Object(n.useEffect)((function(){localStorage.setItem("lobby",A),C.get("lobby")!=A&&k.push(j.pathname+"?lobby=".concat(A)),document.title="Play (".concat(A,") | BeyondMafia"),P(o,1),f(1)}),[j.pathname,A]),-1==b.indexOf(A)&&M("Main"),S.loaded?S.loaded&&!S.loggedIn?r.a.createElement(ie,null):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"span-panel main join"},r.a.createElement("div",{className:"left-panel"}),r.a.createElement("div",{className:"right-panel"},r.a.createElement("div",{className:"top-bar lobby-list"},r.a.createElement(st,{text:"Main",sel:A,onClick:function(){return M("Main")}}),r.a.createElement(st,{text:"Sandbox",sel:A,onClick:function(){return M("Sandbox")}}),r.a.createElement(st,{text:"Competitive",sel:A,onClick:function(){return M("Competitive")}}),r.a.createElement(st,{text:"Games",sel:A,onClick:function(){return M("Games")}})),r.a.createElement(R,{className:"games",items:w,map:function(e){return r.a.createElement(We,{game:e,lobby:A,refresh:function(){return P(o,m)},odd:w.indexOf(e)%2==1,key:e.id})},empty:"No games"}),r.a.createElement(J,{page:m,maxPage:v,onNav:function(e){return P(o,e)}}))),r.a.createElement(Ve,{location:"Main"==A?"lobby":"lobby-".concat(A)})):r.a.createElement(ne,null)}function We(e){var t,a,o=Object(n.useState)(!1),c=Object(i.a)(o,2),l=c[0],m=c[1],f=Object(n.useState)(e.game.reserved),p=Object(i.a)(f,2),v=p[0],g=p[1],b=Object(n.useRef)(),y=Object(n.useContext)(O),E=Object(n.useContext)(j),w=Object(n.useContext)(N),k=I();var S="btn ";switch(e.game.status){case"Open":t="/game/".concat(e.game.id),S+="btn-join",e.game.scheduled<=Date.now()&&(a="Join");break;case"In Progress":e.game.spectating||y.perms.canSpectateAny?(t="/game/".concat(e.game.id),S+="btn-spectate",a="Spectate"):(t="/play",S+="btn-in-progress",a="In Progress");break;case"Finished":t="/game/".concat(e.game.id,"/review"),S+="btn-review",a="Review"}function x(){var t={};for(var a in e.game.stateLengths)t[a]=e.game.stateLengths[a]/6e4;d.a.post("/game/host",Object(h.a)({gameType:e.game.type,setup:e.game.setup.id,lobby:e.lobby,guests:e.game.guests,private:!1,ranked:e.game.ranked,spectating:e.game.spectating,stateLengths:t},JSON.parse(e.game.gameTypeOptions))).then((function(e){return m("/game/".concat(e.data))})).catch(k)}return l?r.a.createElement(u.a,{to:l}):e.game.setup?r.a.createElement("div",{className:"row ".concat(e.odd?"odd":"")},r.a.createElement("div",{className:"btns-wrapper"},(y.loggedIn||"Finished"==e.type)&&!e.game.broken&&!e.game.private&&a&&r.a.createElement(s.b,{to:t,className:S,disabled:"In Progress"==e.type&&!e.game.spectating},a),y.loggedIn&&e.game.scheduled>Date.now()&&!v&&r.a.createElement("div",{className:"btn btn-theme",onClick:function(){d.a.post("/game/reserve",{gameId:e.game.id}).then((function(e){g(!v),w.showAlert(e.data,"success")})).catch(k)}},"Reserve"),y.loggedIn&&e.game.scheduled>Date.now()&&v&&r.a.createElement("div",{className:"btn btn-theme",onClick:function(){d.a.post("/game/unreserve",{gameId:e.game.id}).then((function(e){g(!v),w.showAlert(e.data,"success")})).catch(k)}},"Unreserve"),e.game.scheduled>Date.now()&&y.id==e.game.hostId&&r.a.createElement("div",{className:"btn btn-theme-sec",onClick:function(){d.a.post("/game/cancel",{gameId:e.game.id}).then((function(t){w.showAlert(t.data,"success"),e.refresh()})).catch(k)}},"Cancel"),e.game.broken&&r.a.createElement("i",{className:"fas fa-car-crash review-icon"}),e.game.private&&r.a.createElement("i",{className:"fas fa-lock review-icon"}),"Finished"==e.type&&y.loggedIn&&!e.smallSetup&&r.a.createElement("div",{className:"btn btn-rehost",onClick:x},"Rehost")),r.a.createElement("div",{className:"player-count-wrapper"},"Finished"!=e.type&&r.a.createElement(_e,{game:e.game}),"Finished"==e.type&&y.loggedIn&&!e.smallSetup&&r.a.createElement("div",{className:"btn btn-rehost",onClick:x},"Rehost")),r.a.createElement("div",{className:"setup-wrapper"},r.a.createElement(ut,{setup:e.game.setup,maxRolesCount:e.smallSetup?3:5})),!e.smallSetup&&r.a.createElement("div",{className:"setup-name"},e.game.setup.name),r.a.createElement("div",{className:"game-infos"},e.game.ranked&&r.a.createElement("i",{className:"ranked fas fa-chart-bar",title:"Ranked game"}),e.game.voiceChat&&r.a.createElement("i",{className:"voice-chat fas fa-microphone",title:"Voice chat game"}),r.a.createElement("i",{className:"game-info fas fa-info-circle",ref:b,onClick:function(t){t.stopPropagation(),E.onClick("/game/".concat(e.game.id,"/info"),"game",b.current,"Game ".concat(e.game.id))}}))):r.a.createElement(r.a.Fragment,null)}function _e(e){for(var t=e.game,a=[],n=0;n<t.setup.total;n++)a.push(r.a.createElement("div",{className:"player-circle ".concat(n<t.players?"filled":""),key:n}));return r.a.createElement("div",{className:"player-count"},a)}a(51);function $e(e){e.gameType;var t=e.selSetup,a=e.setSelSetup,o=e.formFields,c=e.updateFormFields,s=e.onHostGame,l=Object(n.useState)("featured"),m=Object(i.a)(l,2),f=m[0],p=m[1],h=Object(n.useState)(1),v=Object(i.a)(h,2),g=v[0],b=v[1],y=Object(n.useState)(1),E=Object(i.a)(y,2),w=E[0],N=E[1],j=Object(n.useState)(""),k=Object(i.a)(j,2),S=k[0],x=k[1],C=Object(n.useState)([]),T=Object(i.a)(C,2),L=T[0],A=T[1],M=Object(u.h)(),P=Object(u.g)(),F=I(),D=Object(n.useContext)(O);function B(t,a,n){d.a.get("/setup/".concat(H(t),"?gameType=").concat(e.gameType,"&page=").concat(a,"&query=").concat(n||"")).then((function(e){p(t),b(a),A(e.data.setups),N(e.data.pages)}))}function V(e){d.a.post("/setup/favorite",{id:e.id}).catch(F);var t=Object(X.a)(L);for(var a in L)if(L[a].id==e.id){t[a].favorite=!L[a].favorite;break}A(t)}function G(e){P.push("/play/create?edit=".concat(e.id))}function W(e){d.a.post("/setup/delete",{id:e.id}).then((function(){B(f,g)})).catch(F)}Object(n.useEffect)((function(){var e=new URLSearchParams(M.search);e.get("setup")?(B("id",1,e.get("setup")),d.a.get("/setup/".concat(e.get("setup"))).then((function(e){e.data.name=U(e.data.name),a(e.data)})).catch(F)):B(f,g)}),[]),Object(n.useEffect)((function(){c({ref:"setup",prop:"value",value:t.name})}),[t]);var _=["Featured","Popular","Favorites","Yours"].map((function(e){return r.a.createElement(st,{text:e,sel:f,onClick:function(){return function(e){x(""),B(e,1)}(e)},key:e})}));return r.a.createElement("div",{className:"span-panel main host"},r.a.createElement("div",{className:"top-bar"},_,r.a.createElement(K,{value:S,placeholder:"Setup Name",onInput:function(e){x(e),e.length?B("search",1,e):B("featured",1)}})),r.a.createElement(R,{items:L,map:function(e){return r.a.createElement(He,{setup:e,sel:t,listType:f,onSelect:a,onFav:V,onEdit:G,onDel:W,odd:L.indexOf(e)%2==1,key:e.id})},empty:"No setups"}),r.a.createElement(J,{page:g,maxPage:w,onNav:function(e){var t=[f,e];S.length&&t.append(S),B.apply(void 0,t)}}),D.loggedIn&&r.a.createElement(pe,{fields:o,onChange:c,submitText:"Host",onSubmit:s}))}function He(e){var t=Object(n.useContext)(O),a="far",o="far";return e.sel.id==e.setup.id&&(a="fas"),e.setup.favorite&&(o="fas"),r.a.createElement("div",{className:"row ".concat(e.odd?"odd":"")},t.loggedIn&&r.a.createElement("i",{className:"select-setup fa-circle ".concat(a),onClick:function(){return e.onSelect(e.setup)}}),r.a.createElement("div",{className:"setup-wrapper"},r.a.createElement(ut,{setup:e.setup})),r.a.createElement("div",{className:"setup-name"},e.setup.name),t.loggedIn&&r.a.createElement("i",{className:"setup-btn fav-setup fa-star ".concat(o),onClick:function(){return e.onFav(e.setup)}}),t.loggedIn&&"Yours"==e.listType&&r.a.createElement("i",{className:"setup-btn edit-setup fa-pen-square fas",onClick:function(){return e.onEdit(e.setup)}}),t.loggedIn&&"Yours"==e.listType&&r.a.createElement("i",{className:"setup-btn del-setup fa-times-circle fas",onClick:function(){return e.onDel(e.setup)}}))}function qe(){var e=Object(n.useState)({}),t=Object(i.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(!1),s=Object(i.a)(c,2),l=s[0],m=s[1],f=Object(n.useContext)(N),p=I(),h=be([{label:"Setup",ref:"setup",type:"text",disabled:!0},{label:"Lobby",ref:"lobby",type:"select",value:localStorage.getItem("lobby")||"Main",options:b.map((function(e){return{label:e,value:e}}))},{label:"Private",ref:"private",type:"boolean",showIf:"!ranked"},{label:"Allow Guests",ref:"guests",type:"boolean",showIf:"!ranked"},{label:"Ranked",ref:"ranked",type:"boolean",showIf:["!private","!spectating","!voiceChat","!guests"]},{label:"Spectating",ref:"spectating",type:"boolean",showIf:"!ranked"},{label:"Voice Chat",ref:"voiceChat",type:"boolean",showIf:"!ranked"},{label:"Scheduled",ref:"scheduled",type:"boolean"},{label:"Start Date",ref:"startDate",type:"datetime-local",showIf:"scheduled",value:Date.now()+36e4,min:Date.now()+36e4,max:Date.now()+24192e5},{label:"Day Length (minutes)",ref:"dayLength",type:"number",value:10,min:1,max:30},{label:"Night Length (minutes)",ref:"nightLength",type:"number",value:2,min:1,max:10}]),v=Object(i.a)(h,2),g=v[0],y=v[1];return Object(n.useEffect)((function(){document.title="Host Mafia | BeyondMafia"}),[]),l?r.a.createElement(u.a,{to:l}):r.a.createElement($e,{gameType:"Mafia",selSetup:a,setSelSetup:o,formFields:g,updateFormFields:y,onHostGame:function(){var e=g[7].value;a.id?d.a.post("/game/host",{gameType:"Mafia",setup:a.id,lobby:g[1].value,private:g[2].value,guests:g[3].value,ranked:g[4].value,spectating:g[5].value,voiceChat:g[6].value,scheduled:e&&new Date(g[8].value).getTime(),stateLengths:{Day:g[9].value,Night:g[10].value}}).then((function(t){e?(f.showAlert("Game scheduled.","success"),m("/")):m("/game/".concat(t.data))})).catch(p):p("You must choose a setup")}})}a(437);function Ye(e){var t,a=e.gameType,o=e.formFields,c=e.updateFormFields,s=e.closedField,l=e.resetFormFields,m=e.formFieldValueMods,f=e.onCreateSetup,p=I(),v=Object(n.useState)(0),g=Object(i.a)(v,2),b=g[0],y=g[1],E=Object(n.useState)(""),w=Object(i.a)(E,2),j=w[0],k=w[1],S=Object(n.useState)(!1),x=Object(i.a)(S,2),C=x[0],L=x[1],A=Object(n.useState)("None"),M=Object(i.a)(A,2),P=M[0],R=M[1],F=Object(u.h)(),D=new URLSearchParams(F.search),B=Object(n.useContext)(N),V=Object(n.useReducer)((function(e,t){var a=Object(h.a)({},e);if("reset"!=t.type&&"setClosed"!=t.type)for(var n in a.roles=e.roles.slice(),e.roles)a.roles[n]=Object(h.a)({},e.roles[n]);switch(t.type){case"reset":a.roles=[{}];break;case"setClosed":a.closed=t.closed,t.closed&&(a.roles=a.roles.slice(0,1));break;case"addRole":(r=a.roles[b])[t.role]||(r[t.role]=0),r[t.role]++;break;case"removeRole":var r;(r=a.roles[b])[t.role]&&r[t.role]--,r[t.role]<1&&delete r[t.role];break;case"addRoleSet":a.roles.push({});break;case"removeRoleSet":a.roles.splice(t.index,1),t.index==b&&y(0);break;case"setFromSetup":a.closed=t.closed,a.roles=t.roles}return a}),{roles:[{}],closed:!1}),U=Object(i.a)(V,2),G=U[0],W=U[1],_=Object(n.useContext)(O);Object(n.useEffect)((function(){W({type:"setClosed",closed:s.value})}),[s.value]),Object(n.useEffect)((function(){D.get("edit")&&d.a.get("/setup/".concat(D.get("edit"))).then((function(e){var t=e.data;L(!0),W({type:"setFromSetup",roles:JSON.parse(t.roles),closed:t.closed});var a,n=[],r=Object(T.a)(o);try{for(r.s();!(a=r.n()).done;){var s=a.value;if(t[s.ref]){var i=t[s.ref];if(m[s.ref]){var l,u=Object(T.a)(m[s.ref]);try{for(u.s();!(l=u.n()).done;){i=(0,l.value)(i)}}catch(f){u.e(f)}finally{u.f()}}n.push({ref:s.ref,prop:"value",value:i})}}}catch(f){r.e(f)}finally{r.f()}if(t.closed)for(var d in t.count)n.push({ref:"count-".concat(d),prop:"value",value:t.count[d]});c(n)})).catch(p)}),[]),C&&!D.get("edit")&&(L(!1),l(),W({type:"reset"})),t=G.roles.map((function(e,t){var n=[],o=function(t){n.push(r.a.createElement(it,{role:t,count:e[t],gameType:a,onClick:function(){W({type:"removeRole",role:t})},key:t}))};for(var c in e)o(c);return r.a.createElement(ze,{roles:n,index:t,sel:b,onClick:function(){return y(t)},onDelete:function(){W({type:"removeRoleSet",index:t})},key:t})}));var $=B.roles?B.roles.Modifiers[a]:[];return($=$.map((function(e){return r.a.createElement("option",{value:e,key:e},e)}))).unshift(r.a.createElement("option",{value:"None",key:"None"},"None")),D.get("edit")&&!C?r.a.createElement(ne,null):r.a.createElement("div",{className:"span-panel main create-setup"},r.a.createElement(lt,{onAddClick:function(e){W({type:"addRole",role:"".concat(e.name,":").concat("None"!=P?P:""),alignment:e.alignment})},gameType:a}),_.loggedIn&&r.a.createElement("div",{className:"creation-options"},r.a.createElement(pe,{fields:o,onChange:c,submitText:C?"Edit":"Create",onSubmit:function(){return f(G,C,k)}}),r.a.createElement("div",{className:"rolesets-wrapper"},r.a.createElement("div",{className:"form"},r.a.createElement("div",{className:"field-wrapper"},r.a.createElement("div",{className:"label"},"Role Modifier"),r.a.createElement("select",{value:P,onChange:function(e){var t=e.target.value;R(t)}},$))),r.a.createElement("div",{className:"rolesets"},t,!G.closed&&G.roles.length<10&&r.a.createElement("i",{className:"add-roleset fa-plus-circle fas",onClick:function(){return W({type:"addRoleSet"})}})))),j&&r.a.createElement(u.a,{to:"/play/host/?setup=".concat(j)}))}function ze(e){return r.a.createElement("div",{className:"roleset ".concat(e.sel==e.index?"sel":""),onClick:e.onClick},e.roles,e.index>0&&r.a.createElement("i",{className:"del-roleset fa-times-circle fas",onClick:e.onDelete}))}function Qe(){var e=Object(u.h)(),t=new URLSearchParams(e.search),a=I(),o=be([{label:"Setup Name",ref:"name",type:"text"},{label:"Day Start",ref:"startState",type:"boolean"},{label:"Dawn",ref:"dawn",type:"boolean"},{label:"Whispers",ref:"whispers",type:"boolean"},{label:"Whisper Leak Percentage",ref:"leakPercentage",type:"number",value:"5",min:"0",max:"100",showIf:"whispers"},{label:"Last Wills",ref:"lastWill",type:"boolean"},{label:"Must Act",ref:"mustAct",type:"boolean"},{label:"No Reveal",ref:"noReveal",type:"boolean"},{label:"Votes Invisible",ref:"votesInvisible",type:"boolean"},{label:"Closed Roles",ref:"closed",type:"boolean"},{label:"Unique Roles",ref:"unique",type:"boolean",showIf:"closed"},{label:"Village Count",ref:"count-Village",type:"number",value:"7",min:"0",max:"50",showIf:"closed"},{label:"Mafia Count",ref:"count-Mafia",type:"number",value:"3",min:"0",max:"50",showIf:"closed"},{label:"Monsters Count",ref:"count-Monsters",type:"number",value:"0",min:"0",max:"50",showIf:"closed"},{label:"Independent Count",ref:"count-Independent",type:"number",value:"2",min:"0",max:"50",showIf:"closed"}]),c=Object(i.a)(o,3),s=c[0],l=c[1],m=c[2],f=Object(n.useContext)(N);return Object(n.useEffect)((function(){document.title="Create Mafia Setup | BeyondMafia"}),[]),r.a.createElement(Ye,{gameType:"Mafia",formFields:s,updateFormFields:l,resetFormFields:m,closedField:s[9],formFieldValueMods:{startState:[function(e){return"Day"==e}]},onCreateSetup:function(e,n,r){d.a.post("/setup/create",{gameType:"Mafia",roles:e.roles,closed:e.closed,name:s[0].value,startState:s[1].value?"Day":"Night",dawn:s[2].value,whispers:s[3].value,leakPercentage:Number(s[4].value),lastWill:s[5].value,mustAct:s[6].value,noReveal:s[7].value,votesInvisible:s[8].value,unique:s[10].value,count:{Village:Number(s[11].value),Mafia:Number(s[12].value),Monsters:Number(s[13].value),Independent:Number(s[14].value)},editing:n,id:t.get("edit")}).then((function(e){f.showAlert("".concat(n?"Edited":"Created"," setup '").concat(s[0].value,"'"),"success"),r(e.data)})).catch(a)}})}a(66);function Je(e){var t=[{name:"Armed",text:"Starts with a gun.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Armed"})},{name:"Explosive",text:"Starts with a bomb.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Explosive"})},{name:"Armored",text:"Starts with armor.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Armored"})},{name:"Exposed",text:"Starts revealed to everyone.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Exposed"})},{name:"Lizard",text:"Appears as a Villager to investigative roles.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Lizard"})},{name:"Humble",text:"Appears as Villager to self with no modifier.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Humble"})},{name:"Lone",text:"Does not attend the Mafia or Monsters meeting.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Lone"})},{name:"Delayed",text:"Cannot attend secondary meetings for the first day and night.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Delayed"})},{name:"Even",text:"Can only attend secondary meetings on even days and nights.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Even"})},{name:"Odd",text:"Can only attend secondary meetings on odd days and nights.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Odd"})},{name:"One Shot",text:"Can only perform actions once.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-One-Shot"})}];return Object(n.useEffect)((function(){document.title="Learn Mafia | BeyondMafia"}),[]),r.a.createElement("div",{className:"span-panel main"},r.a.createElement("div",{className:"learn"},r.a.createElement("div",{className:"heading"},"Synopsis"),r.a.createElement("div",{className:"paragraphs"},r.a.createElement("div",{className:"paragraph"},"Mafia is a game of social deception where an informed minority (the Mafia) compete against the uniformed majority (the Village). The Mafia choose one player to kill each night, and they win the game if they successfully outnumber the non-mafia players at any point. Everyone votes to execute one person during the day, with the Village aiming to eliminate all mafia members."),r.a.createElement("div",{className:"paragraph"},"In addition to the Village and the Mafia, there are two other alignments: Independent and Monsters. Independents are not aligned with a side and usually have their own unique win condition. Monsters meet together and win if they reach the majority just like the mafia, but they do not vote to kill someone each night."),r.a.createElement("div",{className:"paragraph"},"At the beginning of a game, each player is given a role. This role may grant the player special abilities, usually in the form of actions they can take to aid their side. A list of all roles and their abilities can be found below.")),r.a.createElement("div",{className:"heading"},"Roles"),r.a.createElement(lt,{gameType:"Mafia"}),r.a.createElement("div",{className:"heading"},"Items"),r.a.createElement(F,{panels:[{name:"Gun",text:"Can be shot once during the day to kill a specific player."},{name:"Armor",text:"Saves a player from being killed one time, not including being executed."},{name:"Bomb",text:"When a player is killed while holding a bomb, the player who killed them will also die."}]}),r.a.createElement("div",{className:"heading"},"Mechanics"),r.a.createElement(F,{panels:[{name:"Whispers",text:"Allow players to privately contact another player in the town meeting. If the whisper leaks then everyone will see it."},{name:"Last Wills",text:"Allow players to write a message that will be revealed when they die."},{name:"Must Act",text:"Players cannot select 'no one' for their actions."},{name:"No Reveal",text:"The roles of dead players are not revealed."},{name:"Closed Roles",text:"Roles for each alignment are randomly chosen from the pool of roles in the setup."},{name:"Dawn",text:"No actions can be taken the first night."},{name:"Full Moon",text:"When a Lycan or Werewolf is present in the game, full moons will occur on odd nights."},{name:"Eclipse",text:"Occurs during the day due to certain roles, making all votes and speech anonymous."}]}),r.a.createElement("div",{className:"heading"},"Modifiers"),r.a.createElement(F,{panels:t})))}function Ke(){var e=Object(n.useState)({}),t=Object(i.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(!1),s=Object(i.a)(c,2),l=s[0],m=s[1],f=Object(n.useContext)(N),p=I(),h=be([{label:"Setup",ref:"setup",type:"text",disabled:!0},{label:"Lobby",ref:"lobby",type:"select",value:localStorage.getItem("lobby")||"Main",options:b.map((function(e){return{label:e,value:e}}))},{label:"Private",ref:"private",type:"boolean"},{label:"Allow Guests",ref:"guests",type:"boolean"},{label:"Spectating",ref:"spectating",type:"boolean"},{label:"Voice Chat",ref:"voiceChat",type:"boolean"},{label:"Scheduled",ref:"scheduled",type:"boolean"},{label:"Start Date",ref:"startDate",type:"datetime-local",showIf:"scheduled",value:Date.now()+36e4,min:Date.now()+36e4,max:Date.now()+24192e5},{label:"Initial Round Length (minutes)",ref:"initRoundLength",type:"number",value:3,min:1,max:5},{label:"Hostage Swap Length (minutes)",ref:"hostageSwapLength",type:"number",value:.5,min:.1,max:1,step:.1}]),v=Object(i.a)(h,2),g=v[0],y=v[1];return Object(n.useEffect)((function(){document.title="Host Split Decision | BeyondMafia"}),[]),l?r.a.createElement(u.a,{to:l}):r.a.createElement($e,{gameType:"Split Decision",selSetup:a,setSelSetup:o,formFields:g,updateFormFields:y,onHostGame:function(){var e=g[6].value;a.id?d.a.post("/game/host",{gameType:"Split Decision",setup:a.id,lobby:g[1].value,private:g[2].value,guests:g[3].value,spectating:g[4].value,voiceChat:g[5].value,scheduled:e&&new Date(g[7].value).getTime(),stateLengths:{"Initial Round":g[8].value,"Hostage Swap":g[9].value}}).then((function(t){e?(f.showAlert("Game scheduled.","success"),m("/")):m("/game/".concat(t.data))})).catch(p):p("You must choose a setup")}})}function Xe(){var e=Object(u.h)(),t=new URLSearchParams(e.search),a=I(),o=be([{label:"Setup Name",ref:"name",type:"text"},{label:"Initial Swap Amount",ref:"swapAmt",type:"number",value:"1",min:"1",max:"24"},{label:"Round Amount",ref:"aroundAmt",type:"number",value:3,min:2,max:10},{label:"Whispers",ref:"whispers",type:"boolean"},{label:"Whisper Leak Percentage",ref:"leakPercentage",type:"number",value:"5",min:"0",max:"100",showIf:"whispers"},{label:"Closed Roles",ref:"closed",type:"boolean"},{label:"Unique Roles",ref:"unique",type:"boolean",showIf:"closed"},{label:"Blue Count",ref:"count-Blue",type:"number",value:"4",min:"1",max:"50",showIf:"closed"},{label:"Red Count",ref:"count-Red",type:"number",value:"4",min:"1",max:"50",showIf:"closed"},{label:"Independent Count",ref:"count-Independent",type:"number",value:"1",min:"0",max:"50",showIf:"closed"}]),c=Object(i.a)(o,3),s=c[0],l=c[1],m=c[2],f=Object(n.useContext)(N);return Object(n.useEffect)((function(){document.title="Create Split Decision Setup | BeyondMafia"}),[]),r.a.createElement(Ye,{gameType:"Split Decision",formFields:s,updateFormFields:l,resetFormFields:m,closedField:s[5],formFieldValueMods:{},onCreateSetup:function(e,n,r){d.a.post("/setup/create",{gameType:"Split Decision",roles:e.roles,closed:e.closed,name:s[0].value,startState:"Round",swapAmt:Number(s[1].value),roundAmt:Number(s[2].value),whispers:s[3].value,leakPercentage:Number(s[4].value),unique:s[6].value,count:{Red:Number(s[7].value),Blue:Number(s[8].value),Independent:Number(s[9].value)},editing:n,id:t.get("edit")}).then((function(e){f.showAlert("".concat(n?"Edited":"Created"," setup '").concat(s[0].value,"'"),"success"),r(e.data)})).catch(a)}})}function Ze(e){return Object(n.useEffect)((function(){document.title="Learn Split Decision | BeyondMafia"}),[]),r.a.createElement("div",{className:"span-panel main"},r.a.createElement("div",{className:"learn"},r.a.createElement("div",{className:"heading"},"Synopsis"),r.a.createElement("div",{className:"paragraphs"},r.a.createElement("div",{className:"paragraph"},"Based on the card game ",r.a.createElement("a",{href:"https://www.tuesdayknightgames.com/tworoomsandaboom",target:"_blank"},"2 Rooms and a Boom")," by Tudesday Knight Games."),r.a.createElement("div",{className:"paragraph"},"In Split Decision, all players are randomly a split among two rooms, as well as split among two teams: Red and Blue. One player is assigned the role of President, and another is the Bomber. The game plays over a series of rounds, and in each round each room will elect a leader. Those leaders will then meet together and choose one or more players (the hostages) to swap between the rooms for the next round."),r.a.createElement("div",{className:"paragraph"},"As the game progresses the rounds will get shorter and the number of players swapped between rooms will decrease. It is the goal of the Red team for the President and the Bomber to end up in the same room after the last round. It is the goal of the Blue team for them to end up in different rooms.")),r.a.createElement("div",{className:"heading"},"Roles"),r.a.createElement(lt,{gameType:"Split Decision"})))}function et(){var e=Object(n.useState)({}),t=Object(i.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(!1),s=Object(i.a)(c,2),l=s[0],m=s[1],f=Object(n.useContext)(N),p=I(),h=be([{label:"Setup",ref:"setup",type:"text",disabled:!0},{label:"Lobby",ref:"lobby",type:"select",value:localStorage.getItem("lobby")||"Main",options:b.map((function(e){return{label:e,value:e}}))},{label:"Private",ref:"private",type:"boolean"},{label:"Allow Guests",ref:"guests",type:"boolean"},{label:"Spectating",ref:"spectating",type:"boolean"},{label:"Voice Chat",ref:"voiceChat",type:"boolean"},{label:"Scheduled",ref:"scheduled",type:"boolean"},{label:"Start Date",ref:"startDate",type:"datetime-local",showIf:"scheduled",value:Date.now()+36e4,min:Date.now()+36e4,max:Date.now()+24192e5},{label:"Team Selection Length (minutes)",ref:"teamSelLength",type:"number",value:2,min:1,max:5},{label:"Team Approval Length (minutes)",ref:"teamApprovalLength",type:"number",value:.5,min:.1,max:2,step:.1},{label:"Mission Length (minutes)",ref:"missionLength",type:"number",value:.5,min:.1,max:1,step:.1}]),v=Object(i.a)(h,2),g=v[0],y=v[1];return Object(n.useEffect)((function(){document.title="Host Resistance | BeyondMafia"}),[]),l?r.a.createElement(u.a,{to:l}):r.a.createElement($e,{gameType:"Resistance",selSetup:a,setSelSetup:o,formFields:g,updateFormFields:y,onHostGame:function(){var e=g[6].value;a.id?d.a.post("/game/host",{gameType:"Resistance",setup:a.id,lobby:g[1].value,private:g[2].value,guests:g[3].value,spectating:g[4].value,voiceChat:g[5].value,scheduled:e&&new Date(g[7].value).getTime(),stateLengths:{"Team Selection":g[8].value,"Team Approval":g[9].value,Mission:g[10].value}}).then((function(t){e?(f.showAlert("Game scheduled.","success"),m("/")):m("/game/".concat(t.data))})).catch(p):p("You must choose a setup")}})}function tt(){var e=Object(u.h)(),t=new URLSearchParams(e.search),a=I(),o=be([{label:"Setup Name",ref:"name",type:"text"},{label:"First Team Size",ref:"firstTeamSize",type:"number",value:"2",min:"2",max:"49"},{label:"Last Team Size",ref:"lastTeamSize",type:"number",value:"4",min:"2",max:"49"},{label:"Number of Missions",ref:"numMissions",type:"number",value:"5",min:"2",max:"10"},{label:"Team Formation Attempts",ref:"teamFailLimit",type:"number",value:"5",min:"1",max:"49"},{label:"Whispers",ref:"whispers",type:"boolean"},{label:"Whisper Leak Percentage",ref:"leakPercentage",type:"number",value:"5",min:"0",max:"100",showIf:"whispers"},{label:"Closed Roles",ref:"closed",type:"boolean"},{label:"Unique Roles",ref:"unique",type:"boolean",showIf:"closed"},{label:"Resistance Count",ref:"count-Resistance",type:"number",value:"3",min:"2",max:"49",showIf:"closed"},{label:"Spies Count",ref:"count-Spies",type:"number",value:"2",min:"1",max:"49",showIf:"closed"}]),c=Object(i.a)(o,3),s=c[0],l=c[1],m=c[2],f=Object(n.useContext)(N);return Object(n.useEffect)((function(){document.title="Create Resistance Setup | BeyondMafia"}),[]),r.a.createElement(Ye,{gameType:"Resistance",formFields:s,updateFormFields:l,resetFormFields:m,closedField:s[7],formFieldValueMods:{},onCreateSetup:function(e,n,r){d.a.post("/setup/create",{gameType:"Resistance",roles:e.roles,closed:e.closed,name:s[0].value,startState:"Team Selection",firstTeamSize:Number(s[1].value),lastTeamSize:Number(s[2].value),numMissions:Number(s[3].value),teamFailLimit:Number(s[4].value),whispers:s[5].value,leakPercentage:Number(s[6].value),unique:s[8].value,count:{Resistance:Number(s[9].value),Spies:Number(s[10].value)},editing:n,id:t.get("edit")}).then((function(e){f.showAlert("".concat(n?"Edited":"Created"," setup '").concat(s[0].value,"'"),"success"),r(e.data)})).catch(a)}})}function at(e){return Object(n.useEffect)((function(){document.title="Learn Resistance | BeyondMafia"}),[]),r.a.createElement("div",{className:"span-panel main"},r.a.createElement("div",{className:"learn"},r.a.createElement("div",{className:"heading"},"Synopsis"),r.a.createElement("div",{className:"paragraphs"},r.a.createElement("div",{className:"paragraph"},"Based on the card game ",r.a.createElement("a",{href:"https://www.boardgamegeek.com/boardgame/41114/resistance",target:"_blank"},"The Resistance")," by Don Eskridge."),r.a.createElement("div",{className:"paragraph"},"In Resistance, a group of rebels is trying to overthrow the government by completing a series of missions. However, the government has caught word of the plan and has recruited spies to inflitrate the resistance and sabotage the missions."),r.a.createElement("div",{className:"paragraph"},"At the beginning of each mission a player is selected as the leader and must recruit several group members to the team. All players vote on the selected team and if the majority approve then the mission will proceed. Otherwise, a new leader is chosen to make a new team. If several leaders are unable to form a team then that mission automatically fails."),r.a.createElement("div",{className:"paragraph"},"During a mission the members of the teams who are spies can choose to either make the mission succeed or fail. If at least one team member opts for it to fail then the entire mission will fail, otherwise it will succeed. The game continues until a certain number of missions succeed or fail, with the Resistance and the Spies winning respectively.")),r.a.createElement("div",{className:"heading"},"Roles"),r.a.createElement(lt,{gameType:"Resistance"})))}function nt(){var e=Object(n.useState)({}),t=Object(i.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(!1),s=Object(i.a)(c,2),l=s[0],m=s[1],f=Object(n.useContext)(N),p=I(),h=be([{label:"Setup",ref:"setup",type:"text",disabled:!0},{label:"Lobby",ref:"lobby",type:"select",value:localStorage.getItem("lobby")||"Main",options:b.map((function(e){return{label:e,value:e}}))},{label:"Private",ref:"private",type:"boolean"},{label:"Allow Guests",ref:"guests",type:"boolean"},{label:"Spectating",ref:"spectating",type:"boolean"},{label:"Voice Chat",ref:"voiceChat",type:"boolean"},{label:"Scheduled",ref:"scheduled",type:"boolean"},{label:"Start Date",ref:"startDate",type:"datetime-local",showIf:"scheduled",value:Date.now()+36e4,min:Date.now()+36e4,max:Date.now()+24192e5},{label:"Day Length (minutes)",ref:"dayLength",type:"number",value:10,min:1,max:30},{label:"Night Length (minutes)",ref:"nightLength",type:"number",value:2,min:1,max:10}]),v=Object(i.a)(h,2),g=v[0],y=v[1];return Object(n.useEffect)((function(){document.title="Host One Night | BeyondMafia"}),[]),l?r.a.createElement(u.a,{to:l}):r.a.createElement($e,{gameType:"One Night",selSetup:a,setSelSetup:o,formFields:g,updateFormFields:y,onHostGame:function(){var e=g[6].value;a.id?d.a.post("/game/host",{gameType:"One Night",setup:a.id,lobby:g[1].value,private:g[2].value,guests:g[3].guests,spectating:g[4].value,voiceChat:g[5].value,scheduled:e&&new Date(g[7].value).getTime(),stateLengths:{Day:g[8].value,Night:g[9].value}}).then((function(t){e?(f.showAlert("Game scheduled.","success"),m("/")):m("/game/".concat(t.data))})).catch(p):p("You must choose a setup")}})}function rt(){var e=Object(u.h)(),t=new URLSearchParams(e.search),a=I(),o=be([{label:"Setup Name",ref:"name",type:"text"},{label:"Whispers",ref:"whispers",type:"boolean"},{label:"Whisper Leak Percentage",ref:"leakPercentage",type:"number",value:"5",min:"0",max:"100",showIf:"whispers"},{label:"Must Act",ref:"mustAct",type:"boolean"},{label:"Votes Invisible",ref:"votesInvisible",type:"boolean"},{label:"Excess Roles",ref:"excessRoles",type:"number",value:"3",min:"2",max:"10"},{label:"Closed Roles",ref:"closed",type:"boolean"},{label:"Unique Roles",ref:"unique",type:"boolean",showIf:"closed"},{label:"Village Count",ref:"count-Village",type:"number",value:"7",min:"0",max:"50",showIf:"closed"},{label:"Werewolves Count",ref:"count-Werewolves",type:"number",value:"0",min:"0",max:"50",showIf:"closed"},{label:"Independent Count",ref:"count-Independent",type:"number",value:"2",min:"0",max:"50",showIf:"closed"}]),c=Object(i.a)(o,3),s=c[0],l=c[1],m=c[2],f=Object(n.useContext)(N);return Object(n.useEffect)((function(){document.title="Create One Night Setup | BeyondMafia"}),[]),r.a.createElement(Ye,{gameType:"One Night",formFields:s,updateFormFields:l,resetFormFields:m,closedField:s[6],formFieldValueMods:{startState:[function(e){return"Day"==e}]},onCreateSetup:function(e,n,r){d.a.post("/setup/create",{gameType:"One Night",roles:e.roles,closed:e.closed,name:s[0].value,whispers:s[1].value,leakPercentage:Number(s[2].value),mustAct:s[3].value,votesInvisible:s[4].value,excessRoles:s[5].value,unique:s[7].value,count:{Village:Number(s[8].value),Werewolves:Number(s[9].value),Independent:Number(s[10].value)},editing:n,id:t.get("edit")}).then((function(e){f.showAlert("".concat(n?"Edited":"Created"," setup '").concat(s[0].value,"'"),"success"),r(e.data)})).catch(a)}})}function ot(e){return Object(n.useEffect)((function(){document.title="Learn One Night | BeyondMafia"}),[]),r.a.createElement("div",{className:"span-panel main"},r.a.createElement("div",{className:"learn"},r.a.createElement("div",{className:"heading"},"Synopsis"),r.a.createElement("div",{className:"paragraphs"},r.a.createElement("div",{className:"paragraph"},"Based on ",r.a.createElement("a",{href:"https://beziergames.com/collections/one-night-ultimate-werewolf",target:"_blank"},"One Night Ultimate Werewolf")," by Bezier Games."),r.a.createElement("div",{className:"paragraph"},"One Night is a game of logical deduction similar to Mafia, but with only one Night and one Day phase."),r.a.createElement("div",{className:"paragraph"},"The Village side must kill one of the Werewolves to win, and Werewolves must kill one of the village. The one night is typically eventful; the role you are given at the beginning of the night may not be the card you end up with. Actions will all take place at once at the end of the night. The order of events is given by times in the role descriptions.")),r.a.createElement("div",{className:"heading"},"Roles"),r.a.createElement(lt,{gameType:"One Night"})))}a(438);function ct(e){var t=Object(n.useContext)(O),a=Object(u.h)(),o=Object(u.g)(),c=new URLSearchParams(a.search),s="/play"==a.pathname,l=Object(n.useState)(c.get("game")||localStorage.getItem("gameType")||"Mafia"),m=Object(i.a)(l,2),d=m[0],f=m[1],p=[{text:"Play",path:"/play",exact:!0},{text:"Host",path:"/play/host",hide:!t.loggedIn},{text:"Create Setup",path:"/play/create",hide:!t.loggedIn},{text:"Learn",path:"/play/learn"}];return Object(n.useEffect)((function(){localStorage.setItem("gameType",d),s||c.get("edit")||c.get("game")==d||o.push(a.pathname+"?game=".concat(d))}),[a.pathname,d]),r.a.createElement(r.a.Fragment,null,r.a.createElement(Q,{links:p,showFilter:!s,filterSel:d,filterOptions:g,onFilter:function(e){f(e)},filterIcon:r.a.createElement("i",{className:"fas fa-gamepad"})}),r.a.createElement("div",{className:"inner-content play"},r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/play",render:function(){return r.a.createElement(Ge,null)}}),r.a.createElement(u.b,{exact:!0,path:"/play/host",render:function(){switch(d){case"Mafia":return r.a.createElement(qe,null);case"Split Decision":return r.a.createElement(Ke,null);case"Resistance":return r.a.createElement(et,null);case"One Night":return r.a.createElement(nt,null);default:return f("Mafia"),r.a.createElement(r.a.Fragment,null)}}}),r.a.createElement(u.b,{exact:!0,path:"/play/create",render:function(){switch(d){case"Mafia":return r.a.createElement(Qe,null);case"Split Decision":return r.a.createElement(Xe,null);case"Resistance":return r.a.createElement(tt,null);case"One Night":return r.a.createElement(rt,null);default:return f("Mafia"),r.a.createElement(r.a.Fragment,null)}}}),r.a.createElement(u.b,{exact:!0,path:"/play/learn",render:function(){switch(d){case"Mafia":return r.a.createElement(Je,null);case"Split Decision":return r.a.createElement(Ze,null);case"Resistance":return r.a.createElement(at,null);case"One Night":return r.a.createElement(ot,null);default:return f("Mafia"),r.a.createElement(r.a.Fragment,null)}}}),r.a.createElement(u.b,{render:function(){return r.a.createElement(u.a,{to:"/play"})}}))))}function st(e){var t=e.sel.toLowerCase()==e.text.toLowerCase();return r.a.createElement("div",{className:"top-link ".concat(t?"active":""),onClick:e.onClick},e.text)}function it(e){var t,a,o=Object(n.useRef)(),c=Object(n.useContext)(j);if("string"==typeof e.role?(t=e.role.split(":")[0],a=e.role.split(":")[1]):e.role&&(t=e.role.name,a=e.role.modifier),e.closed)return e.count>0||e.hideCount?r.a.createElement("div",{className:"role-count-wrap"},r.a.createElement("i",{className:"fas fa-question i-".concat(e.alignment),onClick:e.onClick}),!e.hideCount&&r.a.createElement("div",{className:"super"},e.count)):r.a.createElement(r.a.Fragment,null);var s=t?"".concat($(e.gameType),"-").concat($(t)):"null";return r.a.createElement("div",{className:"role-count-wrap"},r.a.createElement("div",{className:"role role-".concat(s," ").concat(e.small?"small":""," ").concat(e.bg?"bg":""),title:"".concat(t||""," ").concat(a?"(".concat(a,")"):""),onClick:function(){e.onClick&&e.onClick(),t&&e.showPopover&&c.onClick("/roles/".concat(e.gameType,"/").concat(t),"role",o.current,t)},ref:o},a&&r.a.createElement("div",{className:"modifier modifier-".concat(e.gameType,"-").concat($(a))})),e.count>0&&r.a.createElement("div",{className:"super"},e.count))}function lt(e){var t=Object(n.useState)(y[e.gameType][0]),a=Object(i.a)(t,2),o=a[0],c=a[1],s=Object(n.useState)(""),l=Object(i.a)(s,2),u=l[0],m=l[1],d=Object(n.useRef)([]),f=(I(),Object(n.useContext)(O)),p=Object(n.useContext)(N),h=Object(n.useContext)(j);var v=y[e.gameType].map((function(e){return r.a.createElement(st,{text:e,sel:o,onClick:function(){return t=e,m(""),void c(t);var t},key:e})}));if(!p.roles)return r.a.createElement(ne,{className:"roles-loading"});var g=p.roles[e.gameType].map((function(t,a){if(t.alignment==o||u.length>0&&-1!=t.name.toLowerCase().indexOf(u))return r.a.createElement("div",{className:"role-cell",key:t.name},f.loggedIn&&e.onAddClick&&r.a.createElement("i",{className:"add-role fa-plus-circle fas",onClick:function(a){a.stopPropagation(),e.onAddClick(t)}}),r.a.createElement("div",{className:"role-cell-content",onClick:function(){return function(t,a){h.onClick("/roles/".concat(e.gameType,"/").concat(a.name),"role",t,a.name)}(d.current[a],t)},ref:function(e){return d.current[a]=e}},r.a.createElement(it,{role:t.name,gameType:e.gameType}),t.name))}));return r.a.createElement("div",{className:"role-list-container"},r.a.createElement("div",{className:"top-bar"},v,r.a.createElement(K,{value:u,placeholder:"Role Name",onInput:function(t){m(t.toLowerCase()),""!=t&&o.length>0?c(""):""==t&&0==o.length&&c(y[e.gameType][0])}})),r.a.createElement("div",{className:"role-list"},g))}a(439),a(440);function ut(e){var t,a,o=Object(n.useContext)(j),c=Object(n.useRef)(),s=e.maxRolesCount||5,i=!1;if("string"==typeof e.setup.roles&&(e.setup.roles=JSON.parse(e.setup.roles)),e.setup.closed){t=[];var l,u=Object(T.a)(y[e.setup.gameType]);try{for(u.s();!(l=u.n()).done;){var m=l.value;t.push(r.a.createElement(it,{closed:!0,alignment:m,count:e.setup.count[m],gameType:e.setup.gameType,key:m}))}}catch(f){u.e(f)}finally{u.f()}}else{var d=Object.keys(e.setup.roles[0]);a=e.setup.roles.length>1,(t=d.map((function(t){return r.a.createElement(it,{small:!0,role:t,count:e.setup.roles[0][t],gameType:e.setup.gameType,key:t})}))).length>s&&(t=t.slice(0,s),i=!0)}return r.a.createElement("div",{className:"setup",ref:c,onClick:function(){o.onClick("/setup/".concat(e.setup.id),"setup",c.current,U(e.setup.name),(function(e){return e.roles=JSON.parse(e.roles)}))}},r.a.createElement(dt,{gameType:e.setup.gameType}),a&&r.a.createElement("i",{className:"multi-setup-icon fas fa-list-alt"}),t,i&&r.a.createElement("i",{className:"fas fa-ellipsis-h"}))}function mt(e){var t;return t=Array.isArray(e.roles)?e.roles.map((function(t){return r.a.createElement(it,{small:!0,role:t,key:t,gameType:e.gameType})})):Object.keys(e.roles).map((function(t){return r.a.createElement(it,{role:t,count:e.roles[t],small:!0,gameType:e.gameType,key:t})})),r.a.createElement("div",{className:"small-role-list"},t)}function dt(e){var t=$(e.gameType);return r.a.createElement("div",{className:"game-icon ".concat(t)})}function ft(e){var t;return"Day"==e.state?t="sun":"Night"==e.state&&(t="moon"),r.a.createElement("i",{className:"fa-".concat(t," fas state-icon")})}var pt=a(33),ht=a(20),vt=a(14),gt=a(15),bt=a(8),yt=a(9),Et=function(e){Object(vt.a)(a,e);var t=Object(gt.a)(a);function a(e,n){var r;return Object(bt.a)(this,a),(r=t.call(this,new WebSocket(e))).path=e,r.persistent=n,r.configurePing(),r.configureClose(),r}return Object(yt.a)(a,[{key:"reconnect",value:function(){Object(pt.a)(Object(ht.a)(a.prototype),"setSocket",this).call(this,new WebSocket(this.path)),this.heartbeat(),this.configureClose()}},{key:"configurePing",value:function(){var e=this;this.heartbeat(),this.on("p",(function(){return e.heartbeat()}))}},{key:"heartbeat",value:function(){var e=this;clearTimeout(this.pingTimeout),this.send("p"),this.pingTimeout=setTimeout((function(){e.socket.close()}),11e3)}},{key:"configureClose",value:function(){var e=this;this.socket.addEventListener("close",(function(){e.persistent&&e.reconnect()}))}},{key:"clear",value:function(){clearTimeout(this.pingTimeout),this.persistent=!1,this.listeners={},this.sendQueue=[],this.socket&&this.socket.close(),this.socket=null}}]),a}(function(){function e(t){Object(bt.a)(this,e),this.listeners={},this.sendQueue=[],this.received=[],this.setSocket(t)}return Object(yt.a)(e,[{key:"setSocket",value:function(e){var t=this;this.socket=e,this.configureListeners(),this.socket.addEventListener("open",(function(){t.received=[];var e,a=Object(T.a)(t.sendQueue);try{for(a.s();!(e=a.n()).done;){var n=e.value;t.socket.send(n)}}catch(r){a.e(r)}finally{a.f()}})),this.socket.addEventListener("close",(function(){t.triggerEvent("disconnected")})),this.socket.addEventListener("error",(function(){t.terminate()}))}},{key:"configureListeners",value:function(){var e=this;this.socket.addEventListener("message",(function(t){var a=function(e){var t=e.split(/:([\s\S]*)/),a=t[0];if(t.length<2)return[a];if((t=t[1].split(/:([\s\S]*)/)).length<2)return;var n=t[0],r=t[1];switch(n){case"number":r=Number(r);break;case"boolean":r="false"!=r;break;case"object":try{r=JSON.parse(r)}catch(o){return}}return[a,r]}(t.data),n=Object(i.a)(a,2),r=n[0],o=n[1];e.triggerEvent(r,o),e.received.push({eventName:r,data:o})}))}},{key:"triggerEvent",value:function(e,t){var a=this.listeners[e];if(a)for(var n=0;n<a.length;n++)a[n](t)}},{key:"on",value:function(e,t){this.listeners[e]||(this.listeners[e]=[]),t=t.bind(this),this.listeners[e].push(t);var a,n=Object(T.a)(this.received);try{for(n.s();!(a=n.n()).done;){var r=a.value;r.eventName==e&&t(r.data)}}catch(o){n.e(o)}finally{n.f()}}},{key:"send",value:function(e,t){var a=function(e,t){var a=typeof t;if("undefined"==a)return e;"object"==a?t=JSON.stringify(t):"string"!=a&&(t=String(t));return"".concat(e,":").concat(a,":").concat(t)}(e,t);0==this.socket.readyState?this.sendQueue.push(a):1==this.socket.readyState&&this.socket.send(a)}},{key:"clearListeners",value:function(){var e={};e.p=this.listeners.p,this.listeners=e}},{key:"terminate",value:function(){this.socket.close()}},{key:"readyState",get:function(){return this.socket?this.socket.readyState:3}}]),e}());a(441);function wt(){wt=function(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",c=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function i(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{i({},"")}catch(C){i=function(e,t,a){return e[t]=a}}function l(e,t,a,r){var o=t&&t.prototype instanceof d?t:d,c=Object.create(o.prototype),s=new k(r||[]);return n(c,"_invoke",{value:w(e,a,s)}),c}function u(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(C){return{type:"throw",arg:C}}}e.wrap=l;var m={};function d(){}function f(){}function p(){}var h={};i(h,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==t&&a.call(g,o)&&(h=g);var b=p.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){i(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){var r;n(this,"_invoke",{value:function(n,o){function c(){return new t((function(r,c){!function n(r,o,c,s){var i=u(e[r],e,o);if("throw"!==i.type){var l=i.arg,m=l.value;return m&&"object"==typeof m&&a.call(m,"__await")?t.resolve(m.__await).then((function(e){n("next",e,c,s)}),(function(e){n("throw",e,c,s)})):t.resolve(m).then((function(e){l.value=e,c(l)}),(function(e){return n("throw",e,c,s)}))}s(i.arg)}(n,o,r,c)}))}return r=r?r.then(c,c):c()}})}function w(e,t,a){var n="suspendedStart";return function(r,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw o;return x()}for(a.method=r,a.arg=o;;){var c=a.delegate;if(c){var s=O(c,a);if(s){if(s===m)continue;return s}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var i=u(e,t,a);if("normal"===i.type){if(n=a.done?"completed":"suspendedYield",i.arg===m)continue;return{value:i.arg,done:a.done}}"throw"===i.type&&(n="completed",a.method="throw",a.arg=i.arg)}}}function O(e,t){var a=t.method,n=e.iterator[a];if(void 0===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),m;var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function S(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(b,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=i(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,i(e,s,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},y(E.prototype),i(E.prototype,c,(function(){return this})),e.AsyncIterator=E,e.async=function(t,a,n,r,o){void 0===o&&(o=Promise);var c=new E(l(t,a,n,r),o);return e.isGeneratorFunction(a)?c:c.next().then((function(e){return e.done?e.value:c.next()}))},y(b),i(b,s,"Generator"),i(b,o,(function(){return this})),i(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var n in t)a.push(n);return a.reverse(),function e(){for(;a.length;){var n=a.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=S,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(a,n){return c.type="throw",c.arg=e,t.next=a,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],c=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=a.call(o,"catchLoc"),i=a.call(o,"finallyLoc");if(s&&i){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!i)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var c=o?o.completion:{};return c.type=e,c.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(c)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),j(a),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;j(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:S(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),m}},e}function Ot(){return r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/game/:gameId",render:function(e){return r.a.createElement(Nt,{key:e.match.params.gameId})}}),r.a.createElement(u.b,{exact:!0,path:"/game/:gameId/review",render:function(){return r.a.createElement(Nt,{review:!0})}}),r.a.createElement(u.a,{to:"/play"}))}function Nt(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),o=a[0],c=a[1],s=Object(n.useState)(!1),m=Object(i.a)(s,2),f=m[0],g=m[1],b=Object(n.useState)(!1),y=Object(i.a)(b,2),E=y[0],w=y[1],S=Object(n.useState)(),x=Object(i.a)(S,2),C=x[0],L=x[1],A=Object(n.useState)(),M=Object(i.a)(A,2),P=M[0],R=M[1],F=Object(n.useState)(),D=Object(i.a)(F,2),B=D[0],V=D[1],U=Object(n.useState)({}),G=Object(i.a)(U,2),W=G[0],_=G[1],$=Object(n.useState)(0),H=Object(i.a)($,2),q=H[0],Y=H[1],z=Object(n.useState)(),Q=Object(i.a)(z,2),J=Q[0],K=Q[1],Z=Object(n.useState)({}),te=Object(i.a)(Z,2),ae=te[0],ie=te[1],le=Object(n.useState)({}),ue=Object(i.a)(le,2),me=ue[0],de=ue[1],fe=Object(n.useReducer)((function(e,t){var a;switch(t.type){case"set":var n=Object.keys(t.history).sort((function(e,t){return e-t}));a={states:t.history},-2==n[0]?a.currentState=-2:a.currentState=n[n.length-1];break;case"addState":var r;e.states[t.state.id]?a=e:(r=-2!=t.state.id?t.state.id-1:Object.keys(e.states).sort((function(e,t){return t-e}))[0],a=p()(e,{states:Object(v.a)({},t.state.id,{$set:{name:t.state.name,meetings:{},alerts:[],stateEvents:[],roles:Object(h.a)({},e.states[r].roles),dead:Object(h.a)({},e.states[r].dead)}}),currentState:{$set:t.state.id}}));break;case"addMeeting":(c=e.states[e.currentState])&&(c.meetings||(a=p()(e,{states:Object(v.a)({},e.currentState,{meetings:{$set:{}}})})),a=p()(a||e,{states:Object(v.a)({},e.currentState,{meetings:Object(v.a)({},t.meeting.id,{$set:t.meeting})})}));break;case"meetingMembers":e.states[e.currentState]&&e.states[e.currentState].meetings[t.meetingId]&&(a=p()(e,{states:Object(v.a)({},e.currentState,{meetings:Object(v.a)({},t.meetingId,{members:{$set:t.members}})})}));break;case"removeMeeting":e.states[e.currentState]&&(a=p()(e,{states:Object(v.a)({},e.currentState,{meetings:{$unset:[t.meetingId]}})})).states[e.currentState].selTab==t.meetingId&&(a=p()(a,{states:Object(v.a)({},e.currentState,{$unset:["selTab"]})}));break;case"addMessage":e.states[e.currentState]&&(t.message.meetingId?e.states[e.currentState].meetings[t.message.meetingId]&&(a=p()(e,{states:Object(v.a)({},e.currentState,{meetings:Object(v.a)({},t.message.meetingId,{messages:{$push:[t.message]}})})})):a=p()(e,{states:Object(v.a)({},e.currentState,{alerts:{$push:[t.message]}})}));break;case"addQuote":e.states[e.currentState]&&e.states[e.currentState].meetings[t.quote.toMeetingId]&&(a=p()(e,{states:Object(v.a)({},e.currentState,{meetings:Object(v.a)({},t.quote.toMeetingId,{messages:{$push:[t.quote]}})})}));break;case"vote":var o=t.vote.target;(s=(c=e.states[e.currentState])&&c.meetings[t.vote.meetingId])&&(s.multi&&(o=[].concat(Object(X.a)(s.votes[t.vote.voterId]||[]),[o])),a=p()(e,{states:Object(v.a)({},e.currentState,{meetings:Object(v.a)({},t.vote.meetingId,{votes:Object(v.a)({},t.vote.voterId,{$set:o})})})}),t.vote.noLog||(a=p()(a,{states:Object(v.a)({},e.currentState,{meetings:Object(v.a)({},t.vote.meetingId,{voteRecord:{$push:[{type:"vote",voterId:t.vote.voterId,target:t.vote.target,time:Date.now()}]}})})})));break;case"unvote":var c,s;o=void 0,(s=(c=e.states[e.currentState])&&c.meetings[t.info.meetingId])&&(s.multi&&(o=(s.votes[t.info.voterId]||[]).filter((function(e){return e!=t.info.target}))),a=p()(e,{states:Object(v.a)({},e.currentState,{meetings:Object(v.a)({},t.info.meetingId,{votes:Object(v.a)({},t.info.voterId,{$set:o}),voteRecord:{$push:[{type:"unvote",voterId:t.info.voterId,time:Date.now()}]}})})}));break;case"stateEvents":e.states[e.currentState]&&(a=p()(e,{states:Object(v.a)({},e.currentState,{stateEvents:{$set:t.stateEvents}})}));break;case"selTab":e.states[t.state]&&(a=p()(e,{states:Object(v.a)({},t.state,{selTab:{$set:t.meetingId}})}));break;case"reveal":e.states[e.currentState]&&(a=p()(e,{states:Object(v.a)({},e.currentState,{roles:Object(v.a)({},t.playerId,{$set:t.role})})}));break;case"death":e.states[e.currentState]&&(a=p()(e,{states:Object(v.a)({},e.currentState,{dead:Object(v.a)({},t.playerId,{$set:!0})})}));break;case"revival":e.states[e.currentState]&&(a=p()(e,{states:Object(v.a)({},e.currentState,{dead:Object(v.a)({},t.playerId,{$set:!1})})}))}return a||e}),{states:{}}),pe=Object(i.a)(fe,2),he=pe[0],ve=pe[1],ge=function(e){return Object(n.useReducer)((function(t,a){var n;switch(a.type){case"backward":n=t>-2?t-1:Math.max.apply(Math,Object(X.a)(Object.keys(e.states)));break;case"forward":n=e.states[t+1]?t+1:-2;break;case"current":n=e.currentState;break;case"first":n=-1;break;default:n=t}return e.states[n]?n:t}),e.currentState)}(he),be=Object(i.a)(ge,2),ye=be[0],Ee=be[1],we=Object(n.useReducer)((function(e,t){var a;switch(t.type){case"set":a=t.players;break;case"add":a=e[t.player.id]?p()(e,Object(v.a)({},t.player.id,{$unset:["left"]})):p()(e,Object(v.a)({},t.player.id,{$set:t.player}));break;case"remove":a=p()(e,Object(v.a)({},t.playerId,{left:{$set:!0}}));break;case"setProp":a=p()(e,Object(v.a)({},t.playerId,Object(v.a)({},t.propName,{$set:t.propVal})))}return a||e}),{}),Oe=Object(i.a)(we,2),Ne=Oe[0],je=Oe[1],ke=Object(n.useState)(0),Se=Object(i.a)(ke,2),xe=Se[0],Ce=Se[1],Ie=Object(n.useState)(!1),Te=Object(i.a)(Ie,2),Le=Te[0],Ae=Te[1],Me=Object(n.useState)(),Pe=Object(i.a)(Me,2),Re=Pe[0],Fe=Pe[1],De=Object(n.useState)(""),Be=Object(i.a)(De,2),Ve=Be[0],Ue=Be[1],Ge=Object(n.useReducer)((function(e,t){var a=Object(h.a)({},e);switch(t.type){case"create":a[t.timer.name]={delay:t.timer.delay,time:0};break;case"clear":delete a[t.name];break;case"update":a[t.name].time=t.time;break;case"updateAll":for(var n in a)a[n].time+=1e3;var r=a.pregameCountdown||a.secondary||a.main;if(!r)break;var o=Math.round((r.delay-r.time)/1e3);o<6&&o>0&&t.playAudio("tick")}return a}),{}),We=Object(i.a)(Ge,2),_e=We[0],$e=We[1],He=Object(n.useReducer)((function(e,t){var a;switch(t.type){case"load":try{a=window.localStorage.getItem("gameSettings"),a=JSON.parse(a)}catch(n){a=e}break;case"set":a=t.settings,window.localStorage.setItem("gameSettings",JSON.stringify(a));break;case"setProp":a=p()(e,Object(v.a)({},t.propName,{$set:t.propval})),window.localStorage.setItem("gameSettings",JSON.stringify(a))}return a||e}),{votingLog:!1,timestamps:!0,sounds:!0,volume:1}),qe=Object(i.a)(He,2),Ye=qe[0],ze=qe[1],Qe=Object(n.useState)(!1),Je=Object(i.a)(Qe,2),Ke=Je[0],Xe=Je[1],Ze=Object(n.useState)(!1),et=Object(i.a)(Ze,2),tt=et[0],at=et[1],nt=Object(n.useState)({from:"",contains:""}),rt=Object(i.a)(nt,2),ot=rt[0],ct=rt[1],st=Object(n.useState)(),it=Object(i.a)(st,2),lt=it[0],ut=it[1],mt=Object(n.useState)(!1),dt=Object(i.a)(mt,2),ft=dt[0],pt=dt[1],ht=Object(n.useState)(!1),vt=Object(i.a)(ht,2),gt=vt[0],bt=vt[1],yt=Object(n.useState)(),Ot=Object(i.a)(yt,2),Nt=Ot[0],jt=Ot[1],kt=Object(n.useState)(!1),St=Object(i.a)(kt,2),xt=St[0],Ct=St[1],It=Object(n.useRef)(),Tt=Object(n.useRef)(),Lt=Object(n.useRef)(),At=Object(n.useRef)(),Mt=function(e,t){var a=Object(n.useReducer)((function(e,t){var a;switch(t.type){case"typing":a=p()(e,{typing:Object(v.a)({},t.playerId,{$set:t.meetingId})});break;case"speaking":var n=t.players.reduce((function(e,t){return e[t]=!0,e}),{});a=p()(e,{speaking:{$set:n}})}return a||e}),{typing:{},speaking:{}}),r=Object(i.a)(a,2),o=r[0],c=r[1];return Object(n.useEffect)((function(){var a=setInterval((function(){if(e.current){var a=[];t.current&&t.current.getVolumeLevel()>.001&&(a.push(e.current.uid),console.log(t.current.getVolumeLevel())),e.current.remoteUsers.forEach((function(e){e.audioTrack&&e.audioTrack.getVolumeLevel()>.001&&a.push(e.uid)})),c({type:"speaking",players:a})}}),50);return function(){return clearInterval(a)}})),[o,c]}(Lt,At),Pt=Object(i.a)(Mt,2),Rt=Pt[0],Ft=Pt[1],Dt=function(e){var t=Object(n.useRef)({}),a=Object(n.useReducer)((function(a,n){var r;switch(n.type){case"play":if(!e.sounds)return a;if(a.overrides[n.audioName])for(var o in a.overrides)a.overrides[o]&&t.current[o]&&t.current[o].pause();t.current[n.audioName]&&(t.current[n.audioName].currentTime=0,t.current[n.audioName].play().catch((function(e){})));break;case"load":for(var c in r={overrides:Object(h.a)({},a.overrides),volumes:Object(h.a)({},a.volumes)},n.files){var s=n.files[c];t.current[s]||(t.current[s]=new Audio("/audio/".concat(s,".mp3")),t.current[s].load(),t.current[s].loop=n.loops[c]),r.overrides[s]=n.overrides[c],r.volumes[s]=n.volumes[c]}break;case"volume":for(var i in t.current)a.volumes[i]&&(t.current[i].volume=a.volumes[i]*n.volume)}return r||a}),{overrides:{},volumes:{}}),r=Object(i.a)(a,2),o=r[0],c=r[1];return Object(n.useEffect)((function(){c({type:"volume",volume:e.volume})}),[e.volume,o]),[function(e){c({type:"play",audioName:e})},function(e,t,a,n){c({type:"load",files:e,loops:t,overrides:a,volumes:n})},function(){for(var e in t.current)t.current[e].pause()},function(e){var a,n=Object(T.a)(e);try{for(n.s();!(a=n.n()).done;){var r=a.value;t.current[r].pause()}}catch(o){n.e(o)}finally{n.f()}},function(e){c({type:"volume",volume:e})}]}(Ye),Bt=Object(i.a)(Dt,5),Vt=Bt[0],Ut=Bt[1],Gt=Bt[2],Wt=Bt[3],Ht=(Bt[4],Object(n.useContext)(N)),qt=(Object(n.useContext)(O),Object(n.useContext)(j),I()),zt=Object(u.i)().gameId,Qt=["bell","ping","tick"],Jt=[!1,!1,!1],Kt=[!1,!1,!1],Xt=[1,1,1];function Zt(){Lt.current||(Lt.current=ee.a.createClient({mode:"rtc",codec:"vp8"}),Lt.current.on("user-published",function(){var e=Object(l.a)(wt().mark((function e(t,a){return wt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("audio"==a){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Lt.current.subscribe(t,a);case 4:gt&&t.audioTrack.setVolume(0),t.audioTrack.play();case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),Lt.current.on("user-unpublished",(function(e){var t=document.getElementById(e.uid);t&&t.remove()})))}function ea(){return(ea=Object(l.a)(wt().mark((function e(t,a){return wt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,Lt.current){e.next=5;break}Zt(),e.next=7;break;case 5:return e.next=7,ta();case 7:return e.next=9,Lt.current.join("f366ac8a8daa4be5bd04700e89b5e1ac",t,a,Re);case 9:if(At.current){e.next=14;break}return e.next=12,ee.a.createMicrophoneAudioTrack();case 12:At.current=e.sent,ft&&At.current.setVolume(0);case 14:return e.next=16,Lt.current.publish([At.current]);case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),console.error(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})))).apply(this,arguments)}function ta(){return aa.apply(this,arguments)}function aa(){return(aa=Object(l.a)(wt().mark((function e(){return wt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Lt.current){e.next=2;break}return e.abrupt("return");case 2:return Lt.current.remoteUsers.forEach((function(e){var t=document.getElementById(e.uid);t&&t.remove()})),e.next=5,Lt.current.leave();case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}if(Object(n.useEffect)((function(){if(null!=B){var e;e="".concat("ws","://").concat("localhost",":").concat(C);var t=new Et(e);return t.on("connected",(function(){return Y(q+1)})),t.on("disconnected",(function(){return Y(q-1)})),_(t),function(){t&&t.clear()}}}),[B]),Object(n.useEffect)((function(){E&&(W.clear(),_({send:function(){}}))}),[E]),Object(n.useEffect)((function(){if(ze({type:"load"}),!e.review){var t=function(){var e=document.getElementById("speechInput"),t=document.activeElement.tagName;e&&"INPUT"!=t&&"TEXTAREA"!=t&&e.focus()};document.title="Game ".concat(zt," | BeyondMafia"),Ut(Qt,Jt,Kt,Xt),function(){Yt.apply(this,arguments)}();var a=setInterval((function(){$e({type:"updateAll",playAudio:Vt})}),1e3);return window.addEventListener("keydown",t),function(){window.removeEventListener("keydown",t),clearInterval(a),Gt(),ta(),At.current&&At.current.close()}}document.title="Review Game ".concat(zt," | BeyondMafia"),d.a.get("/game/".concat(zt,"/review/data")).then((function(e){var t=e.data;if(t.broken)return g(!0),void qt("Game not found.");R(t.type),K(t.setup),ie({ranked:t.ranked,spectating:t.spectating,private:!1}),ve({type:"set",history:JSON.parse(t.history)});var a={};for(var n in t.players)a[t.players[n]]={id:t.players[n],name:t.names[n],userId:t.users[n]?t.users[n].id:"",avatar:!!t.users[n]&&t.users[n].avatar,textColor:t.users[n]&&t.users[n].settings.textColor,nameColor:t.users[n]&&t.users[n].settings.nameColor,left:-1!=t.left.indexOf(t.players[n])};je({type:"set",players:a}),c(!0)})).catch((function(e){g(!0),qt(e)}))}),[]),Object(n.useEffect)((function(){Tt.current=Re}),[Re]),Object(n.useEffect)((function(){null==ye&&Ee({type:"current"})}),[he.currentState]),Object(n.useEffect)((function(){It.current=Ne}),[Ne]),Object(n.useEffect)((function(){if(ae.voiceChat&&!e.review)if(lt){var t=he.states[he.currentState],a=t&&t.meetings[lt],n=a&&a.vcToken;n&&function(e,t){ea.apply(this,arguments)}(lt,n)}else ta()}),[lt]),Object(n.useEffect)((function(){1==W.readyState?(B?W.send("auth",B):W.send("join",{gameId:zt,guestId:window.localStorage.getItem("cacheVal")}),W.on("authSuccess",(function(){W.send("join",{gameId:zt,isBot:"?bot"==window.location.search})})),W.on("loaded",(function(){c(!0)})),W.on("setup",(function(e){K(e)})),W.on("options",(function(e){ie(e)})),W.on("emojis",(function(e){de(e)})),W.on("state",(function(e){ve({type:"addState",state:e})})),W.on("history",(function(e){ve({type:"set",history:e})})),W.on("players",(function(e){je({type:"set",players:e})})),W.on("playerJoin",(function(e){je({type:"add",player:e})})),W.on("playerLeave",(function(e){je({type:"remove",playerId:e})})),W.on("spectatorCount",(function(e){Ce(e)})),W.on("self",(function(e){Fe(e)})),W.on("reveal",(function(e){ve({type:"reveal",playerId:e.playerId,role:e.role})})),W.on("death",(function(e){ve({type:"death",playerId:e})})),W.on("revival",(function(e){ve({type:"revival",playerId:e})})),W.on("meeting",(function(e){ve({type:"addMeeting",meeting:e})})),W.on("members",(function(e){ve({type:"meetingMembers",meetingId:e.meetingId,members:e.members})})),W.on("leftMeeting",(function(e){ve({type:"removeMeeting",meetingId:e})})),W.on("stateEvents",(function(e){ve({type:"stateEvents",stateEvents:e})})),W.on("message",(function(e){ve({type:"addMessage",message:e});var t=e.content.match(/@[\w-]*/gm)||[];Tt.current&&It.current[Tt.current]&&(-1!=t.indexOf("@"+It.current[Tt.current].name)||-1!=t.indexOf("@everyone"))&&Vt("ping")})),W.on("quote",(function(e){ve({type:"addQuote",quote:e})})),W.on("vote",(function(e){ve({type:"vote",vote:e})})),W.on("unvote",(function(e){ve({type:"unvote",info:e})})),W.on("lastWill",(function(e){Ue(e)})),W.on("firstGame",(function(){at(!0)})),W.on("timerInfo",(function(e){$e({type:"create",timer:e}),"pregameCountdown"==e.name&&Notification&&"granted"==Notification.permission&&!document.hasFocus()&&new Notification("Your game is starting!")})),W.on("clearTimer",(function(e){$e({type:"clear",name:e})})),W.on("time",(function(e){$e({type:"update",name:e.name,time:e.time})})),W.on("typing",(function(e){Ft({type:"typing",playerId:e.playerId,meetingId:e.meetingId})})),W.on("isSpectator",(function(){Ae(!0)})),W.on("left",(function(){g(!0),Ht.hideAllAlerts()})),W.on("finished",(function(){w(!0)})),W.on("error",(function(e){g(!0),qt(e)})),W.on("dev",(function(){Ct(!0)}))):null!=W.readyState&&3!=W.readyState||f||E||e.review||d.a.get("/game/".concat(zt,"/connect")).then((function(e){R(e.data.type),L(e.data.port),V(e.data.token||!1)})).catch((function(e){g(!0),qt(e)}))}),[q]),f)return r.a.createElement(u.a,{to:"/play"});if(Nt)return r.a.createElement(u.a,{to:"/game/".concat(Nt)});if(o&&null!=ye){var na={socket:W,review:e.review,setup:J,history:he,updateHistory:ve,stateViewing:ye,updateStateViewing:Ee,self:Re,isSpectator:Le,players:Ne,updatePlayers:je,timers:_e,options:ae,spectatorCount:xe,lastWill:Ve,emojis:me,setLeave:g,finished:E,settings:Ye,updateSettings:ze,setShowSettingsModal:Xe,speechFilters:ot,setSpeechFilters:ct,loadAudioFiles:Ut,playAudio:Vt,stopAudio:Gt,stopAudios:Wt,setRehostId:jt,agoraClient:Lt,localAudioTrack:At,setActiveVoiceChannel:ut,activity:Rt,muted:ft,setMuted:pt,deafened:gt,setDeafened:bt,dev:xt};return r.a.createElement(k.Provider,{value:na},r.a.createElement("div",{className:"game no-highlight"},r.a.createElement(_t,{showModal:Ke,setShowModal:Xe,settings:Ye,updateSettings:ze}),r.a.createElement($t,{showModal:tt,setShowModal:at}),"Mafia"==P&&r.a.createElement(re,null),"Resistance"==P&&r.a.createElement(ce,null),"Split Decision"==P&&r.a.createElement(oe,null),"One Night"==P&&r.a.createElement(se,null)))}return r.a.createElement("div",{className:"game"},r.a.createElement(ne,null))}function jt(e,t){Object(n.useEffect)((function(){t.on&&e(t)}),[t])}function kt(e){var t=Object(u.i)().gameId,a=Object(n.useRef)(),o=I(),c=Object(n.useContext)(N),s=Object(n.useContext)(j);return r.a.createElement("div",{className:"top"},r.a.createElement("div",{className:"game-name-wrapper"},e.gameName),r.a.createElement("div",{className:"state-wrapper"},r.a.createElement(Lt,{history:e.history,stateViewing:e.stateViewing,updateStateViewing:e.updateStateViewing}),e.timer),r.a.createElement("div",{className:"misc-wrapper"},r.a.createElement("div",{className:"misc-left"},r.a.createElement("div",{className:"misc-buttons"},e.options.voiceChat&&r.a.createElement("i",{className:"misc-icon fas fa-microphone"}),r.a.createElement("i",{className:"misc-icon fas fa-info-circle",ref:a,onClick:function(e){e.stopPropagation(),s.onClick("/game/".concat(t,"/info"),"game",a.current,"Game ".concat(t))}}),r.a.createElement("i",{className:"misc-icon fas fa-cog",onClick:function(){e.setShowSettingsModal(!0)}}),e.dev&&r.a.createElement("i",{className:"misc-icon fas fa-vial",onClick:function(){for(var t=0;t<e.setup.total-1;t++)window.open(window.location+"?bot")}})),r.a.createElement("div",{className:"options"},!e.options.private&&!e.review&&r.a.createElement("i",{className:"fas fa-lock-open"}),e.options.private&&!e.review&&r.a.createElement("i",{className:"fas fa-lock"}),!e.review&&r.a.createElement("div",{className:"player-count"},r.a.createElement("i",{className:"fas fa-users"}),Object.values(e.players).filter((function(e){return!e.left})).length," / ",e.setup.total),!e.options.spectating&&!e.review&&r.a.createElement("div",{className:"no-spectator"},r.a.createElement("i",{className:"fas fa-eye-slash"})),e.options.spectating&&!e.review&&r.a.createElement("div",{className:"spectator-count"},r.a.createElement("i",{className:"fas fa-eye"}),e.spectatorCount))),e.setup&&r.a.createElement(ut,{setup:e.setup}),r.a.createElement("div",{className:"btn btn-theme leave-game",onClick:function(){(e.finished||e.review||window.confirm("Are you sure you wish to leave?"))&&(e.finished&&c.hideAllAlerts(),e.socket.on?e.socket.send("leave"):e.setLeave(!0))}},"Leave"),!e.review&&-2==e.history.currentState&&r.a.createElement("div",{className:"btn btn-theme-sec rehost-game",onClick:function(){var a={};for(var n in e.options.stateLengths)a[n]=e.options.stateLengths[n]/6e4;d.a.post("/game/host",Object(h.a)({rehost:t,gameType:e.gameType,setup:e.setup.id,lobby:e.options.lobby,private:e.options.private,spectating:e.options.spectating,guests:e.options.guests,ranked:e.options.ranked,stateLengths:a},e.options.gameTypeOptions)).then((function(t){return e.setRehostId(t.data)})).catch(o)}},"Rehost")))}function St(e){return r.a.createElement("div",{className:"main"},r.a.createElement("div",{className:"left-panel panel"},e.leftPanelContent),r.a.createElement("div",{className:"center-panel panel"},e.centerPanelContent),r.a.createElement("div",{className:"right-panel panel"},e.rightPanelContent))}function xt(e){var t=e.history,a=e.players,o=e.stateViewing,c=e.updateHistory,s=e.setActiveVoiceChannel,l=t.states[o],u=l?l.meetings:{},m=l?l.alerts:[],d=l&&l.selTab,f=Object(n.useState)(!0),p=Object(i.a)(f,2),h=p[0],v=p[1],g=Object(n.useState)(!1),b=Object(i.a)(g,2),y=b[0],E=b[1],w=Object(n.useRef)(),O=Object.values(u).filter((function(e){return e.speech}));function N(){h&&w.current&&(w.current.scrollTop=w.current.scrollHeight)}function j(a){e.review||"server"==a.senderId||a.isQuote||!a.quotable||e.socket.send("quote",{messageId:a.id,toMeetingId:t.states[t.currentState].selTab,fromMeetingId:a.meetingId,fromState:o})}Object(n.useLayoutEffect)((function(){return N()})),Object(n.useEffect)((function(){null!=o&&!d&&O.length&&c({type:"selTab",state:o,meetingId:O[0].id})}),[o,O]),Object(n.useEffect)((function(){o==t.currentState?v(!0):v(!1)}),[o]),Object(n.useEffect)((function(){function e(){E(!0),document.removeEventListener("mousemove",e)}return document.addEventListener("mousemove",e),function(){return document.removeEventListener("mousemove",e)}}),[]),Object(n.useEffect)((function(){d&&u[d]&&u[d].vcToken||s(null),s(d)}),[d,u]);var k=O.map((function(e){return r.a.createElement("div",{className:"tab ".concat(d==e.id?"sel":""),key:e.id,onClick:function(){return t=e.id,c({type:"selTab",state:o,meetingId:t}),void v(!0);var t}},e.name)})),S=function(e,t,a,n,r,o){var c;c=a?Object(X.a)(e[a].messages):[];o&&(o.from||o.contains)&&(c=c.filter((function(e){var t=-1!=(e.content||"").toLowerCase().indexOf(o.contains.toLowerCase()),a=n[e.senderId].name;return t=t&&-1!=a.toLowerCase().indexOf(o.from.toLowerCase())})));var s,i,l=Object(T.a)(t);try{for(l.s();!(s=l.n()).done;)for(var u=s.value,m=0;m<=c.length;m++){if(m==c.length){c.push(u);break}if(u.time<c[m].time){c.splice(m,0,u);break}}}catch(O){l.e(O)}finally{l.f()}if(!r.votingLog)return c;i=a?e[a].voteRecord:[];for(var d in e)e[d].speech||(i=i.concat(e[d].voteRecord));var f,p=Object(T.a)(i);try{for(p.s();!(f=p.n()).done;){var h=f.value,v="unvote"==h.type,g=n[h.voterId],b=g?g.name:"Anonymous",y=h.target;v||("*"!=y&&n[y]?y=n[y].name:"*"==y&&(y="no one"));for(var E={senderId:"vote",content:"".concat(b," ").concat(v?"unvotes":"votes"," ").concat(v?"":y),time:h.time},w=0;w<=c.length;w++){if(w==c.length){c.push(E);break}if(h.time<c[w].time){c.splice(w,0,E);break}}}}catch(O){p.e(O)}finally{p.f()}return c}(u,m,d,a,e.settings,e.filters);S=S.map((function(n,o){return r.a.createElement(Ct,{message:n,history:t,players:a,key:n.id||n.messageId+n.time||o,onMessageQuote:j,settings:e.settings})}));var x=d;return x=(x=x&&(u[d].members.length>1||-1==t.currentState))&&o==t.currentState&&u[d].amMember&&u[d].canTalk,r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"meeting-tabs"},k.length>0&&k,0==k.length&&r.a.createElement("div",{className:"tab sel"},l&&l.name)),r.a.createElement("div",{className:"speech-wrapper"},r.a.createElement("div",{className:"speech-display",onScroll:function(){if(y){var e=w.current;Math.round(e.scrollTop+e.clientHeight)>=Math.round(e.scrollHeight)?v(!0):v(!1)}else N()},ref:w},S),x&&r.a.createElement(Tt,{meetings:u,selTab:d,players:a,options:e.options,socket:e.socket,setAutoScroll:v,agoraClient:e.agoraClient,localAudioTrack:e.localAudioTrack,muted:e.muted,setMuted:e.setMuted,deafened:e.deafened,setDeafened:e.setDeafened})))}function Ct(e){var t,a,n=e.history,o=e.players,c=e.message,s="content ",i=!1;if("server"!=c.senderId&&"vote"!=c.senderId&&"anonymous"!=c.senderId&&(t=o[c.senderId]),c.isQuote){var l=n.states[c.fromState];if(!l)return;var u=l.meetings[c.fromMeetingId];if(!u)return;var m,d=Object(T.a)(u.messages);try{for(d.s();!(m=d.n()).done;){var f=m.value;if(f.id==c.messageId){(a=Object(h.a)({},f)).meetingName=u.name,"anonymous"==f.senderId?a.senderName="Anonymous":a.senderName=o[f.senderId].name;break}}}catch(p){d.e(p)}finally{d.f()}}return c.isQuote&&!a?r.a.createElement(r.a.Fragment,null):(!t&&"anonymous"!=c.senderId||c.isQuote||(s+="clickable "),c.isQuote||0!=c.content.indexOf("/me ")||(i=!0,(c=Object(h.a)({},c)).content=c.content.replace("/me ","")),c.isQuote?s+="quote ":"server"==c.senderId?s+="server ":"vote"==c.senderId?s+="vote-record ":i&&(s+="me "),r.a.createElement("div",{className:"message",onDoubleClick:function(){return e.onMessageQuote(c)}},r.a.createElement("div",{className:"sender"},e.settings.timestamps&&r.a.createElement(It,{time:c.time}),t&&r.a.createElement(xe,{id:t.userId,name:t.name,avatar:t.avatar,color:t.nameColor,noLink:!0,small:!0}),"anonymous"==c.senderId&&r.a.createElement("div",{className:"name-with-avatar"},"Anonymous")),r.a.createElement("div",{className:s,style:t&&t.textColor?{color:t.textColor}:{}},!c.isQuote&&r.a.createElement(r.a.Fragment,null,c.prefix&&r.a.createElement("div",{className:"prefix"},"(",c.prefix,")"),r.a.createElement(V,{text:c.content,filterProfanity:!0,linkify:!0,emotify:!0})),c.isQuote&&r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fas fa-quote-left"}),r.a.createElement(It,{time:a.time}),r.a.createElement("div",{className:"quote-info"},"".concat(a.senderName," in ").concat(a.meetingName,": ")),r.a.createElement("div",{className:"quote-content"},r.a.createElement(V,{text:a.content,filterProfanity:!0,linkify:!0,emotify:!0})),r.a.createElement("i",{className:"fas fa-quote-right"})))))}function It(e){var t=new Date(e.time),a=String(t.getHours()).padStart(2,"0"),n=String(t.getMinutes()).padStart(2,"0"),o=String(t.getSeconds()).padStart(2,"0");return r.a.createElement("div",{className:"time"},a,":",n,":",o)}function Tt(e){var t,a=e.socket,o=e.meetings,c=e.selTab,s=e.players,l=e.options,u=e.agoraClient,m=e.localAudioTrack,d=e.muted,f=e.setMuted,p=e.deafened,h=e.setDeafened,v=Object(n.useState)(""),g=Object(i.a)(v,2),b=g[0],y=g[1],E=Object(n.useState)([]),w=Object(i.a)(E,2),O=w[0],N=w[1],j=Object(n.useState)("Say"),k=Object(i.a)(j,2),S=k[0],x=k[1],C=Object(n.useState)(0),I=Object(i.a)(C,2),L=I[0],A=I[1],M=Object(n.useState)(),P=Object(i.a)(M,2),R=P[0],F=P[1],D=Object(n.useState)(),B=Object(i.a)(D,2),V=B[0],U=B[1],G="",_=Object(T.a)(O);try{for(_.s();!(t=_.n()).done;){var $=t.value;if(S==$.id){G=$.placeholder||"";break}}}catch(H){_.e(H)}finally{_.f()}return Object(n.useEffect)((function(){if(c){var e,t=o[c].speechAbilities,a=[{label:"Say",id:"Say",placeholder:"to everyone"}],n=Object(T.a)(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;a.push("divider");var i,l=Object(T.a)(r.targets);try{for(l.s();!(i=l.n()).done;){var u=i.value,m=u;"player"==r.targetType&&(m=s[u].name),a.push({label:r.name,placeholder:"".concat(r.verb," ").concat(m),id:"".concat(r.name,":").concat(u)})}}catch(H){l.e(H)}finally{l.f()}}}catch(H){n.e(H)}finally{n.f()}N(a)}}),[c]),Object(n.useEffect)((function(){L>0?(clearTimeout(V),U(setTimeout((function(){return A(0)}),1e3)),R!=c&&(F(c),null!=R&&a.send("typing",{meetingId:R,isTyping:!1}),a.send("typing",{meetingId:c,isTyping:!0}))):null!=R&&(F(null),a.send("typing",{meetingId:R,isTyping:!1}))}),[L]),r.a.createElement("div",{className:"speech-input-area"},r.a.createElement("div",{className:"speech-input-wrapper"},r.a.createElement(W,{className:"speech-dropdown",options:O,onChange:function(e){x(e)},value:S}),r.a.createElement("input",{id:"speechInput",className:"speech-input",type:"text",autoComplete:"off",value:b,placeholder:G,maxLength:240,onChange:function(e){y(e.target.value),A(Date.now())},onKeyPress:function(t){if("Enter"==t.key&&c&&b.length){var n=S.split(":"),r=n[0],o=n[1];"Say"==r&&(r=null),a.send("speak",{content:b,meetingId:c,abilityName:r,abilityTarget:o}),y(""),e.setAutoScroll(!0)}}})),l.voiceChat&&r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fas fa-microphone ".concat(d?"disabled":""),onClick:function(){if(m.current){var e=d?100:0;m.current.setVolume(e),f(!d)}}}),r.a.createElement("i",{className:"fas fa-headphones ".concat(p?"disabled":""),onClick:function(){if(u.current){var e=p?100:0;u.current.remoteUsers.forEach((function(t){t.audioTrack&&t.audioTrack.setVolume(e)})),h(!p)}}})))}function Lt(e){var t=e.history,a=e.stateViewing,n=t.states[a]?t.states[a].name:"",o=-1!=e.stateViewing,c=e.stateViewing<t.currentState||-2==t.currentState&&e.stateViewing!=t.currentState;return r.a.createElement("div",{className:"state-nav"},r.a.createElement("i",{className:"hist-arrow fas fa-caret-left ".concat(o?"":"invisible"),onClick:function(){return e.updateStateViewing({type:"backward"})}}),r.a.createElement("div",{className:"state-name",onClick:function(){e.updateStateViewing({type:"current"})}},n.toUpperCase()),r.a.createElement("i",{className:"hist-arrow fas fa-caret-right ".concat(c?"":"invisible"),onClick:function(){return e.updateStateViewing({type:"forward"})}}))}function At(e){return r.a.createElement("div",{className:"side-menu ".concat(e.scrollable?"scrollable":"")},r.a.createElement("div",{className:"side-menu-title"},e.title),r.a.createElement("div",{className:"side-menu-content"},e.content))}function Mt(e){var t=e.history,a=e.players,n=e.activity,o=t.states[e.stateViewing],c=o&&o.selTab;return a.map((function(t){return r.a.createElement("div",{className:"player ".concat(e.className?e.className:""),key:t.id},-1!=e.stateViewing&&r.a.createElement(it,{role:o.roles[t.id],gameType:e.gameType,showPopover:!0}),r.a.createElement(xe,{id:t.userId,name:t.name,avatar:t.avatar,color:t.nameColor,active:n.speaking[t.id],newTab:!0}),c&&n.typing[t.id]==c&&r.a.createElement(ae.a,{className:"typing-icon ".concat(-1!=e.stateViewing?"has-role":""),type:"bubbles",color:"white",width:"20",height:"20"}))}))}function Pt(e){var t=e.history,a=t.states[e.stateViewing],n=Object.values(e.players).filter((function(e){return!a.dead[e.id]&&!e.left})),o=Object.values(e.players).filter((function(e){return a.dead[e.id]&&!e.left}));return r.a.createElement(At,{title:"Players",scrollable:!0,content:r.a.createElement("div",{className:"player-list"},r.a.createElement(Mt,{players:n,history:t,gameType:e.gameType,stateViewing:e.stateViewing,activity:e.activity}),o.length>0&&r.a.createElement("div",{className:"section-title"},r.a.createElement("i",{className:"fas fa-skull"}),"Graveyard"),r.a.createElement(Mt,{players:o,history:t,gameType:e.gameType,stateViewing:e.stateViewing,activity:e.activity,className:"dead"}))})}function Rt(e){var t=Object.values(e.meetings).reduce((function(t,a){if(a.voting){var n;switch(a.inputType){case"player":case"boolean":case"alignment":case"select":n=r.a.createElement(Ft,{key:a.id,socket:e.socket,meeting:a,players:e.players,self:e.self,history:e.history,stateViewing:e.stateViewing});break;case"button":n=r.a.createElement(Dt,{key:a.id,socket:e.socket,meeting:a,players:e.players,self:e.self,history:e.history,stateViewing:e.stateViewing});break;case"text":n=r.a.createElement(Bt,{key:a.id,socket:e.socket,meeting:a,players:e.players,self:e.self,history:e.history,stateViewing:e.stateViewing})}t.push(n)}return t}),[]);return r.a.createElement(r.a.Fragment,null,t.length>0&&r.a.createElement(At,{scrollable:!0,title:"Actions",content:r.a.createElement("div",{className:"action-list"},t)}))}function Ft(e){var t=Vt(e),a=Object(i.a)(t,6),n=a[0],o=(a[1],a[2],a[3],a[4]),c=a[5],s=_(),l=Object(i.a)(s,4),u=l[0],m=l[1],d=l[2],f=l[3],p=n.targets.map((function(t){var a=Ut(t,n,e.players);return r.a.createElement("div",{className:"target dropdown-menu-option",key:t,onClick:function(){return e=t,m(!1),void c(e);var e}},a)})),h=Object.values(n.members).filter((function(e){return e.canVote})).map((function(t){var a=n.votes[t.id],o=e.players[t.id];return a=Ut(a,n,e.players),r.a.createElement("div",{className:"vote ".concat(n.multi?"multi":""),key:t.id},r.a.createElement("div",{className:"voter"},o&&o.name||"Anonymous"),a.length>0&&r.a.createElement("div",{className:"italic"},"votes"),r.a.createElement("div",{className:"selection"},a.join(", ")))}));return r.a.createElement("div",{className:"action"},r.a.createElement("div",{className:"action-name dropdown-control ".concat(o?"not-clickable":""),ref:d,onClick:function(){o||m(!u)}},n.actionName,r.a.createElement("i",{className:"fas fa-angle-down dropdown-arrow"})),u&&r.a.createElement("div",{className:"targets dropdown-menu",ref:f},p),r.a.createElement("div",{className:"votes"},h))}function Dt(e){var t=Vt(e),a=Object(i.a)(t,6),n=a[0],o=(a[1],a[2],a[3],a[4],a[5]),c=Object(h.a)({},n.votes);for(var s in c)c[s]=Ut(c[s],n,e.players);var l=n.targets.map((function(t){var a=Ut(t,n,e.players);return r.a.createElement("div",{className:"btn btn-theme ".concat(c[e.self]==a?"sel":""),key:t,disabled:c[e.self]&&!n.canUnvote,onClick:function(){return o(t)}},a)}));return r.a.createElement("div",{className:"action"},r.a.createElement("div",{className:"action-name"},n.actionName),l)}function Bt(e){var t=Vt(e),a=Object(i.a)(t,6),o=a[0],c=(a[1],a[2],a[3],a[4],a[5]),s=Object(n.useState)(""),l=Object(i.a)(s,2),u=l[0],m=l[1],d=Object(h.a)({},o.votes);0==u.length&&d[e.self]&&m(d[e.self]);o.targets.map((function(t){var a=Ut(t,o,e.players);return r.a.createElement("div",{className:"btn btn-theme ".concat(d[e.self]==a?"sel":""),key:t,onClick:function(){return c(t)}},a)}));return r.a.createElement("div",{className:"action"},r.a.createElement("input",{value:u,onChange:function(e){c(e.target.value),m(e.target.value)}}))}function Vt(e){var t=e.meeting,a=e.history,n=e.stateViewing,r=n==a.currentState,o=!r||!t.amMember||!t.canVote||t.instant&&t.votes[e.self];return[t,a,n,r,o,function(a){(Array.isArray(t.votes[e.self])?-1!=t.votes[e.self].indexOf(a):a==t.votes[e.self])?e.socket.send("unvote",{meetingId:t.id,selection:a}):e.socket.send("vote",{meetingId:t.id,selection:a})}]}function Ut(e,t,a){for(var n in e=!Array.isArray(e)&&e?[e]:e?Object(X.a)(e):[]){var r=e[n];switch(t.inputType){case"player":r="*"==r?"no one":r?a[r].name:"";break;case"boolean":"*"==r?r="No":r||(r="");default:"*"==r?r="None":r||(r="")}e[n]=r}return e}function Gt(e){var t;t=-1==e.history.currentState?"pregameCountdown":e.timers.secondary?"secondary":"main";var a=e.timers[t];if(!a)return r.a.createElement("div",{className:"state-timer"});var n=a.delay-a.time;return n=function(e){e=e>0?Math.round(e/1e3):0;var t=String(Math.floor(e/60)).padStart(2,"0"),a=String(e%60).padStart(2,"0");return"".concat(t,":").concat(a)}(n),r.a.createElement("div",{className:"state-timer"},n)}function Wt(e){var t=Object(n.useState)(e.lastWill),a=Object(i.a)(t,2),o=a[0],c=a[1];return r.a.createElement(At,{title:"Last Will",content:r.a.createElement("div",{className:"last-will-wrapper"},r.a.createElement("textarea",{className:"last-will-entry",value:o,onChange:function(t){var a=t.target.value.slice(0,100);c(a),e.socket.send("lastWill",a)}}))})}function _t(e){var t=e.settings,a=e.updateSettings,n=e.showModal,o=e.setShowModal,c=be([{label:"Voting Log",ref:"votingLog",type:"boolean",value:t.votingLog},{label:"Timestamps",ref:"timestamps",type:"boolean",value:t.timestamps},{label:"Sounds",ref:"sounds",type:"boolean",value:t.sounds},{label:"Volume",ref:"volume",type:"range",min:0,max:1,step:.1,value:t.volume}]),s=Object(i.a)(c,2),l=s[0],u=s[1],m=r.a.createElement(pe,{fields:l,onChange:u}),d=r.a.createElement("div",{className:"settings-control"},r.a.createElement("div",{className:"settings-save btn btn-theme",onClick:function(){var e,t={},n=Object(T.a)(l);try{for(n.s();!(e=n.n()).done;){var r=e.value;t[r.ref]=r.value}}catch(c){n.e(c)}finally{n.f()}a({type:"set",settings:t}),o(!1)}},"Save"),r.a.createElement("div",{className:"settings-cancel btn btn-theme-third",onClick:f},"Cancel"));function f(){var e,a=Object(T.a)(l);try{for(a.s();!(e=a.n()).done;){var n=e.value;u({ref:n.ref,prop:"value",value:t[n.ref]})}}catch(r){a.e(r)}finally{a.f()}o(!1)}return r.a.createElement(Te,{className:"settings",show:n,header:"Settings",content:m,footer:d,onBgClick:f})}function $t(e){var t=e.showModal,a=e.setShowModal,n=r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"paragraph"},"To keep games fun and competitive for all, please don't:"),r.a.createElement("div",{className:"paragraph"},r.a.createElement("div",null,"- Communicate with other players using anything which isn't part of the game."),r.a.createElement("div",null,"- Form alliances or other out-of-game arrangements with other users."),r.a.createElement("div",null,"- Attempt to play a game using more than one account."),r.a.createElement("div",null,'- Send screenshots or "prove" anything with images or video.'),r.a.createElement("div",null,"- Copy exactly any system messages you recieve (blue text)."),r.a.createElement("div",null,"- Try to lose the game on purpose."),r.a.createElement("div",null,"- Give up or leave partway through the game."),r.a.createElement("div",null,"- Issue out-of-game bribes or threats to sway other players, including threatening to leave.")),r.a.createElement("div",{className:"paragraph"},"Breaking game conduct may result in necessary action being taken against your account."),r.a.createElement("div",{className:"paragraph"},"A full description of these rules as well as site and community rules is found ",r.a.createElement("a",null,"here"),"."),r.a.createElement("div",{className:"paragraph"},"You can also find tutorials, tips, and strategy guides ",r.a.createElement("a",{href:"/community/forums/board/SLsDA_SI2"},"here"),". Good luck, and have fun!")),o=r.a.createElement("div",{className:"btn btn-theme",onClick:c},"Close");function c(){a(!1)}return r.a.createElement(Te,{className:"first-game",show:t,header:"Welcome to BeyondMafia",content:n,footer:o,onBgClick:c})}function Ht(e){var t=e.filters,a=e.setFilters;function n(e,n){a(p()(t,Object(v.a)({},e,{$set:n})))}return e.stateViewing<0?r.a.createElement(r.a.Fragment,null):r.a.createElement(At,{title:"Speech Filters",content:r.a.createElement("div",{className:"speech-filters"},r.a.createElement("input",{type:"text",placeholder:"From user",value:t.from,onChange:function(e){return n("from",e.target.value)}}),r.a.createElement("input",{type:"text",placeholder:"Contains",value:t.contains,onChange:function(e){return n("contains",e.target.value)}}))})}function qt(e){var t=e.stateViewing,a=Object(n.useState)(""),o=Object(i.a)(a,2),c=o[0],s=o[1],l=Object(u.i)().gameId;return Object(n.useEffect)((function(){var e=window.localStorage.getItem("notesData");e&&((e=JSON.parse(e)).game!=l?window.localStorage.removeItem("notesData"):s(e.notes))}),[]),t<0?r.a.createElement(r.a.Fragment,null):r.a.createElement(At,{title:"Notes",content:r.a.createElement("div",{className:"notes-wrapper"},r.a.createElement("textarea",{className:"notes-entry",value:c,onChange:function(e){return t=e.target.value,s(t),void window.localStorage.setItem("notesData",JSON.stringify({game:l,notes:t}));var t}}))})}function Yt(){return(Yt=Object(l.a)(wt().mark((function e(){return wt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Notification){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Notification.requestPermission();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}a(442);function zt(e){var t=Object(n.useState)([]),a=Object(i.a)(t,2),o=a[0],c=a[1],s=Object(n.useState)(""),l=Object(i.a)(s,2),u=l[0],m=l[1];Object(n.useEffect)((function(){document.title="Users | BeyondMafia",d.a.get("/user/online").then((function(e){c(e.data)})).catch(I)}),[]),Object(n.useEffect)((function(){u.length>0?d.a.get("/user/searchName?query=".concat(u)).then((function(e){c(e.data)})).catch(I):d.a.get("/user/online").then((function(e){c(e.data)})).catch(I)}),[u]);var f=o.map((function(e){return r.a.createElement("div",{className:"user-cell"},r.a.createElement(xe,{id:e.id,name:e.name,avatar:e.avatar}),r.a.createElement(Ce,{status:e.status}))}));return r.a.createElement("div",{className:"span-panel main user-search-page"},r.a.createElement("div",{className:"form"},r.a.createElement("input",{type:"text",placeholder:"Username",value:u,onChange:function(e){return m(e.target.value)}})),r.a.createElement("div",{className:"users"},f))}a(443);function Qt(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(!1),s=Object(i.a)(c,2),l=s[0],u=s[1],m=Object(n.useContext)(O),f=I();Object(n.useEffect)((function(){document.title="Moderation | BeyondMafia",d.a.get("/mod/groups").then((function(e){o(e.data.sort((function(e,t){return t.rank-e.rank}))),u(!0)})).catch((function(e){u(!0),f(e)}))}),[]);var p=a.map((function(e){var t=e.members.map((function(e){return r.a.createElement("div",{className:"member user-cell",key:e.id},r.a.createElement(xe,{id:e.id,name:e.name,avatar:e.avatar}),r.a.createElement(Ce,{status:e.status}))}));return r.a.createElement("div",{className:"span-panel group-panel",key:e.name},r.a.createElement("div",{className:"title"},e.name+"s"),r.a.createElement("div",{className:"members"},t))}));return l?r.a.createElement("div",{class:"moderation"},m.perms.viewModActions&&r.a.createElement("div",{className:"span-panel action-panel"},r.a.createElement("div",{className:"title"},"Do Action"),r.a.createElement(Jt,null)),p):r.a.createElement(ne,null)}function Jt(){var e=Object(n.useState)(),t=Object(i.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)({}),s=Object(i.a)(c,2),l=s[0],u=s[1],m=function(e,t){var a=Object(n.useContext)(N),r=I();return{"Create Group":{perm:"createGroup",args:[{label:"Name",name:"name",type:"text",maxlength:20},{label:"Rank",name:"rank",type:"number",default:0},{label:"Permissions",name:"permissions",type:"text",optional:!0,isArray:!0}],run:function(){d.a.post("/mod/group",e).then((function(){a.showAlert("Group created.","success"),t()})).catch(r)}},"Delete Group":{perm:"deleteGroup",args:[{label:"Name",name:"name",type:"text",maxlength:20}],run:function(){d.a.post("/mod/group/delete",e).then((function(){a.showAlert("Group deleted.","success"),t()})).catch(r)}},"Create Category":{perm:"createCategory",args:[{label:"Name",name:"name",type:"text",maxlength:20},{label:"Position",name:"position",type:"number",default:0}],run:function(){d.a.post("/forums/category",e).then((function(){a.showAlert("Category created.","success"),t()})).catch(r)}},"Create Board":{perm:"createBoard",args:[{label:"Name",name:"name",type:"text",maxlength:20},{label:"Category",name:"category",type:"text",maxlength:20},{label:"Description",name:"description",type:"text",maxlength:60},{label:"Icon",name:"icon",type:"text",optional:!0},{label:"Rank",name:"rank",type:"number",optional:!0},{label:"Position",name:"position",type:"number",optional:!0}],run:function(){d.a.post("/forums/board",e).then((function(){a.showAlert("Board created.","success"),t()})).catch(r)}},"Update Group Permissions":{perm:"updateGroupPerms",args:[{label:"Group Name",name:"groupName",type:"text",maxlength:20},{label:"Permissions to Add",name:"addPermissions",type:"text",optional:!0,isArray:!0},{label:"Permissions to Remove",name:"removePermissions",type:"text",optional:!0,isArray:!0}],run:function(){d.a.post("/mod/groupPerms",e).then((function(){a.showAlert("Group permissions updated.","success"),t()})).catch(r)}},"Add User to Group":{perm:"giveGroup",args:[{label:"User Id",name:"userId",type:"text"},{label:"Group Name",name:"groupName",type:"text",maxlength:20}],run:function(){d.a.post("/mod/addToGroup",e).then((function(){a.showAlert("User added to group.","success"),t()})).catch(r)}},"Remove User from Group":{perm:"removeFromGroup",args:[{label:"User Id",name:"userId",type:"text"},{label:"Group Name",name:"groupName",type:"text",maxlength:20}],run:function(){d.a.post("/mod/removeFromGroup",e).then((function(){a.showAlert("User removed from group.","success"),t()})).catch(r)}},"Get Group Permissions":{perm:"viewPerms",args:[{label:"Name",name:"name",type:"text",maxlength:20}],run:function(){d.a.get("/mod/groupPerms?name=".concat(e.name)).then((function(e){alert(e.data.join(", "),"success"),t()})).catch(r)}},"Get User Permissions":{perm:"viewPerms",args:[{label:"User Id",name:"userId",type:"text"}],run:function(){d.a.get("/mod/userPerms?userId=".concat(e.userId)).then((function(e){alert(e.data.join(", "),"success"),t()})).catch(r)}},"Delete Board":{perm:"deleteBoard",args:[{label:"Name",name:"name",type:"text",maxlength:20}],run:function(){d.a.post("/forums/board/delete",e).then((function(){a.showAlert("Board deleted.","success"),t()})).catch(r)}},"Move Thread":{perm:"moveThread",args:[{label:"Thread ID",name:"thread",type:"text"},{label:"Board Name",name:"board",type:"text"}],run:function(){d.a.post("/forums/thread/move",e).then((function(){a.showAlert("Thread moved.","success"),t()})).catch(r)}},"Create Chat Room":{perm:"createRoom",args:[{label:"Name",name:"name",type:"text",maxlength:20},{label:"Position",name:"position",type:"number",optional:!0},{label:"Rank",name:"rank",type:"number",optional:!0}],run:function(){d.a.post("/chat/room",e).then((function(){a.showAlert("Room created.","success"),t()})).catch(r)}},"Delete Chat Room":{perm:"deleteRoom",args:[{label:"Room Name",name:"name",type:"text"}],run:function(){d.a.post("/chat/room/delete",e).then((function(){a.showAlert("Room deleted.","success"),t()})).catch(r)}},"Forum Ban":{perm:"forumBan",args:[{label:"User Id",name:"userId",type:"text"},{label:"Length",name:"length",type:"text"}],run:function(){d.a.post("/mod/forumBan",e).then((function(){a.showAlert("User forum banned.","success"),t()})).catch(r)}},"Chat Ban":{perm:"chatBan",args:[{label:"User Id",name:"userId",type:"text"},{label:"Length",name:"length",type:"text"}],run:function(){d.a.post("/mod/chatBan",e).then((function(){a.showAlert("User chat banned.","success"),t()})).catch(r)}},"Game Ban":{perm:"gameBan",args:[{label:"User Id",name:"userId",type:"text"},{label:"Length",name:"length",type:"text"}],run:function(){d.a.post("/mod/gameBan",e).then((function(){a.showAlert("User game banned.","success"),t()})).catch(r)}},"Host Ranked Ban":{perm:"hostRankedBan",args:[{label:"User Id",name:"userId",type:"text"},{label:"Length",name:"length",type:"text"}],run:function(){d.a.post("/mod/hostRankedBan",e).then((function(){a.showAlert("User host ranked banned.","success"),t()})).catch(r)}},"Site Ban":{perm:"siteBan",args:[{label:"User Id",name:"userId",type:"text"},{label:"Length",name:"length",type:"text"}],run:function(){d.a.post("/mod/siteBan",e).then((function(){a.showAlert("User site banned.","success"),t()})).catch(r)}},"Force Sign Out":{perm:"forceSignOut",args:[{label:"User Id",name:"userId",type:"text"}],run:function(){d.a.post("/mod/logout",e).then((function(){a.showAlert("User logged out.","success"),t()})).catch(r)}},"Forum Unban":{perm:"forumUnban",args:[{label:"User Id",name:"userId",type:"text"}],run:function(){d.a.post("/mod/forumUnban",e).then((function(){a.showAlert("User forum unbanned.","success"),t()})).catch(r)}},"Chat Unban":{perm:"chatUnban",args:[{label:"User Id",name:"userId",type:"text"}],run:function(){d.a.post("/mod/chatUnban",e).then((function(){a.showAlert("User chat unbanned.","success"),t()})).catch(r)}},"Game Unban":{perm:"gameUnban",args:[{label:"User Id",name:"userId",type:"text"}],run:function(){d.a.post("/mod/gameUnban",e).then((function(){a.showAlert("User game unbanned.","success"),t()})).catch(r)}},"Site Unban":{perm:"siteUnban",args:[{label:"User Id",name:"userId",type:"text"}],run:function(){d.a.post("/mod/siteUnban",e).then((function(){a.showAlert("User site unbanned.","success"),t()})).catch(r)}},"Get Alt Accounts":{perm:"viewAlts",args:[{label:"User Id",name:"userId",type:"text"}],run:function(){d.a.get("/mod/alts?userId=".concat(e.userId)).then((function(e){alert(e.data.join(", ")),t()})).catch(r)}},"Get Bans":{perm:"viewBans",args:[{label:"User Id",name:"userId",type:"text"}],run:function(){d.a.get("/mod/bans?userId=".concat(e.userId)).then((function(e){alert(e.data.map((function(e){return"Type: ".concat(e.type,", mod: ").concat(e.modId,", expires: ").concat(new Date(e.expires).toLocaleString())})).join("\n")),t()})).catch(r)}},"Clear Setup Name":{perm:"clearSetupName",args:[{label:"Setup Id",name:"setupId",type:"text"}],run:function(){d.a.post("/mod/clearSetupName",e).then((function(){a.showAlert("Setup name cleared.","success"),t()})).catch(r)}},"Clear Bio":{perm:"clearBio",args:[{label:"User Id",name:"userId",type:"text"}],run:function(){d.a.post("/mod/clearBio",e).then((function(){a.showAlert("Bio cleared.","success"),t()})).catch(r)}},"Clear Account Display":{perm:"clearAccountDisplay",args:[{label:"User Id",name:"userId",type:"text"}],run:function(){d.a.post("/mod/clearAccountDisplay",e).then((function(){a.showAlert("Account display cleared.","success"),t()})).catch(r)}},"Clear Name":{perm:"clearName",args:[{label:"User Id",name:"userId",type:"text"}],run:function(){d.a.post("/mod/clearName",e).then((function(){a.showAlert("Name cleared.","success"),t()})).catch(r)}},"Clear Avatar":{perm:"clearAvi",args:[{label:"User Id",name:"userId",type:"text"}],run:function(){d.a.post("/mod/clearAvi",e).then((function(){a.showAlert("Avatar cleared.","success"),t()})).catch(r)}},"Clear All User Content":{perm:"clearAllUserContent",args:[{label:"User Id",name:"userId",type:"text"}],run:function(){d.a.post("/mod/clearAllContent",e).then((function(){a.showAlert("User content cleared.","success"),t()})).catch(r)}},"Change Name":{perm:"changeName",args:[{label:"User Id",name:"userId",type:"text"},{label:"Name",name:"name",type:"text"}],run:function(){d.a.post("/mod/changeName",e).then((function(){a.showAlert("Name changed.","success"),t()})).catch(r)}},"Give Coins":{perm:"giveCoins",args:[{label:"User Id",name:"userId",type:"text"},{label:"Amount",name:"amount",type:"number"}],run:function(){d.a.post("/mod/giveCoins",e).then((function(){a.showAlert("Coins given.","success"),t()})).catch(r)}},"Break Game":{perm:"breakGame",args:[{label:"Game Id",name:"gameId",type:"text"}],run:function(){d.a.post("/mod/breakGame",e).then((function(){a.showAlert("Game broken.","success"),t()})).catch(r)}},"Toggle Featured Setup":{perm:"featureSetup",args:[{label:"Setup Id",name:"setupId",type:"text"}],run:function(){d.a.post("/setup/feature",e).then((function(){a.showAlert("Setup feature toggled.","success"),t()})).catch(r)}},"Clear All IPs":{perm:"clearAllIPs",args:[],run:function(){d.a.post("/mod/clearAllIPs",e).then((function(){a.showAlert("IPs cleared.","success"),t()})).catch(r)}},"Whitelist User":{perm:"whitelist",args:[{label:"User Id",name:"userId",type:"text"}],run:function(){d.a.post("/mod/whitelist",e).then((function(){a.showAlert("User whitelisted.","success"),t()})).catch(r)}},"Schedule Restart":{perm:"scheduleRestart",args:[{label:"When",name:"when",type:"text"}],run:function(){d.a.post("/mod/scheduleRestart",e).then((function(){a.showAlert("Restart scheduled.","success"),t()})).catch(r)}}}}(l,(function(){o(null),u({})})),f=Object(n.useContext)(O),h=I(),g=[],b=[];for(var y in m)f.perms[m[y].perm]&&g.push(y);return a&&(b=m[a].args.map((function(e){var t=e.label;return null!=e.default?t="".concat(t," (").concat(e.default,")"):e.optional&&(t="[".concat(t,"]")),r.a.createElement("input",{className:"arg",type:e.type,placeholder:t,maxLength:e.maxlength,onChange:function(t){return function(e,t,a){a&&(t=t.split(/ *, */));u(p()(l,Object(v.a)({},e,{$set:t})))}(e.name,t.target.value,e.isArray)},key:e.name})}))),r.a.createElement("div",{className:"mod-commands"},r.a.createElement("div",{className:"inputs"},r.a.createElement(ye,{options:g,value:a,setValue:o}),b),a&&r.a.createElement("div",{className:"btn btn-theme-sec submit",onClick:function(){var e,t=Object(T.a)(m[a].args);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(null==l[n.name])if(null!=n.default)l[n.name]=n.default;else if(!n.optional)return void h("Missing arguments.")}}catch(r){t.e(r)}finally{t.f()}m[a].run()}},"Run"))}function Kt(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Q,{links:[{text:"Forums",path:"/community/forums"},{text:"Users",path:"/community/users"},{text:"Moderation",path:"/community/moderation"}]}),r.a.createElement("div",{className:"inner-content"},r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/community/forums",render:function(){return r.a.createElement(Re,null)}}),r.a.createElement(u.b,{path:"/community/users",render:function(){return r.a.createElement(zt,null)}}),r.a.createElement(u.b,{path:"/community/moderation",render:function(){return r.a.createElement(Qt,null)}}),r.a.createElement(u.b,{render:function(){return r.a.createElement(u.a,{to:"/community/forums"})}}))))}var Xt=a(162),Zt=a(32);function ea(){ea=function(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",c=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function i(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{i({},"")}catch(C){i=function(e,t,a){return e[t]=a}}function l(e,t,a,r){var o=t&&t.prototype instanceof d?t:d,c=Object.create(o.prototype),s=new k(r||[]);return n(c,"_invoke",{value:w(e,a,s)}),c}function u(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(C){return{type:"throw",arg:C}}}e.wrap=l;var m={};function d(){}function f(){}function p(){}var h={};i(h,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==t&&a.call(g,o)&&(h=g);var b=p.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){i(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){var r;n(this,"_invoke",{value:function(n,o){function c(){return new t((function(r,c){!function n(r,o,c,s){var i=u(e[r],e,o);if("throw"!==i.type){var l=i.arg,m=l.value;return m&&"object"==typeof m&&a.call(m,"__await")?t.resolve(m.__await).then((function(e){n("next",e,c,s)}),(function(e){n("throw",e,c,s)})):t.resolve(m).then((function(e){l.value=e,c(l)}),(function(e){return n("throw",e,c,s)}))}s(i.arg)}(n,o,r,c)}))}return r=r?r.then(c,c):c()}})}function w(e,t,a){var n="suspendedStart";return function(r,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw o;return x()}for(a.method=r,a.arg=o;;){var c=a.delegate;if(c){var s=O(c,a);if(s){if(s===m)continue;return s}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var i=u(e,t,a);if("normal"===i.type){if(n=a.done?"completed":"suspendedYield",i.arg===m)continue;return{value:i.arg,done:a.done}}"throw"===i.type&&(n="completed",a.method="throw",a.arg=i.arg)}}}function O(e,t){var a=t.method,n=e.iterator[a];if(void 0===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),m;var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function S(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(b,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=i(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,i(e,s,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},y(E.prototype),i(E.prototype,c,(function(){return this})),e.AsyncIterator=E,e.async=function(t,a,n,r,o){void 0===o&&(o=Promise);var c=new E(l(t,a,n,r),o);return e.isGeneratorFunction(a)?c:c.next().then((function(e){return e.done?e.value:c.next()}))},y(b),i(b,s,"Generator"),i(b,o,(function(){return this})),i(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var n in t)a.push(n);return a.reverse(),function e(){for(;a.length;){var n=a.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=S,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(a,n){return c.type="throw",c.arg=e,t.next=a,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],c=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=a.call(o,"catchLoc"),i=a.call(o,"finallyLoc");if(s&&i){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!i)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var c=o?o.completion:{};return c.type=e,c.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(c)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),j(a),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;j(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:S(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),m}},e}function ta(){var e=Object(n.useState)(""),t=Object(i.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(""),u=Object(i.a)(c,2),m=u[0],f=u[1],p=Object(n.useState)(!0),h=Object(i.a)(p,2),v=h[0],g=h[1],b=Object(n.useState)(!1),y=Object(i.a)(b,2),E=y[0],w=y[1],O=I();function N(){return(N=Object(l.a)(ea().mark((function e(t){var n,r,o;return ea().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.preventDefault(),!v){e.next=4;break}return e.abrupt("return");case 4:return w(!0),n=Object(Zt.b)(),e.next=8,Object(Zt.d)(n,a,m);case 8:return r=e.sent,e.next=11,r.user.getIdToken(!0);case 11:o=e.sent,d.a.post("/auth",{idToken:o}).then((function(){window.location.reload()})).catch(O),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),w(!1),-1!=e.t0.message.indexOf("(auth/wrong-password)")?O("Incorrect password."):-1!=e.t0.message.indexOf("(auth/invalid-email)")?O("Invalid email."):-1!=e.t0.message.indexOf("(auth/user-not-found)")?O("Account does not exist."):-1!=e.t0.message.indexOf("(auth/too-many-requests)")?O("Too many login attempts on this account. Please try again later."):O("Error logging in.");case 19:case"end":return e.stop()}}),e,null,[[0,15]])})))).apply(this,arguments)}return Object(n.useEffect)((function(){document.title="Log In | BeyondMafia"}),[]),Object(n.useEffect)((function(){g(0==a.length||0==m.length)}),[a,m]),E?r.a.createElement(ne,null):r.a.createElement("div",{className:"span-panel main login"},r.a.createElement("form",{onSubmit:function(e){return N.apply(this,arguments)}},r.a.createElement("div",{className:"input-wrapper"},r.a.createElement("label",null,"Email"),r.a.createElement("input",{type:"text",value:a,onChange:function(e){return o(e.target.value)}})),r.a.createElement("div",{className:"input-wrapper"},r.a.createElement("label",null,"Password"),r.a.createElement("input",{type:"password",value:m,onChange:function(e){return f(e.target.value)}})),r.a.createElement("input",{className:"auth-btn ".concat(v?"disabled":""),type:"submit",value:"Log In"})),r.a.createElement("div",{className:"legal"},"By logging in you agree to follow our ",r.a.createElement(s.b,{to:"/legal/tos"},"Terms of Service "),"and accept our ",r.a.createElement(s.b,{to:"/legal/privacy"},"Privacy Policy"),"."))}function aa(){aa=function(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",c=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function i(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{i({},"")}catch(C){i=function(e,t,a){return e[t]=a}}function l(e,t,a,r){var o=t&&t.prototype instanceof d?t:d,c=Object.create(o.prototype),s=new k(r||[]);return n(c,"_invoke",{value:w(e,a,s)}),c}function u(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(C){return{type:"throw",arg:C}}}e.wrap=l;var m={};function d(){}function f(){}function p(){}var h={};i(h,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==t&&a.call(g,o)&&(h=g);var b=p.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){i(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){var r;n(this,"_invoke",{value:function(n,o){function c(){return new t((function(r,c){!function n(r,o,c,s){var i=u(e[r],e,o);if("throw"!==i.type){var l=i.arg,m=l.value;return m&&"object"==typeof m&&a.call(m,"__await")?t.resolve(m.__await).then((function(e){n("next",e,c,s)}),(function(e){n("throw",e,c,s)})):t.resolve(m).then((function(e){l.value=e,c(l)}),(function(e){return n("throw",e,c,s)}))}s(i.arg)}(n,o,r,c)}))}return r=r?r.then(c,c):c()}})}function w(e,t,a){var n="suspendedStart";return function(r,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw o;return x()}for(a.method=r,a.arg=o;;){var c=a.delegate;if(c){var s=O(c,a);if(s){if(s===m)continue;return s}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var i=u(e,t,a);if("normal"===i.type){if(n=a.done?"completed":"suspendedYield",i.arg===m)continue;return{value:i.arg,done:a.done}}"throw"===i.type&&(n="completed",a.method="throw",a.arg=i.arg)}}}function O(e,t){var a=t.method,n=e.iterator[a];if(void 0===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),m;var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function S(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(b,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=i(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,i(e,s,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},y(E.prototype),i(E.prototype,c,(function(){return this})),e.AsyncIterator=E,e.async=function(t,a,n,r,o){void 0===o&&(o=Promise);var c=new E(l(t,a,n,r),o);return e.isGeneratorFunction(a)?c:c.next().then((function(e){return e.done?e.value:c.next()}))},y(b),i(b,s,"Generator"),i(b,o,(function(){return this})),i(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var n in t)a.push(n);return a.reverse(),function e(){for(;a.length;){var n=a.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=S,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(a,n){return c.type="throw",c.arg=e,t.next=a,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],c=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=a.call(o,"catchLoc"),i=a.call(o,"finallyLoc");if(s&&i){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!i)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var c=o?o.completion:{};return c.type=e,c.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(c)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),j(a),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;j(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:S(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),m}},e}function na(){var e=Object(n.useState)(""),t=Object(i.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(""),u=Object(i.a)(c,2),m=u[0],f=u[1],p=Object(n.useState)(""),h=Object(i.a)(p,2),v=h[0],g=h[1],b=Object(n.useState)(!0),y=Object(i.a)(b,2),E=y[0],w=y[1],O=Object(n.useState)(!1),N=Object(i.a)(O,2),j=N[0],k=N[1],S=I();function x(){return(x=Object(l.a)(aa().mark((function e(t){var n,r,o;return aa().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.preventDefault(),!E){e.next=4;break}return e.abrupt("return");case 4:return k(!0),n=Object(Zt.b)(),e.next=8,Object(Zt.a)(n,a,m);case 8:return r=e.sent,e.next=11,r.user.getIdToken(!0);case 11:o=e.sent,d.a.post("/auth",{idToken:o}).then((function(){window.location.reload()})).catch(S),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),k(!1),-1!=e.t0.message.indexOf("(auth/invalid-email)")?S("Invalid email."):-1!=e.t0.message.indexOf("(auth/weak-password)")?S("Password should be at least 6 characters."):-1!=e.t0.message.indexOf("(auth/email-already-in-use)")?S("Email already in use."):S("Error signing up.");case 19:case"end":return e.stop()}}),e,null,[[0,15]])})))).apply(this,arguments)}return Object(n.useEffect)((function(){document.title="Sign Up | BeyondMafia"}),[]),Object(n.useEffect)((function(){w(0==a.length||0==m.length||m!=v)}),[a,m,v]),j?r.a.createElement(ne,null):r.a.createElement("div",{className:"span-panel main login"},r.a.createElement("form",{onSubmit:function(e){return x.apply(this,arguments)}},r.a.createElement("div",{className:"input-wrapper"},r.a.createElement("label",null,"Email"),r.a.createElement("input",{type:"text",value:a,onChange:function(e){return o(e.target.value)}})),r.a.createElement("div",{className:"input-wrapper"},r.a.createElement("label",null,"Password"),r.a.createElement("input",{type:"password",value:m,onChange:function(e){return f(e.target.value)}})),r.a.createElement("div",{className:"input-wrapper"},r.a.createElement("label",null,"Confirm Password"),r.a.createElement("input",{type:"password",value:v,onChange:function(e){return g(e.target.value)}})),r.a.createElement("input",{className:"auth-btn ".concat(E?"disabled":""),type:"submit",value:"Sign Up"})),r.a.createElement("div",{className:"legal"},"By signing up you agree to follow our ",r.a.createElement(s.b,{to:"/legal/tos"},"Terms of Service "),"and accept our ",r.a.createElement(s.b,{to:"/legal/privacy"},"Privacy Policy"),", and that you are at least 13 years of age."))}a(444);function ra(){var e=Object(n.useContext)(O),t=Object(u.h)();return Object(n.useEffect)((function(){var e=new URLSearchParams(t.search);e.get("ref")&&window.localStorage.setItem("referrer",e.get("ref"));Object(Xt.a)({apiKey:"AIzaSyAri_HCd4q3czOs4QMhvDwmA0fIqbEobAc",authDomain:"arcmafia.firebaseapp.com",projectId:"arcmafia",storageBucket:"arcmafia.appspot.com",messagingSenderId:"227409737941",appId:"1:227409737941:web:e6bfd7eed367654e074a5c",measurementId:"G-LG2M9T058H"}),Object(Zt.b)().setPersistence(Zt.c)}),[]),e.loaded?e.loggedIn?r.a.createElement(u.a,{to:"/play"}):r.a.createElement(r.a.Fragment,null,r.a.createElement(Q,{links:[{text:"Log In",path:"/auth/login",exact:!0},{text:"Sign Up",path:"/auth/signup",exact:!0}]}),r.a.createElement("div",{className:"auth inner-content"},r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/auth/login"},r.a.createElement(ta,null)),r.a.createElement(u.b,{exact:!0,path:"/auth/signup"},r.a.createElement(na,null)),r.a.createElement(u.b,{render:function(){return r.a.createElement(u.a,{to:"/auth/login"})}})))):r.a.createElement(ne,null)}function oa(){return Object(n.useEffect)((function(){document.title="Privacy Policy | BeyondMafia"}),[]),r.a.createElement("div",{className:"span-panel main legal"},r.a.createElement("h1",null,"Privacy Policy of BeyondMafia"),r.a.createElement("p",null,"BeyondMafia operates the BeyondMafia.org website, which provides the SERVICE."),r.a.createElement("p",null,"This page is used to inform website visitors regarding our policies with the collection, use, and disclosure of Personal Information if anyone decided to use our Service, the BeyondMafia website."),r.a.createElement("p",null,"If you choose to use our Service, then you agree to the collection and use of information in relation with this policy. The Personal Information that we collect are used for providing and improving the Service. We will not use or share your information with anyone except as described in this Privacy Policy."),"   ",r.a.createElement("p",null,"The terms used in this Privacy Policy have the same meanings as in our Terms and Conditions, which is accessible at BeyondMafia.org, unless otherwise defined in this Privacy Policy. Our Privacy Policy was created with the help of the ",r.a.createElement("a",{href:"https://www.privacypolicytemplate.net"},"Privacy Policy Template")," and the ",r.a.createElement("a",{href:"https://www.disclaimer-template.net"},"Disclaimer Template"),"."),r.a.createElement("h2",null,"Information Collection and Use"),r.a.createElement("p",null,"For a better experience while using our Service, we may require you to provide us with certain personally identifiable information, including but not limited to your email address and usernames on other services. You may also voluntarily upload any of your own personal information you wish for your profile, including but not limited to photos and textual data."),r.a.createElement("h2",null,"Log Data"),r.a.createElement("p",null,'We want to inform you that whenever you visit our Service, we collect information that your browser sends to us that is called Log Data. This Log Data may include information such as your computer\u2019s Internet Protocol ("IP") address, browser version, pages of our Service that you visit, the time and date of your visit, the time spent on those pages, and other statistics.'),r.a.createElement("h2",null,"Cookies"),r.a.createElement("p",null,"Cookies are files with small amount of data that is commonly used an anonymous unique identifier. These are sent to your browser from the website that you visit and are stored on your computer\u2019s hard drive."),r.a.createElement("p",null,'Our website uses these "cookies" to collection information and to improve our Service. You have the option to either accept or refuse these cookies by either loggin in or choosing not to log in. If you choose to refuse our cookies, you may not be able to use some portions of our Service, which includes any features that require a user to be signed in.'),r.a.createElement("h2",null,"Service Providers"),r.a.createElement("p",null,"We may employ third-party companies and individuals due to the following reasons:"),r.a.createElement("ul",null,r.a.createElement("li",null,"To facilitate our Service;"),r.a.createElement("li",null,"To provide the Service on our behalf;"),r.a.createElement("li",null,"To perform Service-related services; or"),r.a.createElement("li",null,"To assist us in analyzing how our Service is used.")),r.a.createElement("p",null,"We want to inform our Service users that these third parties have access to your Personal Information. The reason is to perform the tasks assigned to them on our behalf. However, they are obligated not to disclose or use the information for any other purpose."),r.a.createElement("h2",null,"Security"),r.a.createElement("p",null,"We value your trust in providing us your Personal Information, thus we are striving to use commercially acceptable means of protecting it. But remember that no method of transmission over the internet, or method of electronic storage is 100% secure and reliable, and we cannot guarantee its absolute security."),r.a.createElement("h2",null,"Links to Other Sites"),r.a.createElement("p",null,"Our Service may contain links to other sites. If you click on a third-party link, you will be directed to that site. Note that these external sites are not operated by us. Therefore, we strongly advise you to review the Privacy Policy of these websites. We have no control over, and assume no responsibility for the content, privacy policies, or practices of any third-party sites or services."),r.a.createElement("p",null,"Children\u2019s Privacy"),r.a.createElement("p",null,"Our Services do not address anyone under the age of 13. We do not knowingly collect personal identifiable information from children under 13. In the case we discover that a child under 13 has provided us with personal information, we immediately delete this from our servers. If you are a parent or guardian and you are aware that your child has provided us with personal information, please contact us so that we will be able to do necessary actions."),r.a.createElement("h2",null,"Changes to This Privacy Policy"),r.a.createElement("p",null,"We may update our Privacy Policy from time to time. Thus, we advise you to review this page periodically for any changes. We will notify you of any changes by posting the new Privacy Policy on this page. These changes are effective immediately, after they are posted on this page."),r.a.createElement("h2",null,"Contact Us"),r.a.createElement("p",null,"If you have any questions or suggestions about our Privacy Policy, do not hesitate to contact us."))}function ca(){return Object(n.useEffect)((function(){document.title="Terms of Service | BeyondMafia"}),[]),r.a.createElement("div",{className:"span-panel main legal"},r.a.createElement("h1",null,"BeyondMafia Terms and Conditions of Use"),r.a.createElement("h2",null,"1. Terms"),r.a.createElement("p",null,"By accessing this Website, accessible from BeyondMafia.org, you are agreeing to be bound by these Website Terms and Conditions of Use and agree that you are responsible for the agreement with any applicable local laws. If you disagree with any of these terms, you are prohibited from accessing this site. The materials contained in this Website are protected by copyright and trade mark law. These Terms of Service has been created with the help of the ",r.a.createElement("a",{href:"https://www.termsofservicegenerator.net"},"Terms of Service Generator")," and the ",r.a.createElement("a",{href:"https://www.termsconditionsexample.com"},"Terms & Conditions Example"),"."),r.a.createElement("h2",null,"2. Use License"),r.a.createElement("p",null,"Permission is granted to temporarily download one copy of the materials on BeyondMafia's Website for personal, non-commercial transitory viewing only. This is the grant of a license, not a transfer of title, and under this license you may not:"),r.a.createElement("ul",null,r.a.createElement("li",null,"modify or copy the materials;"),r.a.createElement("li",null,"use the materials for any commercial purpose or for any public display;"),r.a.createElement("li",null,"attempt to reverse engineer any software contained on BeyondMafia's Website;"),r.a.createElement("li",null,"remove any copyright or other proprietary notations from the materials; or"),r.a.createElement("li",null,'transferring the materials to another person or "mirror" the materials on any other server.')),r.a.createElement("p",null,"This will let BeyondMafia to terminate upon violations of any of these restrictions. Upon termination, your viewing right will also be terminated and you should destroy any downloaded materials in your possession whether it is printed or electronic format."),r.a.createElement("h2",null,"3. Disclaimer"),r.a.createElement("p",null,'All the materials on BeyondMafia\u2019s Website are provided "as is". BeyondMafia makes no warranties, may it be expressed or implied, therefore negates all other warranties. Furthermore, BeyondMafia does not make any representations concerning the accuracy or reliability of the use of the materials on its Website or otherwise relating to such materials or any sites linked to this Website.'),r.a.createElement("h2",null,"4. Limitations"),r.a.createElement("p",null,"BeyondMafia or its suppliers will not be hold accountable for any damages that will arise with the use or inability to use the materials on BeyondMafia\u2019s Website, even if BeyondMafia or an authorize representative of this Website has been notified, orally or written, of the possibility of such damage. Some jurisdiction does not allow limitations on implied warranties or limitations of liability for incidental damages, these limitations may not apply to you."),r.a.createElement("h2",null,"5. Revisions and Errata"),r.a.createElement("p",null,"The materials appearing on BeyondMafia\u2019s Website may include technical, typographical, or photographic errors. BeyondMafia will not promise that any of the materials in this Website are accurate, complete, or current. BeyondMafia may change the materials contained on its Website at any time without notice. BeyondMafia does not make any commitment to update the materials."),r.a.createElement("h2",null,"6. Links"),r.a.createElement("p",null,"BeyondMafia has not reviewed all of the sites linked to its Website and is not responsible for the contents of any such linked site. The presence of any link does not imply endorsement by BeyondMafia of the site. The use of any linked website is at the user\u2019s own risk."),r.a.createElement("h2",null,"7. Site Terms of Use Modifications"),r.a.createElement("p",null,"BeyondMafia may revise these Terms of Use for its Website at any time without prior notice. By using this Website, you are agreeing to be bound by the current version of these Terms and Conditions of Use."),r.a.createElement("h2",null,"8. Your Privacy"),r.a.createElement("p",null,"Please read ",r.a.createElement("a",{href:"/legal/privacy"},"our Privacy Policy"),"."),r.a.createElement("h2",null,"9. Governing Law"),r.a.createElement("p",null,"Any claim related to BeyondMafia's Website shall be governed by the laws of us without regards to its conflict of law provisions."))}a(445);function sa(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Q,{links:[{text:"Terms of Service",path:"/legal/tos",exact:!0},{text:"Privacy Policy",path:"/legal/privacy",exact:!0}]}),r.a.createElement("div",{className:"inner-content"},r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/legal/tos",render:function(){return r.a.createElement(ca,null)}}),r.a.createElement(u.b,{exact:!0,path:"/legal/privacy",render:function(){return r.a.createElement(oa,null)}}),r.a.createElement(u.b,{render:function(){return r.a.createElement(u.a,{to:"/legal/tos"})}}))))}a(446);function ia(){var e=Object(n.useContext)(j),t=Object(n.useRef)(),a=Object(n.useRef)();return G([{current:e.boundingEl},t],(function(){e.loadingRef.current||(e.setVisible(!1),e.setBoundingEl(null))})),Object(n.useLayoutEffect)((function(){if(e.visible){var n=e.boundingEl.getBoundingClientRect(),r=t.current.getBoundingClientRect(),o=n.left+n.width,c=n.top-10+n.height/2+window.scrollY,s=n.left+n.width+10,i=n.top-r.height/2+n.height/2+window.scrollY,l=window.innerWidth-(s+r.width);i<window.scrollY&&(i=window.scrollY),l<0?s+l<0&&(l-=s+l):l=0,s+=l,o+=l,a.current.style.left=o+"px",a.current.style.top=c+"px",a.current.style.visibility="visible",t.current.style.top=i+"px",t.current.style.left=s+"px",t.current.style.visibility="visible"}})),e.visible&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"triangle triangle-left",ref:a}),r.a.createElement("div",{className:"popover-window",ref:t},r.a.createElement("div",{className:"popover-title"},e.title),!e.loading&&r.a.createElement("div",{className:"popover-content"},e.content)))}function la(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),o=a[0],c=a[1],s=Object(n.useState)(),l=Object(i.a)(s,2),u=l[0],m=l[1],f=Object(n.useState)(""),p=Object(i.a)(f,2),h=p[0],v=p[1],g=Object(n.useState)(""),b=Object(i.a)(g,2),y=b[0],w=b[1],O=Object(n.useState)(!1),N=Object(i.a)(O,2),j=N[0],k=N[1],S=Object(n.useRef)(),x=I(e);function C(e,t){m(e),v(t),k(!0),c(!0),S.current=!0}function L(t,a){switch(a){case"setup":t=function(e,t){var a=[];if(a.push(r.a.createElement(ua,{title:"ID",content:e.id,key:-2})),e.creator){var n=r.a.createElement(xe,{small:!0,id:e.creator.id,name:e.creator.name,avatar:e.creator.avatar});a.push(r.a.createElement(ua,{title:"Created By",content:n,key:-1}))}a.push(r.a.createElement(ua,{title:"Players",content:e.total,key:0}));var o=[];o.push(r.a.createElement("div",{key:0},e.whispers?"Yes":"No")),e.whispers&&o.push(r.a.createElement("div",{key:1},e.leakPercentage,"% leak rate"));switch(a.push(r.a.createElement(ua,{title:"Whispers",content:o,key:1})),a.push(r.a.createElement(ua,{title:"Must Act",content:e.mustAct?"Yes":"No",key:2})),e.gameType){case"Mafia":a.push(r.a.createElement(ua,{title:"Starting State",content:r.a.createElement(ft,{state:e.startState}),key:3})),a.push(r.a.createElement(ua,{title:"Dawn",content:e.dawn?"Yes":"No",key:"dawn"})),a.push(r.a.createElement(ua,{title:"Last Will",content:e.lastWill?"Yes":"No",key:4})),a.push(r.a.createElement(ua,{title:"No Reveal",content:e.noReveal?"Yes":"No",key:5})),a.push(r.a.createElement(ua,{title:"Votes Invisible",content:e.votesInvisible?"Yes":"No",key:6}));break;case"Split Decision":a.push(r.a.createElement(ua,{title:"Initial Swap Amount",content:e.swapAmt,key:3})),a.push(r.a.createElement(ua,{title:"Round Amount",content:e.roundAmt,key:4}));break;case"Resistance":a.push(r.a.createElement(ua,{title:"First Team Size",content:e.firstTeamSize,key:3})),a.push(r.a.createElement(ua,{title:"Last Team Size",content:e.lastTeamSize,key:4})),a.push(r.a.createElement(ua,{title:"Number of Missions",content:e.numMissions,key:5})),a.push(r.a.createElement(ua,{title:"Team Formation Attempts",content:e.teamFailLimit,key:6}));break;case"One Night":a.push(r.a.createElement(ua,{title:"Votes Invisible",content:e.votesInvisible?"Yes":"No",key:3})),a.push(r.a.createElement(ua,{title:"Excess Roles",content:e.excessRoles,key:4}))}if(e.closed){a.push(r.a.createElement(ua,{title:"Unique Roles",content:e.unique?"Yes":"No",key:7}));var c=e.roles[0],s={};for(var i in c){var l,u=i.split(":")[0],m=Object(T.a)(t[e.gameType]);try{for(m.s();!(l=m.n()).done;){var d=l.value;if(d.name==u){var f=d.alignment;s[f]||(s[f]={}),s[f][i]=c[i]}}}catch(y){m.e(y)}finally{m.f()}}for(var p in s)a.push(r.a.createElement(ua,{title:"".concat(p," roles"),content:r.a.createElement(mt,{roles:s[p],gameType:e.gameType}),key:p}))}else{var h=[],v=e.roles.length>1?"Role Sets":"Roles";for(var g in e.roles){var b=e.roles[g];h.push(r.a.createElement(mt,{roles:b,gameType:e.gameType,key:g}))}a.push(r.a.createElement(ua,{title:v,content:h,key:7}))}return a}(t,e.roles);break;case"role":t=function(e){var t=[];t.push(r.a.createElement(ua,{title:"Alignment",content:e.alignment,key:0}));var a=[];for(var n in e.description)a.push(r.a.createElement("li",{key:n},e.description[n]));return t.push(r.a.createElement(ua,{title:"Description",content:r.a.createElement("ul",null,a),key:1})),t}(t);break;case"game":t=function(e){var t=[];e.settings.scheduled&&t.push(r.a.createElement(ua,{title:"Scheduled For",content:new Date(e.settings.scheduled).toLocaleString(),key:-1}));for(var a=[],n=0;n<e.players.length;n++)a.push(r.a.createElement(xe,{small:!0,id:e.players[n].id,name:e.players[n].name,avatar:e.players[n].avatar,key:e.players[n].id}));for(;a.length<e.totalPlayers;)a.push(r.a.createElement(xe,{small:!0,name:"[Guest]",key:a.length}));t.push(r.a.createElement(ua,{title:"Players",content:a,key:0}));var o,c=[],s=Object(T.a)(E[e.type]);try{for(s.s();!(o=s.n()).done;){var i=o.value;c.push(r.a.createElement("div",{key:i},i,": ",r.a.createElement(D,{millisec:e.settings.stateLengths[i]})))}}catch(l){s.e(l)}finally{s.f()}t.push(r.a.createElement(ua,{title:"State Lengths",content:c,key:1})),t.push(r.a.createElement(ua,{title:"Ranked",content:e.settings.ranked?"Yes":"No",key:2})),t.push(r.a.createElement(ua,{title:"Spectating",content:e.settings.spectating?"Yes":"No",key:3})),t.push(r.a.createElement(ua,{title:"Guests Allowed",content:e.settings.guests?"Yes":"No",key:4})),e.type;e.createTime&&t.push(r.a.createElement(ua,{title:"Created At",content:new Date(e.createTime).toLocaleString(),key:5}));e.startTime&&t.push(r.a.createElement(ua,{title:"Started At",content:new Date(e.startTime).toLocaleString(),key:6}));e.endTime&&t.push(r.a.createElement(ua,{title:"Ended At",content:new Date(e.endTime).toLocaleString(),key:7}));return t}(t)}w(t),k(!1)}function A(e,t,a,n,r){C(a,n),d.a.get(e).then((function(e){r&&r(e.data),S.current=!1,L(e.data,t)})).catch(x)}return{visible:o,setVisible:c,boundingEl:u,setBoundingEl:m,title:h,setTitle:v,content:y,setContent:w,loading:j,setLoading:k,onClick:function(e,t,a,n,r){a==u?(c(!1),m(null)):A(e,t,a,n,r)},open:C,ready:L,load:A,loadingRef:S}}function ua(e){return r.a.createElement("div",{className:"info-row"},r.a.createElement("div",{className:"title"},e.title),r.a.createElement("div",{className:"content"},e.content))}a(447);function ma(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(0),s=Object(i.a)(c,2),l=s[0],u=s[1],m=Object(n.useState)(""),f=Object(i.a)(m,2),g=f[0],b=f[1],y=Object(n.useState)({}),E=Object(i.a)(y,2),w=E[0],N=E[1],j=Object(n.useReducer)((function(e,t){var a=e;switch(t.type){case"set":var n,r=t.chatInfo.notifs,o=0,c={rooms:0,directs:0},s={},i=Object(T.a)(r);try{for(i.s();!(n=i.n()).done;){var l=n.value;s[l.channelId]||(s[l.channelId]=0);var u=32==l.channelId.length?"directs":"rooms";o+=1,c[u]+=1,s[l.channelId]+=1}}catch(w){i.e(w)}finally{i.f()}a=Object(h.a)(Object(h.a)({},t.chatInfo),{},{notifs:e.notifs}),a=p()(a,{notifs:{all:{$set:o},byChannelType:{$set:c},byChannel:{$set:s}}});break;case"directs":a=p()(e,{directs:{$unshift:[t.channel]}});break;case"users":a=p()(e,{users:{$set:t.users}});break;case"remove":var m=e[t.channelType];m=m.filter((function(e){return e.id!=t.channelId})),a=p()(e,Object(v.a)({},t.channelType,{$set:m}));break;case"date":var d=e.directs.map((function(e){return e.id==t.channelId&&(e.lastMessageDate=t.date),e}));a=p()(e,{directs:{$set:d}});break;case"addNotif":var f=32==t.channelId.length?"directs":"rooms",g=e.notifs.all+1,b=e.notifs[f]?e.notifs[f]+1:1,y=e.notifs[t.channelId]?e.notifs[t.channelId]+1:1;a=p()(e,{notifs:{all:{$set:g},byChannelType:Object(v.a)({},f,{$set:b}),byChannel:Object(v.a)({},t.channelId,{$set:y})}});break;case"readNotifs":var E=e.notifs.byChannel[t.channelId]||0;f=32==t.channelId.length?"directs":"rooms",g=e.notifs.all-E,b=e.notifs.byChannelType[f]-E,a=p()(e,{notifs:{all:{$set:g},byChannelType:Object(v.a)({},f,{$set:b}),byChannel:Object(v.a)({},t.channelId,{$set:0})}})}return a}),{rooms:[],directs:[],users:[],notifs:{all:0,byChannelType:{},byChannel:{}}}),k=Object(i.a)(j,2),S=k[0],x=k[1],C=Object(n.useState)("rooms"),L=Object(i.a)(C,2),A=L[0],M=L[1],P=Object(n.useState)(),R=Object(i.a)(P,2),F=R[0],D=R[1],V=Object(n.useReducer)((function(e,t){var a=e;switch(t.type){case"set":a=t.channel;break;case"message":if(t.message.channel!=e.id)break;a=p()(e,{messages:{$push:[t.message]}});break;case"deleteMessage":var n=-1;for(var r in e.messages)if(e.messages[r].id==t.messageId){n=r;break}-1!=n&&(a=p()(e,{messages:{$splice:[[n,1]]}}));break;case"oldMessages":a=p()(e,{messages:{$unshift:t.messages}});break;case"clear":a={messages:[]}}return a}),{messages:[]}),U=Object(i.a)(V,2),G=U[0],W=U[1],_=Object(n.useState)({}),$=Object(i.a)(_,2),H=$[0],q=$[1],Y=Object(n.useState)(""),z=Object(i.a)(Y,2),Q=z[0],J=z[1],K=Object(n.useState)(!0),X=Object(i.a)(K,2),Z=X[0],ee=X[1],te=Object(n.useState)(""),ae=Object(i.a)(te,2),ne=ae[0],re=ae[1],oe=Object(n.useRef)(),ce=Object(n.useRef)(),se=Object(n.useContext)(O),ie=I();function le(e){M(e),"users"==e&&w.send("getUsers",ne)}Object(n.useLayoutEffect)((function(){return function(){if(oe.current)if(null==ce.current)ce.current=oe.current.scrollHeight;else if(ce.current!=oe.current.scrollHeight){if(0==oe.current.scrollTop){var e=oe.current.scrollHeight*(1-ce.current/oe.current.scrollHeight);oe.current.scrollTop=e-5}ce.current=oe.current.scrollHeight}Z&&oe.current&&(oe.current.scrollTop=oe.current.scrollHeight)}()})),Object(n.useEffect)((function(){if(g){var e;e="".concat("ws","://").concat("localhost",":2999");var t=new Et(e);return t.on("connected",(function(){return u(l+1)})),t.on("disconnected",(function(){return u(l-1)})),N(t),function(){t&&t.clear()}}}),[g]),Object(n.useEffect)((function(){1==w.readyState?(w.send("auth",g),w.on("chatInfo",(function(e){if(x({type:"set",chatInfo:e}),e.rooms&&e.rooms.length>0&&!F){var t=e.rooms[0].id;D(t)}})),w.on("channel",(function(e){W({type:"set",channel:e})})),w.on("message",(function(e){W({type:"message",message:e})})),w.on("oldMessages",(function(e){W({type:"oldMessages",messages:e,messageListRef:oe})})),w.on("users",(function(e){x({type:"users",users:e})})),w.on("newDirectChannel",(function(e){x({type:"directs",channel:e.channel}),e.focus&&(M("directs"),D(e.channel.id),w.send("getChannel",e.channel.id))})),w.on("openDM",(function(e){M("directs"),D(e),w.send("getChannel",e)})),w.on("dateUpdate",(function(e){x({type:"date",channelId:e.channel,date:e.date})})),w.on("newNotif",(function(e){x({type:"addNotif",channelId:e.notif.channelId}),document.hidden&&-1==document.title.indexOf("\ud83d\udd34")&&(document.title=document.title+"\ud83d\udd34")})),w.on("messageDeleted",(function(e){W({type:"deleteMessage",messageId:e})})),w.on("error",(function(e){ie(e)}))):null!=w.readyState&&3!=w.readyState||d.a.get("/chat/connect").then((function(e){b(e.data)})).catch(ie)}),[l]),Object(n.useEffect)((function(){G.id&&(S.notifs.byChannel[G.id]&&w.send("readNotifsInChannel",G.id),x({type:"readNotifs",channelId:G.id}))}),[G]);var ue=S[A];"directs"==A&&(ue=ue.sort(pa)),ue=ue.reduce((function(e,t){if("users"==A&&t.id==se.id)return e;var a="channel";return("users"!=A&&t.id==F||"users"==A&&H[t.id])&&(a+=" sel"),e.push(r.a.createElement(B,{className:a,key:t.id,notifCount:S.notifs.byChannel[t.id],onClick:function(){return e=t.id,void("users"!=A?(w.send("getChannel",e),D(e),ee(!0)):H[e]?q(p()(H,{$unset:[e]})):q(p()(H,Object(v.a)({},e,{$set:!0}))));var e}},r.a.createElement(fa,{short:!0,channelType:A,channel:t,user:se}))),e}),[]);var me=G.messages.map((function(e){return r.a.createElement(da,{message:e,socket:w,key:e.id})}));return g&&r.a.createElement(B,{className:"chat-wrapper",notifCount:S.notifs.all},r.a.createElement("div",{className:"top-bar",onClick:function(){o(!a),ee(!0),a?w.send("closedChat"):(F&&w.send("getChannel",F),F&&(S.notifs.byChannel[F]&&w.send("readNotifsInChannel",F),x({type:"readNotifs",channelId:F})))}},r.a.createElement("i",{className:"fas fa-comment"}),r.a.createElement("div",{className:"label"},"Chat")),a&&r.a.createElement("div",{className:"window"},r.a.createElement("div",{className:"left-panel"},r.a.createElement("div",{className:"channel-type-nav"},r.a.createElement(B,{className:"channel-type ".concat("rooms"==A?"sel":""),notifCount:S.notifs.byChannelType.rooms,onClick:function(){return le("rooms")}},"Rooms"),r.a.createElement(B,{className:"channel-type ".concat("directs"==A?"sel":""),notifCount:S.notifs.byChannelType.directs,onClick:function(){return le("directs")}},"Directs"),r.a.createElement("div",{className:"channel-type ".concat("users"==A?"sel":""),onClick:function(){return le("users")}},"Users")),"users"==A&&r.a.createElement("input",{className:"user-search",value:ne,placeholder:"Search",onChange:function(e){var t=e.target.value;re(t),w.send("getUsers",t)}}),r.a.createElement("div",{className:"channel-list"},ue),"users"==A&&Object.keys(H).length>0&&r.a.createElement("div",{className:"create-dm-btn btn btn-theme",onClick:function(){var e=Object.keys(H);w.send("newDMChannel",e),q({})}},r.a.createElement("i",{className:"fas fa-plus"}),"Create DM (",Object.keys(H).length,")")),r.a.createElement("div",{className:"right-panel"},G.id&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"channel-top"},r.a.createElement("div",{className:"channel-name"},r.a.createElement(fa,{channelType:G.public?"rooms":"directs",channel:G,user:se})),!G.public&&r.a.createElement("i",{className:"close-dm fas fa-times",onClick:function(){return e=G.id,w.send("closeDM",e),D(null),W({type:"clear"}),void x({type:"remove",channelType:A,channelId:e});var e}})),r.a.createElement("div",{className:"channel-messages",ref:oe,onScroll:function(){var e=oe.current;Math.round(e.scrollTop+e.clientHeight)>=Math.round(e.scrollHeight)?ee(!0):(ee(!1),0==e.scrollTop&&w.send("getOldMessages",G.messages[0].date))}},me),r.a.createElement("div",{className:"channel-input-wrapper"},r.a.createElement("input",{className:"channel-input",value:Q,maxLength:240,onChange:function(e){return J(e.target.value)},onKeyPress:function(e){if("Enter"==e.key&&Q.length){var t=e.target.value;w.send("sendMessage",t),J(""),ee(!0)}}}))))))}function da(e){var t=e.message,a=e.socket,o=Object(n.useState)(!1),c=Object(i.a)(o,2),s=c[0],l=c[1],u=Object(n.useState)({}),m=Object(i.a)(u,2),d=m[0],f=m[1],p=Object(n.useRef)(),h=Object(n.useRef)(),v=Object(n.useContext)(O),g=t.sender.id==v.id,b=Date.now()-t.date;return G(p,(function(){return l(!1)})),Object(n.useEffect)((function(){if(h.current){var e=p.current.getBoundingClientRect();h.current.style.top=d.y-e.top+"px",g?h.current.style.right=e.right-d.x+"px":h.current.style.left=d.x-e.left+"px",h.current.style.visibility="visible"}}),[d]),r.a.createElement("div",{className:"message ".concat(g?"self":"")},r.a.createElement("div",{className:"info"},!g&&r.a.createElement(xe,{small:!0,id:t.sender.id,name:t.sender.name,avatar:t.sender.avatar,color:t.sender.settings&&t.sender.settings.nameColor}),b>6e4&&r.a.createElement("div",{className:"timestamp"},r.a.createElement(D,{millisec:b,suffix:" ago"}))),r.a.createElement("div",{className:"content",style:t.sender.settings&&t.sender.settings.textColor?{color:t.sender.settings.textColor}:{},onContextMenu:function(e){"contextmenu"==e.type&&(e.preventDefault(),l(!0),f({x:e.clientX,y:e.clientY}))},ref:p},r.a.createElement(V,{text:t.content,filterProfanity:!0,linkify:!0,emotify:!0})),s&&(v.id==t.sender.id||v.perms.deleteChatMessage)&&r.a.createElement("div",{className:"context",ref:h},r.a.createElement("div",{className:"item",onClick:function(){a.send("deleteMessage",t.id)}},"Delete")))}function fa(e){var t=e.channelType,a=e.channel,n=e.user,o=e.short;switch(t){case"rooms":return a.name;case"directs":if(o){var c=a.members.filter((function(e){return e.id!=n.id})).map((function(e){return e.name})),s=c.join(", ");return c.length>1&&s.length>20&&(s=s.slice(0,17)+"..."),s}return a.members.filter((function(e){return e.id!=n.id})).map((function(e){return r.a.createElement(xe,{small:!0,id:e.id,name:e.name,avatar:e.avatar,key:e.id})}));case"users":return r.a.createElement(r.a.Fragment,null,r.a.createElement(xe,{small:!0,noLink:!0,id:a.id,name:a.name,avatar:a.avatar}),r.a.createElement(Ce,{status:a.status}))}}function pa(e,t){return t.lastMessageDate-e.lastMessageDate}a(448);function ha(){ha=function(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",c=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function i(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{i({},"")}catch(C){i=function(e,t,a){return e[t]=a}}function l(e,t,a,r){var o=t&&t.prototype instanceof d?t:d,c=Object.create(o.prototype),s=new k(r||[]);return n(c,"_invoke",{value:w(e,a,s)}),c}function u(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(C){return{type:"throw",arg:C}}}e.wrap=l;var m={};function d(){}function f(){}function p(){}var h={};i(h,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==t&&a.call(g,o)&&(h=g);var b=p.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){i(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){var r;n(this,"_invoke",{value:function(n,o){function c(){return new t((function(r,c){!function n(r,o,c,s){var i=u(e[r],e,o);if("throw"!==i.type){var l=i.arg,m=l.value;return m&&"object"==typeof m&&a.call(m,"__await")?t.resolve(m.__await).then((function(e){n("next",e,c,s)}),(function(e){n("throw",e,c,s)})):t.resolve(m).then((function(e){l.value=e,c(l)}),(function(e){return n("throw",e,c,s)}))}s(i.arg)}(n,o,r,c)}))}return r=r?r.then(c,c):c()}})}function w(e,t,a){var n="suspendedStart";return function(r,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw o;return x()}for(a.method=r,a.arg=o;;){var c=a.delegate;if(c){var s=O(c,a);if(s){if(s===m)continue;return s}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var i=u(e,t,a);if("normal"===i.type){if(n=a.done?"completed":"suspendedYield",i.arg===m)continue;return{value:i.arg,done:a.done}}"throw"===i.type&&(n="completed",a.method="throw",a.arg=i.arg)}}}function O(e,t){var a=t.method,n=e.iterator[a];if(void 0===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),m;var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function S(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(b,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=i(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,i(e,s,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},y(E.prototype),i(E.prototype,c,(function(){return this})),e.AsyncIterator=E,e.async=function(t,a,n,r,o){void 0===o&&(o=Promise);var c=new E(l(t,a,n,r),o);return e.isGeneratorFunction(a)?c:c.next().then((function(e){return e.done?e.value:c.next()}))},y(b),i(b,s,"Generator"),i(b,o,(function(){return this})),i(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var n in t)a.push(n);return a.reverse(),function e(){for(;a.length;){var n=a.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=S,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(a,n){return c.type="throw",c.arg=e,t.next=a,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],c=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=a.call(o,"catchLoc"),i=a.call(o,"finallyLoc");if(s&&i){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!i)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var c=o?o.completion:{};return c.type=e,c.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(c)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),j(a),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;j(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:S(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),m}},e}function va(e){var t=Object(n.useContext)(O);return r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"nav-wrapper left"},r.a.createElement(z,null,r.a.createElement(s.c,{to:"/play"},"Lobby"),r.a.createElement(s.c,{to:"/community"},"Community"))),r.a.createElement(s.b,{to:"/",className:"logo-wrapper"},r.a.createElement("div",{className:"logo"})),r.a.createElement("div",{className:"nav-wrapper right"},r.a.createElement(z,null,r.a.createElement("a",{href:"https://wiki.beyondmafia.com"},"Wiki"),!t.loggedIn&&r.a.createElement(s.c,{to:"/auth",className:"nav-link"},"Log In"),t.loggedIn&&r.a.createElement("div",{className:"user-wrapper"},r.a.createElement(ga,null),r.a.createElement(s.b,{to:"/user",className:"profile-link"},r.a.createElement(Se,{id:t.id,name:t.name,hasImage:t.avatar}))))))}function ga(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],o=t[1],c=Object(n.useReducer)((function(e,t){var a;switch(t.type){case"add":var n=e.notifs.map((function(e){return e.id})),r=t.notifs.filter((function(e){return-1==n.indexOf(e.id)}));a=p()(e,{notifs:{$set:r.concat(e.notifs)},unread:{$set:e.unread+r.length}});break;case"viewed":a=p()(e,{unread:{$set:0}})}return a||e}),{notifs:[],unread:0}),l=Object(i.a)(c,2),m=l[0],f=l[1],h=Object(n.useState)(),v=Object(i.a)(h,2),g=v[0],b=v[1],y=Object(n.useContext)(N),E=Object(u.g)(),w=Object(n.useRef)(),O=Object(n.useRef)();function j(){d.a.get("/notifs").then((function(e){var t=e.data[0],a=e.data.slice(1);b(t),f({type:"add",notifs:a})})).catch((function(){}))}function k(){d.a.post("/notifs/viewed").then((function(){f({type:"viewed"})})).catch((function(){}))}G([w,O],(function(){return o(!1)})),Object(n.useEffect)((function(){j();var e=setInterval((function(){return j()}),1e4);return function(){return clearInterval(e)}}),[]),Object(n.useEffect)((function(){a&&k()}),[m.notifs]),Object(n.useEffect)((function(){if(g&&g>Date.now()){var e=Math.ceil((g-Date.now())/1e3/60);y.showAlert("The server will be restarting in ".concat(e," minutes."),"basic",!0)}}),[g]),Object(n.useLayoutEffect)((function(){if(a){var e=O.current.getBoundingClientRect(),t=e.left+e.width;t>window.innerWidth&&(O.current.style.left=window.innerWidth-t+"px"),O.current.style.visibility="visible"}}));var S=m.notifs.map((function(e){return r.a.createElement(s.b,{className:"notif",key:e.id,to:e.link,onClick:function(t){return function(e,t){t.link?window.location.pathname==t.link.split("?")[0]&&E.go(0):e.preventDefault()}(t,e)}},e.icon&&r.a.createElement("i",{className:"fas fa-".concat(e.icon)}),r.a.createElement("div",{className:"info"},r.a.createElement("div",{className:"time"},r.a.createElement(D,{millisec:Date.now()-e.date,suffix:" ago"})),r.a.createElement("div",{className:"content"},e.content)))}));return r.a.createElement("div",{className:"notifs-wrapper"},r.a.createElement(B,{lOffset:!0,notifCount:m.unread,onClick:function(){o(!a),!a&&m.unread>0&&k()},fwdRef:w},r.a.createElement("i",{className:"fas fa-bell"})),a&&r.a.createElement("div",{className:"notif-list",ref:O},S,0==S.length&&"No unread notifications"))}function ba(){var e=(new Date).getYear()+1900;return r.a.createElement("div",{className:"footer"},r.a.createElement("div",{className:"footer-inner"},r.a.createElement("p",null,"\xa9 ",e," BeyondMafia")))}var ya=function(){var e=window.localStorage.getItem("cacheVal");e||(e=Date.now(),window.localStorage.setItem("cacheVal",e));var t=function(){var e=Object(n.useState)({loggedIn:!1,loaded:!1,perms:{},rank:0,blockedUsers:[],settings:{},itemsOwned:{}}),t=Object(i.a)(e,2),a=t[0],r=t[1];return Object(h.a)(Object(h.a)({},a),{},{state:a,set:r,blockUserToggle:function(e){var t=a.blockedUsers.indexOf(e);r(-1==t?p()(a,{blockedUsers:{$push:[e]}}):p()(a,{blockedUsers:{$splice:[[t,1]]}}))},clear:function(){r({loggedIn:!1,loaded:!0,perms:{},rank:0,blockedUsers:[]})}})}(),a=S({alerts:[],cacheVal:e}),o=la(a),c=I(a);function m(e){d.a.post("/game/leave").then((function(){a.hideAlert(e)})).catch(c)}return Object(n.useEffect)((function(){function e(){return(e=Object(l.a)(ha().mark((function e(){var n,o;return ha().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.a.get("/user/info");case 3:return(n=e.sent).data.id?(n.data.loggedIn=!0,n.data.loaded=!0,n.data.rank=Number(n.data.rank),t.set(n.data),(o=window.localStorage.getItem("referrer"))&&(d.a.post("/user/referred",{referrer:o}),window.localStorage.removeItem("referrer"))):t.clear(),0==n.data.nameChanged&&a.showAlert((function(){return r.a.createElement("div",null,"New account created, you can change your username once in your ",r.a.createElement(s.b,{to:"/user/settings"},"settings"),".")}),"basic",!0),n.data.inGame&&a.showAlert((function(e){return r.a.createElement("div",null,"Return to game ",r.a.createElement(s.b,{to:"/game/".concat(n.data.inGame)},n.data.inGame)," or ",r.a.createElement("a",{onClick:function(){return m(e)}},"leave"),".")}),"basic",!0),e.next=9,d.a.get("/roles/all");case 9:n=e.sent,a.update("roles",n.data),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),c(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),d.a.post("/user/online");var n=setInterval((function(){d.a.post("/user/online")}),3e4);return function(){clearInterval(n)}}),[]),r.a.createElement(O.Provider,{value:t},r.a.createElement(N.Provider,{value:a},r.a.createElement(j.Provider,{value:o},r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/game"},r.a.createElement(Ot,null)),r.a.createElement(u.b,{path:"/"},r.a.createElement("div",{className:"site-wrapper"},r.a.createElement("div",{className:"main-container"},r.a.createElement(va,null),r.a.createElement("div",{className:"inner-container"},r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/play",render:function(){return r.a.createElement(ct,null)}}),r.a.createElement(u.b,{path:"/community",render:function(){return r.a.createElement(Kt,null)}}),r.a.createElement(u.b,{path:"/auth",render:function(){return r.a.createElement(ra,null)}}),r.a.createElement(u.b,{path:"/user",render:function(){return r.a.createElement(ke,null)}}),r.a.createElement(u.b,{path:"/legal",render:function(){return r.a.createElement(sa,null)}}),r.a.createElement(u.b,{render:function(){return r.a.createElement(u.a,{to:"/play"})}}))),r.a.createElement(ba,null),r.a.createElement(x,null),r.a.createElement(ma,null))))),r.a.createElement(ia,null))))};c.a.render(r.a.createElement(s.a,null,r.a.createElement(ya,null)),document.getElementById("root"))},51:function(e,t,a){},66:function(e,t,a){}},[[165,1,2]]]);
//# sourceMappingURL=main.b08155f8.chunk.js.map